function _calculateMin(e,t){return e<t?e:t}function _getPromoDistanceValue(e,t){for(var n=[],i=0;i<e.length;i++){n[i]=[];for(var o=0;o<e[i].length;o++)n[i][o]=i/(e.length-1),t===WHITE&&(n[i][o]=1-i/(e.length-1))}return n}function _getKingAttractionValue(e,t){for(var n,i,o=[],r=s_oMovesController.getAllPiecePos(e,t),s=0;s<r.length;s++){n=r[s].row,i=r[s].col,o[s]=[];for(var a,l,u=0;u<e.length;u++){o[s][u]=[];for(var c=0;c<e[u].length;c++)a=e.length-Math.abs(n-u),l=e[u].length-Math.abs(i-c),o[s][u][c]=_calculateMin(a,l)}}for(s=0,n=o[0];s<r.length;s++)for(u=0;u<e.length;u++)for(c=0;c<e[u].length;c++)n[u][c]<o[s][u][c]&&(n[u][c]=o[s][u][c]);return n}function _addDistanceValue(e,t,n){var i=_isOnlyKing(t);if(i){var o=s_oBoardStateController.getOtherOpponent(n);o=_getKingAttractionValue(t,o)}else o=_getPromoDistanceValue(t,n);for(var r=0;r<e.length;r++){var s=e[r],a=s.model.moves.path.terminal;a=o[a.row][a.col],i?s.model.rating+=a:s.model.moves.cell.type===PAWN&&(s.model.rating+=a)}}function _isOnlyKing(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)if(e[t][n].type===PAWN)return!1;return!0}function _makeMove(e,t){var n=e.cell,i=e.path.terminal,o=n.logic_pos;for(e=e.path.jump_list,t[o.row][o.col].color=null,t[o.row][o.col].type=null,t[i.row][i.col].color=n.color,t[i.row][i.col].type=n.type,o=0;o<e.length;o++){var r=e[o].capture;null!==r&&(t[r.logic_pos.row][r.logic_pos.col].color=null,t[r.logic_pos.row][r.logic_pos.col].type=null)}switch(i.row){case 0:n.color===WHITE&&(t[i.row][i.col].type=KING);break;case t.length-1:n.color===BLACK&&(t[i.row][i.col].type=KING)}}function _unmakeMove(e,t){var n=e.cell,i=e.cell.logic_pos,o=e.path.terminal;for(e=e.path.jump_list,t[o.row][o.col].color=null,t[o.row][o.col].type=null,t[i.row][i.col].color=n.color,t[i.row][i.col].type=n.type,n=0;n<e.length;n++)null!==(i=e[n].capture)&&(t[i.logic_pos.row][i.logic_pos.col].color=i.color,t[i.logic_pos.row][i.logic_pos.col].type=i.type)}function evaluateBoard(e,t,n,i,o){for(var r=0,s=0,a=0;a<e.length;a++)for(var l=0;l<e[a].length;l++){var u=e[a][l];u.color===WHITE?r=u.type===PAWN?r+n:r+i:u.color===BLACK&&(s=u.type===PAWN?s+n:s+i)}return a=s-r,o===WHITE&&(a=r-s),a}function CTreeDecision(e){var t,n,i;this._init=function(e){t=[];for(var o=0;o<SEARCH_DEPTH+1;o++)t[o]=[];i=(n=new TreeModel).parse(e),t[0][0]=i},this.getRoot=function(){return i},this.initNewNode=function(e){return t[e].push(n.parse({rating:0,moves:[],depth:e})),t[e][t[e].length-1]},this.addNode=function(e,n,i,o){var r=t[o=e+1].length-1;t[o][r].model.moves=i,t[o][r].model.rating=n,t[e][t[e].length-1].addChild(t[o][r])},this.rateNode=function(e,t){e.model.rating=t},this.getNode=function(e,t){return i.all(function(n){return n.model.rating===e&&n.model.depth===t})},this.getAllNodeByDepth=function(e){return i.all(function(t){return t.model.depth===e})},this.getPath=function(e){return e.getPath()},this.getTerminalNodes=function(){return i.all(function(e){return!e.hasChildren()})},this._init(e)}var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}},$jscomp.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return $jscomp.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},$jscomp.arrayFromIterator=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n},$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))},"undefined"==typeof _pio&&(_pio={}),JSON||(JSON={}),function(){function a(e){return 10>e?"0"+e:e}function d(e){return g.lastIndex=0,g.test(e)?'"'+e.replace(g,function(e){var t=h[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function c(t,n){var i,o=b,r=n[t];switch(r&&"object"==typeof r&&"function"==typeof r.toJSON&&(r=r.toJSON(t)),"function"==typeof k&&(r=k.call(n,t,r)),typeof r){case"string":return d(r);case"number":return isFinite(r)?String(r):"null";case"boolean":case"null":return String(r);case"object":if(!r)return"null";b+=e;var s=[];if("[object Array]"===Object.prototype.toString.apply(r)){var a=r.length;for(i=0;i<a;i+=1)s[i]=c(i,r)||"null";var l=0===s.length?"[]":b?"[\n"+b+s.join(",\n"+b)+"\n"+o+"]":"["+s.join(",")+"]";return b=o,l}if(k&&"object"==typeof k){for(a=k.length,i=0;i<a;i+=1)if("string"==typeof k[i]){var u=k[i];(l=c(u,r))&&s.push(d(u)+(b?": ":":")+l)}}else for(u in r)Object.prototype.hasOwnProperty.call(r,u)&&(l=c(u,r))&&s.push(d(u)+(b?": ":":")+l);return l=0===s.length?"{}":b?"{\n"+b+s.join(",\n"+b)+"\n"+o+"}":"{"+s.join(",")+"}",b=o,l}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var b,e,k,f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,n,i){var o;if(e=b="","number"==typeof i)for(o=0;o<i;o+=1)e+=" ";else"string"==typeof i&&(e=i);if((k=n)&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw Error("JSON.stringify");return c("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(l,m){function n(e,t){var n,i=e[t];if(i&&"object"==typeof i){for(n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var o=n(i,n);void 0!==o?i[n]=o:delete i[n]}}return m.call(e,t,i)}if(l=String(l),f.lastIndex=0,f.test(l)&&(l=l.replace(f,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var p=eval("("+l+")");return"function"==typeof m?n({"":p},""):p}throw SyntaxError("JSON.parse")})}(),_pio.errorLog=function(e){this.writeError=function(t,n,i,o){e.writeError("Javascript",t,n,i,_pio.convertToKVArray(o))}},function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@popperjs/core")):"function"==typeof define&&define.amd?define(["@popperjs/core"],t):(e=e||self).tippy=t(e.Popper)}(this,function(e){function t(e){var t=document.createElement("style");t.textContent=e,t.setAttribute("data-tippy-stylesheet",""),e=document.head;var n=document.querySelector("head>style,head>link");n?e.insertBefore(t,n):e.appendChild(t)}function n(e,t,n){return Array.isArray(e)&&null==(e=e[t])?Array.isArray(n)?n[t]:n:e}function i(e,t){var n=({}).toString.call(e);return 0===n.indexOf("[object")&&-1<n.indexOf(t+"]")}function o(e,t){return"function"==typeof e?e.apply(void 0,t):e}function r(e,t){var n;return 0===t?e:function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)}}function s(e,t){var n=Object.assign({},e);return t.forEach(function(e){delete n[e]}),n}function a(e,t){-1===e.indexOf(t)&&e.push(t)}function l(e){return e.filter(function(t,n){return e.indexOf(t)===n})}function u(e){return Object.keys(e).reduce(function(t,n){return void 0!==e[n]&&(t[n]=e[n]),t},{})}function c(){return document.createElement("div")}function h(e){return["Element","Fragment"].some(function(t){return i(e,t)})}function f(e){return h(e)?[e]:i(e,"NodeList")?[].slice.call(e):Array.isArray(e)?e:[].slice.call(document.querySelectorAll(e))}function d(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function p(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function g(e){var t;return(null==(e=[].concat(e)[0])?0:null==(t=e.ownerDocument)?0:t.body)?e.ownerDocument:document}function m(e,t){var n=t.clientX,i=t.clientY;return e.every(function(e){var t=e.popperRect,o=e.popperState;e=e.props.interactiveBorder;var r=o.placement.split("-")[0];if(!(o=o.modifiersData.offset))return!0;var s=i-t.bottom-("top"===r?o.bottom.y:0)>e,a=t.left-n+("right"===r?o.left.x:0)>e,l=n-t.right-("left"===r?o.right.x:0)>e;return t.top-i+("bottom"===r?o.top.y:0)>e||s||a||l})}function T(e,t,n){var i=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(t){e[i](t,n)})}function E(){X.isTouch||(X.isTouch=!0,window.performance&&document.addEventListener("mousemove",b))}function b(){var e=performance.now();20>e-z&&(X.isTouch=!1,document.removeEventListener("mousemove",b)),z=e}function $(){var e=document.activeElement;if(e&&e._tippy&&e._tippy.reference===e){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function y(e){return[e+"() was called on a"+("destroy"===e?"n already-":" ")+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function v(e){return e.replace(/[ \t]{2,}/g," ").replace(/^[ \t]*/gm,"").trim()}function S(e){return[v("\n  %ctippy.js\n\n  %c"+v(e)+"\n\n  %c\ud83d\udc77‍ This is a development-only message. It will be removed in production.\n  "),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}function w(e,t){if(e&&!Y.has(t)){var n;Y.add(t),(n=console).warn.apply(n,S(t))}}function A(e,t){if(e&&!Y.has(t)){var n;Y.add(t),(n=console).error.apply(n,S(t))}}function C(e){var t=!e,n="[object Object]"===Object.prototype.toString.call(e)&&!e.addEventListener;A(t,["tippy() was passed","`"+String(e)+"`","as its targets (first) argument. Valid types are: String, Element, Element[], or NodeList."].join(" ")),A(n,"tippy() was passed a plain object which is not supported as an argument for virtual positioning. Use props.getReferenceClientRect instead.")}function I(e){var t=(e.plugins||[]).reduce(function(t,n){var i=n.name,o=n.defaultValue;return i&&(t[i]=void 0!==e[i]?e[i]:o),t},{});return Object.assign({},e,{},t)}function O(e,t){return(t?Object.keys(I(Object.assign({},K,{plugins:t}))):q).reduce(function(t,n){var i=(e.getAttribute("data-tippy-"+n)||"").trim();if(!i)return t;if("content"===n)t[n]=i;else try{t[n]=JSON.parse(i)}catch(o){t[n]=i}return t},{})}function P(e,t){var n=Object.assign({},t,{content:o(t.content,[e])},t.ignoreAttributes?{}:O(e,t.plugins));return n.aria=Object.assign({},K.aria,{},n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function R(e,t){void 0===e&&(e={}),void 0===t&&(t=[]),Object.keys(e).forEach(function(e){var n=s(K,Object.keys(j));(n=!({}).hasOwnProperty.call(n,e))&&(n=0===t.filter(function(t){return t.name===e}).length),w(n,["`"+e+"`","is not a valid prop. You may have spelled it incorrectly, or if it's a plugin, forgot to pass it in an array as props.plugins. \n\n All props: https://atomiks.github.io/tippyjs/v6/all-props/\n Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}function k(e){var t=c();return!0===e?t.className="tippy-arrow":(t.className="tippy-svg-arrow",h(e)?t.appendChild(e):t.innerHTML=e),t}function N(e,t){h(t.content)?(e.innerHTML="",e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?e.innerHTML=t.content:e.textContent=t.content)}function L(e){e=e.firstElementChild;var t=[].slice.call(e.children);return{box:e,content:t.find(function(e){return e.classList.contains("tippy-content")}),arrow:t.find(function(e){return e.classList.contains("tippy-arrow")||e.classList.contains("tippy-svg-arrow")}),backdrop:t.find(function(e){return e.classList.contains("tippy-backdrop")})}}function _(e){function t(t,i){var o=L(n),r=o.box,s=o.content;o=o.arrow,i.theme?r.setAttribute("data-theme",i.theme):r.removeAttribute("data-theme"),"string"==typeof i.animation?r.setAttribute("data-animation",i.animation):r.removeAttribute("data-animation"),i.inertia?r.setAttribute("data-inertia",""):r.removeAttribute("data-inertia"),r.style.maxWidth="number"==typeof i.maxWidth?i.maxWidth+"px":i.maxWidth,i.role?r.setAttribute("role",i.role):r.removeAttribute("role"),t.content===i.content&&t.allowHTML===i.allowHTML||N(s,e.props),i.arrow?o?t.arrow!==i.arrow&&(r.removeChild(o),r.appendChild(k(i.arrow))):r.appendChild(k(i.arrow)):o&&r.removeChild(o)}var n=c(),i=c();i.className="tippy-box",i.setAttribute("data-state","hidden"),i.setAttribute("tabindex","-1");var o=c();return o.className="tippy-content",o.setAttribute("data-state","hidden"),N(o,e.props),n.appendChild(i),i.appendChild(o),t(e.props,e.props),{popper:n,onUpdate:t}}function x(t,s){function h(){var e=ey.props.touch;return Array.isArray(e)?e:[e,0]}function f(){var e;return!(null==(e=ey.props.render)||!e.$$tippy)}function E(){var e=(ef||t).parentNode;return e?g(e):document}function b(e){return ey.state.isMounted&&!ey.state.isVisible||X.isTouch||eu&&"focus"===eu.type?0:n(ey.props.delay,e?0:1,K.delay)}function $(){ev.style.pointerEvents=ey.props.interactive&&ey.state.isVisible?"":"none",ev.style.zIndex=""+ey.props.zIndex}function v(e,t,n){if(void 0===n&&(n=!0),ew.forEach(function(n){n[e]&&n[e].apply(void 0,t)}),n){var i;(i=ey.props)[e].apply(i,t)}}function S(){var e=ey.props.aria;if(e.content){var n="aria-"+e.content,i=ev.id;[].concat(ey.props.triggerTarget||t).forEach(function(e){var t=e.getAttribute(n);ey.state.isVisible?e.setAttribute(n,t?t+" "+i:i):(t=t&&t.replace(i,"").trim())?e.setAttribute(n,t):e.removeAttribute(n)})}}function C(){!eA&&ey.props.aria.expanded&&[].concat(ey.props.triggerTarget||t).forEach(function(e){ey.props.interactive?e.setAttribute("aria-expanded",ey.state.isVisible&&e===(ef||t)?"true":"false"):e.removeAttribute("aria-expanded")})}function O(){E().removeEventListener("mousemove",eE),Z=Z.filter(function(e){return e!==eE})}function R(e){if((!X.isTouch||!eg&&"mousedown"!==e.type)&&(!ey.props.interactive||!ev.contains(e.target))){if((ef||t).contains(e.target)){if(X.isTouch||ey.state.isVisible&&0<=ey.props.trigger.indexOf("click"))return}else v("onClickOutside",[ey,e]);!0===ey.props.hideOnClick&&(ey.clearDelayTimeouts(),ey.hide(),ep=!0,setTimeout(function(){ep=!1}),ey.state.isMounted||x())}}function k(){eg=!0}function N(){eg=!1}function _(){var e=E();e.addEventListener("mousedown",R,!0),e.addEventListener("touchend",R,V),e.addEventListener("touchstart",N,V),e.addEventListener("touchmove",k,V)}function x(){var e=E();e.removeEventListener("mousedown",R,!0),e.removeEventListener("touchend",R,V),e.removeEventListener("touchstart",N,V),e.removeEventListener("touchmove",k,V)}function M(e,t){D(e,function(){!ey.state.isVisible&&ev.parentNode&&ev.parentNode.contains(ev)&&t()})}function B(e,t){D(e,t)}function D(e,t){function n(e){e.target===i&&(T(i,"remove",n),t())}var i=L(ev).box;if(0===e)return t();T(i,"remove",ec),T(i,"add",n),ec=n}function U(e,n,i){void 0===i&&(i=!1),[].concat(ey.props.triggerTarget||t).forEach(function(t){t.addEventListener(e,n,i),eT.push({node:t,eventType:e,handler:n,options:i})})}function W(){"hold"===h()[0]&&(U("touchstart",F,{passive:!0}),U("touchend",Y,{passive:!0})),ey.props.trigger.split(/\s+/).filter(Boolean).forEach(function(e){if("manual"!==e)switch(U(e,F),e){case"mouseenter":U("mouseleave",Y);break;case"focus":U(G?"focusout":"blur",j);break;case"focusin":U("focusout",j)}})}function H(){eT.forEach(function(e){e.node.removeEventListener(e.eventType,e.handler,e.options)}),eT=[]}function F(e){var t,n=!1;if(ey.state.isEnabled&&!q(e)&&!ep){var o="focus"===(null==(t=eu)?void 0:t.type);eu=e,ef=e.currentTarget,C(),!ey.state.isVisible&&i(e,"MouseEvent")&&Z.forEach(function(t){return t(e)}),"click"===e.type&&(0>ey.props.trigger.indexOf("mouseenter")||e8)&&!1!==ey.props.hideOnClick&&ey.state.isVisible?n=!0:eo(e),"click"===e.type&&(e8=!n),n&&!o&&er(e)}}function z(e){var n=e.target;n=(ef||t).contains(n)||ev.contains(n),"mousemove"===e.type&&n||(n=ei().concat(ev).map(function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:ed}:null}).filter(Boolean),m(n,e)&&(O(),er(e)))}function Y(e){q(e)||0<=ey.props.trigger.indexOf("click")&&e8||(ey.props.interactive?ey.hideWithInteractivity(e):er(e))}function j(e){0>ey.props.trigger.indexOf("focusin")&&e.target!==(ef||t)||ey.props.interactive&&e.relatedTarget&&ev.contains(e.relatedTarget)||er(e)}function q(e){return!!X.isTouch&&"hold"===h()[0]!=0<=e.type.indexOf("touch")}function ee(){et();var n=ey.props,i=n.popperOptions,o=n.placement,r=n.offset,s=n.getReferenceClientRect,a=n.moveTransition;n=f()?L(ev).arrow:null,s=s?{getBoundingClientRect:s,contextElement:s.contextElement||ef||t}:t,r=[{name:"offset",options:{offset:r}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!a}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(f()){var n=L(ev).box;["placement","reference-hidden","escaped"].forEach(function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)}),t.attributes.popper={}}}}],f()&&n&&r.push({name:"arrow",options:{element:n,padding:3}}),r.push.apply(r,(null==i?void 0:i.modifiers)||[]),ey.popperInstance=e.createPopper(s,ev,Object.assign({},i,{placement:o,onFirstUpdate:eh,modifiers:r}))}function et(){ey.popperInstance&&(ey.popperInstance.destroy(),ey.popperInstance=null)}function en(){var e=ey.props.appendTo,n=ef||t,i=ey.props.interactive&&e===K.appendTo||"parent"===e?n.parentNode:o(e,[n]);i.contains(ev)||i.appendChild(ev),ee(),w(ey.props.interactive&&e===K.appendTo&&n.nextElementSibling!==ev,"Interactive tippy element may not be accessible via keyboard navigation because it is not directly after the reference element in the DOM source order. \n\n Using a wrapper <div> or <span> tag around the reference element solves this by creating a new parentNode context. \n\n Specifying `appendTo: document.body` silences this warning, but it assumes you are using a focus management solution to handle keyboard navigation. \n\n See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity")}function ei(){return[].slice.call(ev.querySelectorAll("[data-tippy-root]"))}function eo(e){ey.clearDelayTimeouts(),e&&v("onTrigger",[ey,e]),_(),e=b(!0);var t=h(),n=t[0];t=t[1],X.isTouch&&"hold"===n&&t&&(e=t),e?es=setTimeout(function(){ey.show()},e):ey.show()}function er(e){ey.clearDelayTimeouts(),v("onUntrigger",[ey,e]),ey.state.isVisible?0<=ey.props.trigger.indexOf("mouseenter")&&0<=ey.props.trigger.indexOf("click")&&0<=["mouseleave","mousemove"].indexOf(e.type)&&e8||((e=b(!1))?ea=setTimeout(function(){ey.state.isVisible&&ey.hide()},e):el=requestAnimationFrame(function(){ey.hide()})):x()}var es,ea,el,eu,ec,eh,ef,ed=P(t,Object.assign({},K,{},I(u(s)))),e8=!1,ep=!1,eg=!1,em=!1,eT=[],eE=r(z,ed.interactiveDebounce),eb=J++,e$=l(ed.plugins),ey={id:eb,reference:t,popper:c(),popperInstance:null,props:ed,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:e$,clearDelayTimeouts:function(){clearTimeout(es),clearTimeout(ea),cancelAnimationFrame(el)},setProps:function(e){if(w(ey.state.isDestroyed,y("setProps")),!ey.state.isDestroyed){v("onBeforeUpdate",[ey,e]),H();var n=ey.props,i=P(t,Object.assign({},ey.props,{},e,{ignoreAttributes:!0}));ey.props=i,W(),n.interactiveDebounce!==i.interactiveDebounce&&(O(),eE=r(z,i.interactiveDebounce)),n.triggerTarget&&!i.triggerTarget?[].concat(n.triggerTarget).forEach(function(e){e.removeAttribute("aria-expanded")}):i.triggerTarget&&t.removeAttribute("aria-expanded"),C(),$(),eS&&eS(n,i),ey.popperInstance&&(ee(),ei().forEach(function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})),v("onAfterUpdate",[ey,e])}},setContent:function(e){ey.setProps({content:e})},show:function(){w(ey.state.isDestroyed,y("show"));var e=ey.state.isVisible,i=ey.state.isDestroyed,o=!ey.state.isEnabled,r=X.isTouch&&!ey.props.touch,s=n(ey.props.duration,0,K.duration);e||i||o||r||(ef||t).hasAttribute("disabled")||(v("onShow",[ey],!1),!1!==ey.props.onShow(ey)&&(ey.state.isVisible=!0,f()&&(ev.style.visibility="visible"),$(),_(),ey.state.isMounted||(ev.style.transition="none"),f()&&(e=L(ev),d([e.box,e.content],0)),eh=function(){var e;if(ey.state.isVisible&&!em){if(em=!0,ev.style.transition=ey.props.moveTransition,f()&&ey.props.animation){var t=L(ev),n=t.box;d([n,t=t.content],s),p([n,t],"visible")}S(),C(),a(Q,ey),null==(e=ey.popperInstance)||e.forceUpdate(),ey.state.isMounted=!0,v("onMount",[ey]),ey.props.animation&&f()&&B(s,function(){ey.state.isShown=!0,v("onShown",[ey])})}},en()))},hide:function(){w(ey.state.isDestroyed,y("hide"));var e=!ey.state.isVisible,t=ey.state.isDestroyed,i=!ey.state.isEnabled,o=n(ey.props.duration,1,K.duration);e||t||i||(v("onHide",[ey],!1),!1!==ey.props.onHide(ey)&&(ey.state.isVisible=!1,e8=em=ey.state.isShown=!1,f()&&(ev.style.visibility="hidden"),O(),x(),$(),f()&&(e=(t=L(ev)).box,t=t.content,ey.props.animation&&(d([e,t],o),p([e,t],"hidden"))),S(),C(),ey.props.animation?f()&&M(o,ey.unmount):ey.unmount()))},hideWithInteractivity:function(e){w(ey.state.isDestroyed,y("hideWithInteractivity")),E().addEventListener("mousemove",eE),a(Z,eE),eE(e)},enable:function(){ey.state.isEnabled=!0},disable:function(){ey.hide(),ey.state.isEnabled=!1},unmount:function(){w(ey.state.isDestroyed,y("unmount")),ey.state.isVisible&&ey.hide(),ey.state.isMounted&&(et(),ei().forEach(function(e){e._tippy.unmount()}),ev.parentNode&&ev.parentNode.removeChild(ev),Q=Q.filter(function(e){return e!==ey}),ey.state.isMounted=!1,v("onHidden",[ey]))},destroy:function(){w(ey.state.isDestroyed,y("destroy")),ey.state.isDestroyed||(ey.clearDelayTimeouts(),ey.unmount(),H(),delete t._tippy,ey.state.isDestroyed=!0,v("onDestroy",[ey]))}};if(!ed.render)return A(!0,"render() function has not been supplied."),ey;var ev=(eb=ed.render(ey)).popper,eS=eb.onUpdate;ev.setAttribute("data-tippy-root",""),ev.id="tippy-"+ey.id,ey.popper=ev,t._tippy=ey,ev._tippy=ey;var ew=e$.map(function(e){return e.fn(ey)}),eA=t.hasAttribute("aria-expanded");return W(),C(),$(),v("onCreate",[ey]),ed.showOnCreate&&eo(),ev.addEventListener("mouseenter",function(){ey.props.interactive&&ey.state.isVisible&&ey.clearDelayTimeouts()}),ev.addEventListener("mouseleave",function(e){ey.props.interactive&&0<=ey.props.trigger.indexOf("mouseenter")&&(E().addEventListener("mousemove",eE),eE(e))}),ey}function M(e,t){void 0===t&&(t={});var n=K.plugins.concat(t.plugins||[]);C(e),R(t,n),document.addEventListener("touchstart",E,V),window.addEventListener("blur",$);var i=Object.assign({},t,{plugins:n});n=f(e);var o=h(i.content),r=1<n.length;return w(o&&r,"tippy() was passed an Element as the `content` prop, but more than one tippy instance was created by this invocation. This means the content element will only be appended to the last tippy instance. \n\n Instead, pass the .innerHTML of the element, or use a function that returns a cloned version of the element instead. \n\n 1) content: element.innerHTML\n 2) content: () => element.cloneNode(true)"),n=n.reduce(function(e,t){var n=t&&x(t,i);return n&&e.push(n),e},[]),h(e)?n[0]:n}function B(){var e=c();return e.className="tippy-backdrop",p([e],"hidden"),e}function D(e){en={clientX:e.clientX,clientY:e.clientY}}function U(e,t){var n;return{popperOptions:Object.assign({},e.popperOptions,{modifiers:[].concat(((null==(n=e.popperOptions)?void 0:n.modifiers)||[]).filter(function(e){return e.name!==t.name}),[t])})}}function W(e,t,n,i){if(2>n.length||null===e)return t;if(2===n.length&&0<=i&&n[0].left>n[1].right)return n[i]||t;switch(e){case"top":case"bottom":t=n[0];var o=n[n.length-1],r="top"===e;n=t.top,i=o.bottom;var s=r?t.left:o.left;return{top:n,bottom:i,left:s,right:t=r?t.right:o.right,width:t-s,height:i-n};case"left":case"right":var a=Math.min.apply(Math,n.map(function(e){return e.left})),l=Math.max.apply(Math,n.map(function(e){return e.right}));return{top:t=(n=n.filter(function(t){return"left"===e?t.left===a:t.right===l}))[0].top,bottom:n=n[n.length-1].bottom,left:a,right:l,width:l-a,height:n-t};default:return t}}function H(e,t){return!e||!t||e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom||e.left!==t.left}var F="undefined"!=typeof window&&"undefined"!=typeof document,G=/MSIE |Trident\//.test(F?navigator.userAgent:""),V={passive:!0,capture:!0},X={isTouch:!1},z=0,Y=new Set,j={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},K=Object.assign({appendTo:function(){return document.body},aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},j,{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),q=Object.keys(K);_.$$tippy=!0;var J=1,Z=[],Q=[];M.defaultProps=K,M.setDefaultProps=function(e){R(e,[]),Object.keys(e).forEach(function(t){K[t]=e[t]})},M.currentInput=X;var ee=Object.assign({},e.applyStyles,{effect:function(e){var t={popper:{position:(e=e.state).options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow)}}),et={mouseover:"mouseenter",focusin:"focus",click:"click"},en={clientX:0,clientY:0},ei=[];return F&&t('.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}'),M.setDefaultProps({plugins:[{name:"animateFill",defaultValue:!1,fn:function(e){if(null==(t=e.props.render)||!t.$$tippy)return A(e.props.animateFill,"The `animateFill` plugin requires the default render function."),{};var t,n=(t=L(e.popper)).box,i=t.content,o=e.props.animateFill?B():null;return{onCreate:function(){o&&(n.insertBefore(o,n.firstElementChild),n.setAttribute("data-animatefill",""),n.style.overflow="hidden",e.setProps({arrow:!1,animation:"shift-away"}))},onMount:function(){if(o){var e=n.style.transitionDuration,t=Number(e.replace("ms",""));i.style.transitionDelay=Math.round(t/10)+"ms",o.style.transitionDuration=e,p([o],"visible")}},onShow:function(){o&&(o.style.transitionDuration="0ms")},onHide:function(){o&&p([o],"hidden")}}}},{name:"followCursor",defaultValue:!1,fn:function(e){function t(){l=!0,e.setProps({getReferenceClientRect:null}),l=!1}function n(t){var n=!t.target||s.contains(t.target),i=e.props.followCursor,o=t.clientX,r=t.clientY,a=o-(t=s.getBoundingClientRect()).left,l=r-t.top;!n&&e.props.interactive||e.setProps({getReferenceClientRect:function(){var e=s.getBoundingClientRect(),t=o,n=r;"initial"===i&&(t=e.left+a,n=e.top+l);var u="horizontal"===i?e.top:n,c="vertical"===i?e.right:t;return n="horizontal"===i?e.bottom:n,e="vertical"===i?e.left:t,{width:c-e,height:n-u,top:u,right:c,bottom:n,left:e}}})}function o(){e.props.followCursor&&(ei.push({instance:e,doc:a}),a.addEventListener("mousemove",D))}function r(){0===(ei=ei.filter(function(t){return t.instance!==e})).filter(function(e){return e.doc===a}).length&&a.removeEventListener("mousemove",D)}var s=e.reference,a=g(e.props.triggerTarget||s),l=!1,u=!1,c=!0,h=e.props;return{onCreate:o,onDestroy:r,onBeforeUpdate:function(){h=e.props},onAfterUpdate:function(i,s){var c=s.followCursor;l||void 0===c||h.followCursor===c||(r(),c?(o(),!e.state.isMounted||u||"initial"===e.props.followCursor&&e.state.isVisible||a.addEventListener("mousemove",n)):(a.removeEventListener("mousemove",n),t()))},onMount:function(){e.props.followCursor&&!u&&(c&&(n(en),c=!1),"initial"===e.props.followCursor&&e.state.isVisible||a.addEventListener("mousemove",n))},onTrigger:function(e,t){i(t,"MouseEvent")&&(en={clientX:t.clientX,clientY:t.clientY}),u="focus"===t.type},onHidden:function(){e.props.followCursor&&(t(),a.removeEventListener("mousemove",n),c=!0)}}}},{name:"inlinePositioning",defaultValue:!1,fn:function(e){function t(){if(!s){var t=U(e.props,a);s=!0,e.setProps(t),s=!1}}var n,o=e.reference,r=-1,s=!1,a={name:"tippyInlinePositioning",enabled:!0,phase:"afterWrite",fn:function(t){var i=t.state;e.props.inlinePositioning&&(n!==i.placement&&e.setProps({getReferenceClientRect:function(){return W(i.placement.split("-")[0],o.getBoundingClientRect(),[].slice.call(o.getClientRects()),r)}}),n=i.placement)}};return{onCreate:t,onAfterUpdate:t,onTrigger:function(t,n){if(i(n,"MouseEvent")){var o=[].slice.call(e.reference.getClientRects()),s=o.find(function(e){return e.left-2<=n.clientX&&e.right+2>=n.clientX&&e.top-2<=n.clientY&&e.bottom+2>=n.clientY});r=o.indexOf(s)}},onUntrigger:function(){r=-1}}}},{name:"sticky",defaultValue:!1,fn:function(e){function t(){var s=!0===e.props.sticky||"reference"===e.props.sticky?(e.popperInstance?e.popperInstance.state.elements.reference:n).getBoundingClientRect():null,a=!0===e.props.sticky||"popper"===e.props.sticky?i.getBoundingClientRect():null;(s&&H(o,s)||a&&H(r,a))&&e.popperInstance&&e.popperInstance.update(),o=s,r=a,e.state.isMounted&&requestAnimationFrame(t)}var n=e.reference,i=e.popper,o=null,r=null;return{onMount:function(){e.props.sticky&&t()}}}}],render:_}),M.createSingleton=function(e,t){function n(){h=u.map(function(e){return e.reference})}function i(e){u.forEach(function(t){e?t.enable():t.disable()})}function o(e){return u.map(function(t){var n=t.setProps;return t.setProps=function(i){n(i),t.reference===l&&e.setProps(i)},function(){t.setProps=n}})}function r(e,t){var n=h.indexOf(t);if(t!==l){l=t;var i=(f||[]).concat("content").reduce(function(e,t){return e[t]=u[n].props[t],e},{});e.setProps(Object.assign({},i,{getReferenceClientRect:"function"==typeof i.getReferenceClientRect?i.getReferenceClientRect:function(){return t.getBoundingClientRect()}}))}}void 0===t&&(t={}),A(!Array.isArray(e),["The first argument passed to createSingleton() must be an array of tippy instances. The passed value was",String(e)].join(" "));var a,l,u=e,h=[],f=t.overrides,d=[],p=!1;i(!1),n();var g=M(c(),Object.assign({},s(t,["overrides"]),{plugins:[{fn:function(){return{onDestroy:function(){i(!0)},onHidden:function(){l=null},onClickOutside:function(e){e.props.showOnCreate&&!p&&(p=!0,l=null)},onShow:function(e){e.props.showOnCreate&&!p&&(p=!0,r(e,h[0]))},onTrigger:function(e,t){r(e,t.currentTarget)}}}}].concat(t.plugins||[]),triggerTarget:h,popperOptions:Object.assign({},t.popperOptions,{modifiers:[].concat((null==(a=t.popperOptions)?void 0:a.modifiers)||[],[ee])})})),m=g.show;g.show=function(e){if(m(),!l&&null==e)return r(g,h[0]);if(!l||null!=e){if("number"==typeof e)return h[e]&&r(g,h[e]);if(u.includes(e))return r(g,e.reference);if(h.includes(e))return r(g,e)}},g.showNext=function(){var e=h[0];if(!l)return g.show(0);var t=h.indexOf(l);g.show(h[t+1]||e)},g.showPrevious=function(){var e=h[h.length-1];if(!l)return g.show(e);var t=h.indexOf(l);g.show(h[t-1]||e)};var T=g.setProps;return g.setProps=function(e){f=e.overrides||f,T(e)},g.setInstances=function(e){i(!0),d.forEach(function(e){return e()}),u=e,i(!1),n(),o(g),g.setProps({triggerTarget:h})},d=o(g),g},M.delegate=function(e,t){function n(e){if(e.target&&!u){var n=e.target.closest(c);if(n){var i=n.getAttribute("data-tippy-trigger")||t.trigger||K.trigger;n._tippy||"touchstart"===e.type&&"boolean"==typeof d.touch||"touchstart"!==e.type&&0>i.indexOf(et[e.type])||(e=M(n,d))&&(l=l.concat(e))}}}function i(e,t,n,i){void 0===i&&(i=!1),e.addEventListener(t,n,i),a.push({node:e,eventType:t,handler:n,options:i})}function o(e){i(e=e.reference,"touchstart",n,V),i(e,"mouseover",n),i(e,"focusin",n),i(e,"click",n)}function r(){a.forEach(function(e){e.node.removeEventListener(e.eventType,e.handler,e.options)}),a=[]}A(!(t&&t.target),"You must specity a `target` prop indicating a CSS selector string matching the target elements that should receive a tippy.");var a=[],l=[],u=!1,c=t.target,h=s(t,["target"]),f=Object.assign({},h,{trigger:"manual",touch:!1}),d=Object.assign({},h,{showOnCreate:!0});return[].concat(h=M(e,f)).forEach(function(e){var t=e.destroy,n=e.enable,i=e.disable;e.destroy=function(e){void 0===e&&(e=!0),e&&l.forEach(function(e){e.destroy()}),l=[],r(),t()},e.enable=function(){n(),l.forEach(function(e){return e.enable()}),u=!1},e.disable=function(){i(),l.forEach(function(e){return e.disable()}),u=!0},o(e)}),h},M.hideAll=function(e){var t=(e=void 0===e?{}:e).exclude,n=e.duration;Q.forEach(function(e){var i=!1;t&&(i=t&&t._tippy&&t._tippy.reference===t?e.reference===t:e.popper===t.popper),i||(i=e.props.duration,e.setProps({duration:n}),e.hide(),e.state.isDestroyed||e.setProps({duration:i}))})},M.roundArrow='<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>',M}),function(e,t){var n,i;"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n=e.Base64,(i=t()).noConflict=function(){return e.Base64=n,i},e.Meteor&&(Base64=i),e.Base64=i)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:this,function(){var e,t,n="function"==typeof atob,i="function"==typeof btoa,o="function"==typeof Buffer,r="function"==typeof TextDecoder?new TextDecoder:void 0,s="function"==typeof TextEncoder?new TextEncoder:void 0,a=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),l=(e=a,t={},e.forEach(function(e,n){return t[e]=n}),t),u=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,c=String.fromCharCode.bind(String),h="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e,t){return void 0===t&&(t=function(e){return e}),new Uint8Array(Array.prototype.slice.call(e,0).map(t))},f=function(e){return e.replace(/=/g,"").replace(/[+\/]/g,function(e){return"+"==e?"-":"_"})},d=function(e){for(var t,n,i,o="",r=e.length%3,s=0;s<e.length;){if(255<(t=e.charCodeAt(s++))||255<(n=e.charCodeAt(s++))||255<(i=e.charCodeAt(s++)))throw TypeError("invalid character found");o+=a[(t=t<<16|n<<8|i)>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}return r?o.slice(0,r-3)+"===".substring(r):o},p=i?function(e){return btoa(e)}:o?function(e){return Buffer.from(e,"binary").toString("base64")}:d,g=o?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],n=0,i=e.length;n<i;n+=4096)t.push(c.apply(null,e.subarray(n,n+4096)));return p(t.join(""))},m=function(e,t){return void 0===t&&(t=!1),t?f(g(e)):g(e)},T=function(e){if(2>e.length){var t=e.charCodeAt(0);return 128>t?e:2048>t?c(192|t>>>6)+c(128|63&t):c(224|t>>>12&15)+c(128|t>>>6&63)+c(128|63&t)}return c(240|(t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320))>>>18&7)+c(128|t>>>12&63)+c(128|t>>>6&63)+c(128|63&t)},E=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,b=function(e){return e.replace(E,T)},$=o?function(e){return Buffer.from(e,"utf8").toString("base64")}:s?function(e){return g(s.encode(e))}:function(e){return p(b(e))},y=function(e,t){return void 0===t&&(t=!1),t?f($(e)):$(e)};i=function(e){return y(e,!0)};var v=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,S=function(e){switch(e.length){case 4:return c(((e=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536)>>>10)+55296)+c((1023&e)+56320);case 3:return c((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return c((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},w=function(e){return e.replace(v,S)},A=function(e){if(e=e.replace(/\s+/g,""),!u.test(e))throw TypeError("malformed base64.");e+="==".slice(2-(3&e.length));for(var t,n,i,o="",r=0;r<e.length;)t=l[e.charAt(r++)]<<18|l[e.charAt(r++)]<<12|(n=l[e.charAt(r++)])<<6|(i=l[e.charAt(r++)]),o+=64===n?c(t>>16&255):64===i?c(t>>16&255,t>>8&255):c(t>>16&255,t>>8&255,255&t);return o},C=n?function(e){return atob(e.replace(/[^A-Za-z0-9\+\/]/g,""))}:o?function(e){return Buffer.from(e,"base64").toString("binary")}:A,I=o?function(e){return h(Buffer.from(e,"base64"))}:function(e){return h(C(e),function(e){return e.charCodeAt(0)})},O=function(e){return I(R(e))},P=o?function(e){return Buffer.from(e,"base64").toString("utf8")}:r?function(e){return r.decode(I(e))}:function(e){return w(C(e))},R=function(e){return e.replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")},k=function(e){return P(R(e))},N=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}},L=function(){var e=function(e,t){return Object.defineProperty(String.prototype,e,N(t))};e("fromBase64",function(){return k(this)}),e("toBase64",function(e){return y(this,e)}),e("toBase64URI",function(){return y(this,!0)}),e("toBase64URL",function(){return y(this,!0)}),e("toUint8Array",function(){return O(this)})},_=function(){var e=function(e,t){return Object.defineProperty(Uint8Array.prototype,e,N(t))};e("toBase64",function(e){return m(this,e)}),e("toBase64URI",function(){return m(this,!0)}),e("toBase64URL",function(){return m(this,!0)})},x={version:"3.7.2",VERSION:"3.7.2",atob:C,atobPolyfill:A,btoa:p,btoaPolyfill:d,fromBase64:k,toBase64:y,encode:y,encodeURI:i,encodeURL:i,utob:b,btou:w,decode:k,isValid:function(e){return"string"==typeof e&&(e=e.replace(/\s+/g,"").replace(/={0,2}$/,""),!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e))},fromUint8Array:m,toUint8Array:O,extendString:L,extendUint8Array:_,extendBuiltins:function(){L(),_()},Base64:{}};return Object.keys(x).forEach(function(e){return x.Base64[e]=x[e]}),x}),function(){var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},t="undefined"!=typeof module&&module.exports,n=function(){for(var t,n=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],i=0,o=n.length,r={};i<o;i++)if((t=n[i])&&t[1]in e){for(i=0;i<t.length;i++)r[n[0][i]]=t[i];return r}return!1}(),i={change:n.fullscreenchange,error:n.fullscreenerror},o={request:function(t){return new Promise((function(i,o){var r=(function(){this.off("change",r),i()}).bind(this);this.on("change",r),Promise.resolve((t=t||e.documentElement)[n.requestFullscreen]()).catch(o)}).bind(this))},exit:function(){return new Promise((function(t,i){if(this.isFullscreen){var o=(function(){this.off("change",o),t()}).bind(this);this.on("change",o),Promise.resolve(e[n.exitFullscreen]()).catch(i)}else t()}).bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(t,n){var o=i[t];o&&e.addEventListener(o,n,!1)},off:function(t,n){var o=i[t];o&&e.removeEventListener(o,n,!1)},raw:n};n?(Object.defineProperties(o,{isFullscreen:{get:function(){return!!e[n.fullscreenElement]}},element:{enumerable:!0,get:function(){return e[n.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!e[n.fullscreenEnabled]}}}),t?module.exports=o:window.screenfull=o):t?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}(),(function(){function e(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function t(e,t){var n=-1,o=e?e.length:0;if("number"==typeof o&&-1<o&&o<=d)for(;++n<o;)t(e[n],n,e);else i(e,t)}function n(t){return t=String(t).replace(/^ +| +$/g,""),/^(?:webOS|i(?:OS|P))/.test(t)?t:e(t)}function i(e,t){for(var n in e)g.call(e,n)&&t(e[n],n,e)}function o(t){return null==t?e(t):m.call(t).slice(8,-1)}function r(e,t){var n=null!=e?typeof e[t]:"number";return!/^(?:boolean|number|string|undefined)$/.test(n)&&("object"!=n||!!e[t])}function s(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function a(e,n){var i=null;return t(e,function(t,o){i=n(i,t,o,e)}),i}function l(e){function t(t){return a(t,function(t,i){var o=i.pattern||s(i);return!t&&(t=RegExp("\\b"+o+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+o+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+o+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(i.label&&!RegExp(o,"i").test(i.label)?i.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),i=i.label||i,t=n(t[0].replace(RegExp(o,"i"),i).replace(RegExp("; *(?:"+i+"[_-])?","i")," ").replace(RegExp("("+i+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function u(t){return a(t,function(t,n){return t||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}var h=c,f=e&&"object"==typeof e&&"String"!=o(e);f&&(h=e,e=null);var d=h.navigator||{},g=d.userAgent||"";e||(e=g);var T=f?!!d.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(m.toString()),E=f?"Object":"ScriptBridgingProxyObject",b=f?"Object":"Environment",$=f&&h.java?"JavaPackage":o(h.java),y=f?"Object":"RuntimeObject";b=($=/\bJava/.test($)&&h.java)&&o(h.environment)==b;var v,S=$?"a":"α",w=$?"b":"β",A=h.document||{},C=h.operamini||h.opera,I=p.test(I=f&&C?C["[[Class]]"]:o(C))?I:C=null,O=e;f=[];var P,R,k,N,L=null,_=e==g;g=_&&C&&"function"==typeof C.version&&C.version();var x=a(P=[{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(t,n){return t||RegExp("\\b"+(n.pattern||s(n))+"\\b","i").exec(e)&&(n.label||n)}),M=a(R=["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(t,n){return t||RegExp("\\b"+(n.pattern||s(n))+"\\b","i").exec(e)&&(n.label||n)}),B=t([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),D=a(k={Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}},function(t,n,i){return t||(n[B]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(B)]||RegExp("\\b"+s(i)+"(?:\\b|\\w*\\d)","i").exec(e))&&i}),U=a(N=["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(t,i){var o=i.pattern||s(i);if(!t&&(t=RegExp("\\b"+o+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))){var r=t,a=i.label||i,l={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};o&&a&&/^Win/i.test(r)&&!/^Windows Phone /i.test(r)&&(l=l[/[\d.]+$/.exec(r)])&&(r="Windows "+l),r=String(r),o&&a&&(r=r.replace(RegExp(o,"i"),a)),t=r=n(r.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return t});if(x&&(x=[x]),D&&!B&&(B=t([D])),(v=/\bGoogle TV\b/.exec(B))&&(B=v[0]),/\bSimulator\b/i.test(e)&&(B=(B?B+" ":"")+"Simulator"),"Opera Mini"==M&&/\bOPiOS\b/.test(e)&&f.push("running in Turbo/Uncompressed mode"),"IE"==M&&/\blike iPhone OS\b/.test(e)?(D=(v=l(e.replace(/like iPhone OS/,""))).manufacturer,B=v.product):/^iP/.test(B)?(M||(M="Safari"),U="iOS"+((v=/ OS ([\d_]+)/i.exec(e))?" "+v[1].replace(/_/g,"."):"")):"Konqueror"!=M||/buntu/i.test(U)?D&&"Google"!=D&&(/Chrome/.test(M)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(B))||/\bAndroid\b/.test(U)&&/^Chrome/.test(M)&&/\bVersion\//i.test(e)?(M="Android Browser",U=/\bAndroid\b/.test(U)?U:"Android"):"Silk"==M?(/\bMobi/i.test(e)||(U="Android",f.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&f.unshift("accelerated")):"PaleMoon"==M&&(v=/\bFirefox\/([\d.]+)\b/.exec(e))?f.push("identifying as Firefox "+v[1]):"Firefox"==M&&(v=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(U||(U="Firefox OS"),B||(B=v[1])):!M||(v=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(M))?(M&&!B&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(v+"/")+8))&&(M=null),(v=B||D||U)&&(B||D||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(U))&&(M=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(U)?U:v)+" Browser")):"Electron"==M&&(v=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&f.push("Chromium "+v):U="Kubuntu",g||(g=u(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",s(M),"(?:Firefox|Minefield|NetFront)"])),(v="iCab"==x&&3<parseFloat(g)&&"WebKit"||/\bOpera\b/.test(M)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(x)&&"WebKit"||!x&&/\bMSIE\b/i.test(e)&&("Mac OS"==U?"Tasman":"Trident")||"WebKit"==x&&/\bPlayStation\b(?! Vita\b)/i.test(M)&&"NetFront")&&(x=[v]),"IE"==M&&(v=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(M+=" Mobile",U="Windows Phone "+(/\+$/.test(v)?v:v+".x"),f.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(M="IE Mobile",U="Windows Phone 8.x",f.unshift("desktop mode"),g||(g=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=M&&"Trident"==x&&(v=/\brv:([\d.]+)/.exec(e))&&(M&&f.push("identifying as "+M+(g?" "+g:"")),M="IE",g=v[1]),_){if(r(h,"global")){if($&&(O=(v=$.lang.System).getProperty("os.arch"),U=U||v.getProperty("os.name")+" "+v.getProperty("os.version")),b){try{g=h.require("ringo/engine").version.join("."),M="RingoJS"}catch(W){(v=h.system)&&v.global.system==h.system&&(M="Narwhal",U||(U=v[0].os||null))}M||(M="Rhino")}else"object"==typeof h.process&&!h.process.browser&&(v=h.process)&&("object"==typeof v.versions&&("string"==typeof v.versions.electron?(f.push("Node "+v.versions.node),M="Electron",g=v.versions.electron):"string"==typeof v.versions.nw&&(f.push("Chromium "+g,"Node "+v.versions.node),M="NW.js",g=v.versions.nw)),M||(M="Node.js",O=v.arch,U=v.platform,g=(g=/[\d.]+/.exec(v.version))?g[0]:null))}else o(v=h.runtime)==E?(M="Adobe AIR",U=v.flash.system.Capabilities.os):o(v=h.phantom)==y?(M="PhantomJS",g=(v=v.version||null)&&v.major+"."+v.minor+"."+v.patch):"number"==typeof A.documentMode&&(v=/\bTrident\/(\d+)/i.exec(e))?(g=[g,A.documentMode],(v=+v[1]+4)!=g[1]&&(f.push("IE "+g[1]+" mode"),x&&(x[1]=""),g[1]=v),g="IE"==M?String(g[1].toFixed(1)):g[0]):"number"==typeof A.documentMode&&/^(?:Chrome|Firefox)\b/.test(M)&&(f.push("masking as "+M+" "+g),M="IE",g="11.0",x=["Trident"],U="Windows");U=U&&n(U)}if(g&&(v=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(g)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(_&&d.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(L=/b/i.test(v)?"beta":"alpha",g=g.replace(RegExp(v+"\\+?$"),"")+("beta"==L?w:S)+(/\d+\+?/.exec(v)||"")),"Fennec"==M||"Firefox"==M&&/\b(?:Android|Firefox OS)\b/.test(U))M="Firefox Mobile";else if("Maxthon"==M&&g)g=g.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(B))"Xbox 360"==B&&(U=null),"Xbox 360"==B&&/\bIEMobile\b/.test(e)&&f.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(M)&&(!M||B||/Browser|Mobi/.test(M))||"Windows CE"!=U&&!/Mobi/i.test(e)){if("IE"==M&&_)try{null===h.external&&f.unshift("platform preview")}catch(H){f.unshift("embedded")}else(/\bBlackBerry\b/.test(B)||/\bBB10\b/.test(e))&&(v=(RegExp(B.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||g)?(U=((v=[v,/BB10/.test(e)])[1]?(B=null,D="BlackBerry"):"Device Software")+" "+v[0],g=null):this!=i&&"Wii"!=B&&(_&&C||/Opera/.test(M)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==M&&/\bOS X (?:\d+\.){2,}/.test(U)||"IE"==M&&(U&&!/^Win/.test(U)&&5.5<g||/\bWindows XP\b/.test(U)&&8<g||8==g&&!/\bTrident\b/.test(e)))&&!p.test(v=l.call(i,e.replace(p,"")+";"))&&v.name&&(v="ing as "+v.name+((v=v.version)?" "+v:""),p.test(M)?(/\bIE\b/.test(v)&&"Mac OS"==U&&(U=null),v="identify"+v):(v="mask"+v,M=I?n(I.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(v)&&(U=null),_||(g=null)),x=["Presto"],f.push(v))}else M+=" Mobile";if((v=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(v=[parseFloat(v.replace(/\.(\d)$/,".0$1")),v],"Safari"==M&&"+"==v[1].slice(-1)?(M="WebKit Nightly",L="alpha",g=v[1].slice(0,-1)):(g==v[1]||g==(v[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1]))&&(g=null),v[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==v[0]&&537.36==v[2]&&28<=parseFloat(v[1])&&"WebKit"==x&&(x=["Blink"]),_&&(T||v[1])?(x&&(x[1]="like Chrome"),v=v[1]||(530>(v=v[0])?1:532>v?2:532.05>v?3:533>v?4:534.03>v?5:534.07>v?6:534.1>v?7:534.13>v?8:534.16>v?9:534.24>v?10:534.3>v?11:535.01>v?12:535.02>v?"13+":535.07>v?15:535.11>v?16:535.19>v?17:536.05>v?18:536.1>v?19:537.01>v?20:537.11>v?"21+":537.13>v?23:537.18>v?24:537.24>v?25:537.36>v?26:"Blink"!=x?"27":"28")):(x&&(x[1]="like Safari"),v=400>(v=v[0])?1:500>v?2:526>v?3:533>v?4:534>v?"4+":535>v?5:537>v?6:538>v?7:601>v?8:"8"),x&&(x[1]+=" "+(v+="number"==typeof v?".x":/[.+]/.test(v)?"":"+")),"Safari"==M&&(!g||45<parseInt(g))&&(g=v)),"Opera"==M&&(v=/\bzbov|zvav$/.exec(U))?(M+=" ",f.unshift("desktop mode"),"zvav"==v?(M+="Mini",g=null):M+="Mobile",U=U.replace(RegExp(" *"+v+"$"),"")):"Safari"==M&&/\bChrome\b/.exec(x&&x[1])&&(f.unshift("desktop mode"),M="Chrome Mobile",g=null,/\bOS X\b/.test(U)?(D="Apple",U="iOS 4.3+"):U=null),g&&0==g.indexOf(v=/[\d.]+$/.exec(U))&&-1<e.indexOf("/"+v+"-")&&(U=String(U.replace(v,"")).replace(/^ +| +$/g,"")),x&&!/\b(?:Avant|Nook)\b/.test(M)&&(/Browser|Lunascape|Maxthon/.test(M)||"Safari"!=M&&/^iOS/.test(U)&&/\bSafari\b/.test(x[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(M)&&x[1])&&(v=x[x.length-1])&&f.push(v),f.length&&(f=["("+f.join("; ")+")"]),D&&B&&0>B.indexOf(D)&&f.push("on "+D),B&&f.push((/^on /.test(f[f.length-1])?"":"on ")+B),U){var F=(v=/ ([\d.+]+)$/.exec(U))&&"/"==U.charAt(U.length-v[0].length-1);U={architecture:32,family:v&&!F?U.replace(v[0],""):U,version:v?v[1]:null,toString:function(){var e=this.version;return this.family+(e&&!F?" "+e:"")+(64==this.architecture?" 64-bit":"")}}}return(v=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(O))&&!/\bi686\b/i.test(O)?(U&&(U.architecture=64,U.family=U.family.replace(RegExp(" *"+v),"")),M&&(/\bWOW64\b/i.test(e)||_&&/\w(?:86|32)$/.test(d.cpuClass||d.platform)&&!/\bWin64; x64\b/i.test(e))&&f.unshift("32-bit")):U&&/^OS X/.test(U.family)&&"Chrome"==M&&39<=parseFloat(g)&&(U.architecture=64),e||(e=null),(h={}).description=e,h.layout=x&&x[0],h.manufacturer=D,h.name=M,h.prerelease=L,h.product=B,h.ua=e,h.version=M&&g,h.os=U||{architecture:null,family:null,version:null,toString:function(){return"null"}},h.parse=l,h.toString=function(){return this.description||""},h.version&&f.unshift(g),h.name&&f.unshift(M),U&&M&&(U!=String(U).split(" ")[0]||U!=M.split(" ")[0]&&!B)&&f.push(B?"("+U+")":"on "+U),f.length&&(h.description=f.join(" ")),h}var u={function:!0,object:!0},c=u[typeof window]&&window||this,h=u[typeof exports]&&exports;u=u[typeof module]&&module&&!module.nodeType&&module;var f=h&&u&&"object"==typeof global&&global;f&&(f.global===f||f.window===f||f.self===f)&&(c=f);var d=9007199254740991,p=/\bOpera/,g=(f=Object.prototype).hasOwnProperty,m=f.toString,T=l();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(c.platform=T,define(function(){return T})):h&&u?i(T,function(e,t){h[t]=e}):c.platform=T}).call(this);var FORBIDDEN_LIST="2 girls 1 cup;2g1c;4r5e;5h1t;5hit;a_s_s;a55;a55hole;acrotomophilia;aeolus;ahole;alabama hot pocket;alaskan pipeline;anal;analprobe;anilingus;anus;apeshit;ar5e;areola;areole;arian;arrse;arse;arsehole;aryan;ass;ass hole;assbag;assbandit;assbang;assbanged;assbanger;assbangs;assbite;assclown;asscock;asscracker;asses;assface;assfuck;assfucker;ass-fucker;assfukka;assgoblin;assh0le;asshat;ass-hat;asshead;assho1e;asshole;assholes;asshopper;ass-jabber;assjacker;asslick;asslicker;assmaster;assmonkey;assmunch;assmuncher;assnigger;asspirate;ass-pirate;assshit;assshole;asssucker;asswad;asswhole;asswipe;asswipes;auto erotic;autoerotic;axwound;azazel;azz;b!tch;b00bs;b17ch;b1tch;babe;babeland;babes;baby batter;baby juice;ball gag;ball gravy;ball kicking;ball licking;ball sack;ball sucking;ballbag;balls;ballsack;bampot;bang;bangbros;banger;bareback;barely legal;barenaked;barf;bastard;bastardo;bastards;bastinado;bawdy;bbw;bdsm;beaner;beaners;beardedclam;beastial;beastiality;beatch;beater;beaver;beaver cleaver;beaver lips;beer;beeyotch;bellend;beotch;bestial;bestiality;bi+ch;biatch;big black;big breasts;big knockers;big tits;bigtits;bimbo;bimbos;birdlock;bitch;bitchass;bitched;bitcher;bitchers;bitches;bitchin;bitching;bitchtits;bitchy;black cock;blonde action;blonde on blonde action;bloody;blow;blow job;blow your load;blowjob;blowjobs;blue waffle;blumpkin;bod;bodily;boink;boiolas;bollock;bollocks;bollok;bollox;bondage;bone;boned;boner;boners;bong;boob;boobies;boobs;booby;booger;bookie;booobs;boooobs;booooobs;booooooobs;bootee;bootie;booty;booty call;booze;boozer;boozy;bosom;bosomy;bowel;bowels;bra;brassiere;breast;breasts;breeder;brotherfucker;brown showers;brunette action;buceta;bugger;bukkake;bull shit;bulldyke;bullet vibe;bullshit;bullshits;bullshitted;bullturds;bum;bumblefuck;bung;bung hole;bunghole;bunny fucker;busty;butt;butt fuck;butt plug;buttcheeks;buttfuck;buttfucka;buttfucker;butthole;buttmuch;butt-pirate;buttplug;c.0.c.k;c.o.c.k.;c.u.n.t;c0ck;c-0-c-k;c0cksucker;caca;cahone;camel toe;cameltoe;camgirl;camslut;camwhore;carpet muncher;carpetmuncher;cawk;cervix;chesticle;chinc;chincs;chink;choad;chocolate rosebuds;chode;chodes;cipa;circlejerk;cl1t;cleveland steamer;climax;clit;clitface;clitfuck;clitoris;clitorus;clits;clitty;clover clamps;clusterfuck;cnut;cocain;cocaine;cock;c-o-c-k;cock sucker;cockass;cockbite;cockblock;cockburger;cockeye;cockface;cockfucker;cockhead;cockholster;cockjockey;cockknocker;cockknoker;cocklump;cockmaster;cockmongler;cockmongruel;cockmonkey;cockmunch;cockmuncher;cocknose;cocknugget;cocks;cockshit;cocksmith;cocksmoke;cocksmoker;cocksniffer;cocksuck;cocksucked;cocksucker;cock-sucker;cocksucking;cocksucks;cocksuka;cocksukka;cockwaffle;coital;cok;cokmuncher;coksucka;commie;condom;coochie;coochy;coon;coons;cooter;coprolagnia;coprophilia;corksucker;cornhole;cox;crabs;crack;cracker;crackwhore;crap;crappy;creampie;crotte;cum;cumbubble;cumdumpster;cumguzzler;cumjockey;cummer;cummin;cumming;cums;cumshot;cumshots;cumslut;cumstain;cumtart;cunilingus;cunillingus;cunnie;cunnilingus;cunny;cunt;c-u-n-t;cuntass;cuntface;cunthole;cunthunter;cuntlick;cuntlicker;cuntlicking;cuntrag;cunts;cuntslut;cyalis;cyberfuc;cyberfuck;cyberfucked;cyberfucker;cyberfuckers;cyberfucking;d0ng;d0uch3;d0uche;d1ck;d1ld0;d1ldo;dago;dagos;dammit;damn;damned;damnit;darkie;date rape;daterape;dawgie-style;deep throat;deepthroat;deggo;dendrophilia;dick;dickbag;dickbeaters;dickdipper;dickface;dickflipper;dickfuck;dickfucker;dickhead;dickheads;dickhole;dickish;dick-ish;dickjuice;dickmilk�;dickmonger;dickripper;dicks;dicksipper;dickslap;dick-sneeze;dicksucker;dicksucking;dicktickler;dickwad;dickweasel;dickweed;dickwhipper;dickwod;dickzipper;diddle;dike;dildo;dildos;diligaf;dillweed;dimwit;dingle;dingleberries;dingleberry;dink;dinks;dipship;dipshit;dirsa;dirty pillows;dirty sanchez;dlck;dog style;dog-fucker;doggie style;doggiestyle;doggie-style;doggin;dogging;doggy style;doggystyle;doggy-style;dolcett;domination;dominatrix;dommes;dong;donkey punch;donkeyribber;doochbag;doofus;dookie;doosh;dopey;double dong;double penetration;doublelift;douch3;douche;douchebag;douchebags;douche-fag;douchewaffle;douchey;dp action;drunk;dry hump;duche;dumass;dumb ass;dumbass;dumbasses;dumbcunt;dumbfuck;dumbshit;dummy;dumshit;dvda;dyke;dykes;eat my ass;ecchi;ejaculate;ejaculated;ejaculates;ejaculating;ejaculatings;ejaculation;ejakulate;enlargement;erect;erection;erotic;erotism;escort;essohbee;eunuch;extacy;extasy;f u c k;f u c k e r;f.u.c.k;f_u_c_k;f4nny;fack;fag;fagbag;fagfucker;fagg;fagged;fagging;faggit;faggitt;faggot;faggotcock;faggs;fagot;fagots;fags;fagtard;faig;faigt;fanny;fannybandit;fannyflaps;fannyfucker;fanyy;fart;fartknocker;fat;fatass;fcuk;fcuker;fcuking;fecal;feck;fecker;felch;felcher;felching;fellate;fellatio;feltch;feltcher;female squirting;femdom;figging;fingerbang;fingerfuck;fingerfucked;fingerfucker;fingerfuckers;fingerfucking;fingerfucks;fingering;fisted;fistfuck;fistfucked;fistfucker;fistfuckers;fistfucking;fistfuckings;fistfucks;fisting;fisty;flamer;flange;floozy;foad;foah;fondle;foobar;fook;fooker;foot fetish;footjob;foreskin;freex;frigg;frigga;frotting;fubar;fuck;f-u-c-k;fuck buttons;fuck off;fucka;fuckass;fuckbag;fuckboy;fuckbrain;fuckbutt;fuckbutter;fucked;fucker;fuckers;fuckersucker;fuckface;fuckhead;fuckheads;fuckhole;fuckin;fucking;fuckings;fuckingshitmotherfucker;fuckme;fucknugget;fucknut;fucknutt;fuckoff;fucks;fuckstick;fucktard;fuck-tard;fucktards;fucktart;fucktwat;fuckup;fuckwad;fuckwhit;fuckwit;fuckwitt;fudge packer;fudgepacker;fuk;fuker;fukker;fukkin;fuks;fukwhit;fukwit;futanari;fux;fux0r;fvck;fxck;gae;gai;gang bang;gangbang;gangbanged;gangbangs;ganja;gay;gay sex;gayass;gaybob;gaydo;gayfuck;gayfuckist;gaylord;gays;gaysex;gaytard;gaywad;genitals;gey;gfy;ghay;ghey;giant cock;gigolo;girl on;girl on top;girls gone wild;glans;goatcx;goatse;god damn;godamn;godamnit;goddam;god-dam;goddammit;goddamn;goddamned;god-damned;goddamnit;gokkun;golden shower;goldenshower;gonad;gonads;goo girl;gooch;goodpoop;gook;gooks;goregasm;gringo;grope;group sex;gspot;g-spot;gtfo;guido;guro;h0m0;h0mo;hand job;handjob;hard core;hard on;hardcore;hardcoresex;he11;hebe;heeb;hell;hemp;hentai;heroin;herp;herpes;herpy;heshe;hitler;hiv;ho;hoar;hoare;hobag;hoe;hoer;hom0;homey;homo;homodumbshit;homoerotic;homoey;honkey;honky;hooch;hookah;hooker;hoor;hootch;hooter;hooters;hore;horniest;horny;hot carl;hot chick;hotsex;how to kill;how to murder;huge fat;hump;humped;humping;hussy;hymen;inbred;incest;injun;intercourse;j3rk0ff;jack Off;jackass;jackhole;jackoff;jack-off;jaggi;jagoff;jail bait;jailbait;jap;japs;jelly donut;jerk;jerk off;jerk0ff;jerkass;jerked;jerkoff;jerk-off;jigaboo;jiggaboo;jiggerboo;jism;jiz;jizm;jizz;jizzed;juggs;jungle bunny;junglebunny;junkie;junky;kawk;kike;kikes;kill;kinbaku;kinkster;kinky;kkk;klan;knob;knobbing;knobead;knobed;knobend;knobhead;knobjocky;knobjokey;kock;kondum;kondums;kooch;kooches;kootch;kraut;kum;kummer;kumming;kums;kunilingus;kunja;kunt;kyke;l3i+ch;l3itch;labia;lameass;lardass;leather restraint;leather straight jacket;lech;lemon party;leper;lesbian;lesbians;lesbo;lesbos;lez;lezbian;lezbians;lezbo;lezbos;lezzie;lezzies;lezzy;lmao;lmfao;loin;loins;lolita;lovemaking;lube;lust;lusting;lusty;m0f0;m0fo;m45terbate;ma5terb8;ma5terbate;make me come;male squirting;mams;masochist;massa;masterb8;masterbat;masterbat3;masterbate;master-bate;masterbating;masterbation;masterbations;masturbate;masturbating;masturbation;maxi;mcfagget;menage a trois;menses;menstruate;menstruation;meth;m-fucking;mick;milf;minge;missionary position;mof0;mofo;mo-fo;molest;moolie;moron;mothafuck;mothafucka;mothafuckas;mothafuckaz;mothafucked;mothafucker;mothafuckers;mothafuckin;mothafucking;mothafuckings;mothafucks;mother fucker;motherfuck;motherfucka;motherfucked;motherfucker;motherfuckers;motherfuckin;motherfucking;motherfuckings;motherfuckka;motherfucks;mound of venus;mr hands;mtherfucker;mthrfucker;mthrfucking;muff;muff diver;muffdiver;muffdiving;munging;murder;mutha;muthafecker;muthafuckaz;muthafucker;muthafuckker;muther;mutherfucker;mutherfucking;muthrfucking;n1gga;n1gger;nad;nads;naked;nambla;napalm;nappy;nawashi;nazi;nazism;negro;neonazi;nig nog;nigaboo;nigg3r;nigg4h;nigga;niggah;niggas;niggaz;nigger;niggers;niggle;niglet;nimphomania;nimrod;ninny;nipple;nipples;nob;nob jokey;nobhead;nobjocky;nobjokey;nooky;nsfw images;nude;nudity;numbnuts;nut sack;nutsack;nympho;nymphomania;octopussy;omorashi;one cup two girls;one guy one jar;opiate;opium;oral;orally;organ;orgasim;orgasims;orgasm;orgasmic;orgasms;orgies;orgy;ovary;ovum;ovums;p.u.s.s.y.;p0rn;paddy;paedophile;paki;panooch;pantie;panties;panty;pastie;pasty;pawn;pcp;pecker;peckerhead;pedo;pedobear;pedophile;pedophilia;pedophiliac;pee;peepee;pegging;penetrate;penetration;penial;penile;penis;penisbanger;penisfucker;penispuffer;perversion;peyote;phalli;phallic;phone sex;phonesex;phuck;phuk;phuked;phuking;phukked;phukking;phuks;phuq;piece of shit;pigfucker;pillowbiter;pimp;pimpis;pinko;piss;piss pig;pissed;pissed off;pisser;pissers;pisses;pissflaps;pissin;pissing;pissoff;piss-off;pisspig;playboy;pleasure chest;pms;polack;pole smoker;polesmoker;pollock;ponyplay;poof;poon;poonani;poonany;poontang;poop;poop chute;poopchute;poopuncher;porch monkey;porchmonkey;porn;porno;pornography;pornos;pot;potty;prick;pricks;prig;prince albert piercing;pron;prostitute;prude;pthc;pube;pubes;pubic;pubis;punanny;punany;punkass;punky;punta;puss;pusse;pussi;pussies;pussy;pussylicking;pussypounder;pussys;pust;puto;queaf;queef;queer;queerbait;queerhole;queero;queers;quicky;quim;racy;raghead;raging boner;rape;raped;raper;raping;rapist;raunch;rectal;rectum;rectus;reefer;reetard;reich;renob;retard;retarded;reverse cowgirl;revue;rimjaw;rimjob;rimming;ritard;rosy palm;rosy palm and her 5 sisters;rtard;r-tard;rum;rump;rumprammer;ruski;rusty trombone;s hit;s&m;s.h.i.t.;s.o.b.;s_h_i_t;s0b;sadism;sadist;sand nigger;sandler;sandnigger;sanger;santorum;scag;scantily;scat;schizo;schlong;scissoring;screw;screwed;screwing;scroat;scrog;scrot;scrote;scrotum;scrud;scum;seaman;seamen;seduce;seks;semen;sex;sexo;sexual;sexy;sh!+;sh!t;sh1t;s-h-1-t;shag;shagger;shaggin;shagging;shamedame;shaved beaver;shaved pussy;shemale;shi+;shibari;shit;s-h-i-t;shitass;shitbag;shitbagger;shitblimp;shitbrains;shitbreath;shitcanned;shitcunt;shitdick;shite;shiteater;shited;shitey;shitface;shitfaced;shitfuck;shitfull;shithead;shithole;shithouse;shiting;shitings;shits;shitspitter;shitstain;shitt;shitted;shitter;shitters;shittiest;shitting;shittings;shitty;shiz;shiznit;shota;shrimping;sissy;skag;skank;skeet;skullfuck;slag;slanteye;slave;sleaze;sleazy;slut;slutbag;slutdumper;slutkiss;sluts;smeg;smegma;smut;smutty;snatch;sniper;snowballing;snuff;s-o-b;sodom;sodomize;sodomy;son-of-a-bitch;souse;soused;spac;sperm;spic;spick;spik;spiks;splooge;splooge moose;spooge;spook;spread legs;spunk;steamy;stfu;stiffy;stoned;strap on;strapon;strappado;strip;strip club;stroke;stupid;style doggy;suck;suckass;sucked;sucking;sucks;suicide girls;sultry women;sumofabiatch;swastika;swinger;t1t;t1tt1e5;t1tties;tainted love;tampon;tard;taste my;tawdry;tea bagging;teabagging;teat;teets;teez;terd;teste;testee;testes;testical;testicle;testis;threesome;throating;thrust;thug;thundercunt;tied up;tight white;tinkle;tit;titfuck;titi;tits;titt;tittie5;tittiefucker;titties;titty;tittyfuck;tittyfucker;tittywank;titwank;toke;tongue in a;toots;topless;tosser;towelhead;tramp;tranny;transsexual;trashy;tribadism;tub girl;tubgirl;turd;tush;tushy;tw4t;twat;twathead;twatlips;twats;twatty;twatwaffle;twink;twinkie;two girls one cup;twunt;twunter;ugly;unclefucker;undies;undressing;unwed;upskirt;urethra play;urinal;urine;urophilia;uterus;uzi;v14gra;v1gra;vag;vagina;vajayjay;va-j-j;valium;venus mound;viagra;vibrator;violet wand;virgin;vixen;vjayjay;vodka;vomit;vorarephilia;voyeur;vulgar;vulva;w00se;wad;wang;wank;wanker;wankjob;wanky;wazoo;wedgie;weed;weenie;weewee;weiner;weirdo;wench;wet dream;wetback;wh0re;wh0reface;white power;whitey;whiz;whoar;whoralicious;whore;whorealicious;whorebag;whored;whoreface;whorehopper;whorehouse;whores;whoring;wigger;willies;willy;womb;woody;wop;wrapping men;wrinkled starfish;wtf;xrated;x-rated;xx;xxx;yaoi;yeasty;yellow showers;yiffy;yobbo;zoophile;zoophilia;zubb".split(";");function CSecurityButton(e,t,n,i){this._init=function(e,t,n,i){o=!1,r=1,s=[],a=[],(l=new createjs.Container).x=e,l.y=t,i.addChild(l),(u=createBitmap(n)).scaleX=u.scaleY=r,u.regX=n.width/2,u.regY=n.height/2,l.addChild(u),d=DRAW_BUTTON_MAX_NUM_ASK,p=0,(g=new CMoveTimeController(-4,-8,l,TIME_TO_WAIT_DRAW_ENABLED_AGAIN[p])).addEventListener(ON_TIMER_END,this.resumeFromTimeOver,this),g.setSpectatorMode(),g.setAlwaysShown(),g.showAttempt(!1),this._initListener()},this.unload=function(){s_bMobile?l.off("mousedown",c):(l.off("mousedown",c),l.off("mouseover",h)),l.off("pressup",f),i.removeChild(l)},this.setVisible=function(e){l.visible=e},this.setClickable=function(e){o=!e},this._initListener=function(){s_bMobile?c=l.on("mousedown",this.buttonDown):(c=l.on("mousedown",this.buttonDown),h=l.on("mouseover",this.buttonOver)),f=l.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,n){s[e]=t,a[e]=n},this.buttonRelease=function(){o||(u.scaleX=r,u.scaleY=r,s[ON_MOUSE_UP]&&s[ON_MOUSE_UP].call(a[ON_MOUSE_UP]),0>=--d&&(d=DRAW_BUTTON_MAX_NUM_ASK,m.setWaitTime(TIME_TO_WAIT_DRAW_ENABLED_AGAIN[p]),++p>=TIME_TO_WAIT_DRAW_ENABLED_AGAIN.length&&(p=TIME_TO_WAIT_DRAW_ENABLED_AGAIN.length-1)))},this.buttonDown=function(){o||(u.scaleX=.9*r,u.scaleY=.9*r,playSound("click",1,!1),s[ON_MOUSE_DOWN]&&s[ON_MOUSE_DOWN].call(a[ON_MOUSE_DOWN]))},this.buttonOver=function(e){s_bMobile||o||(e.target.cursor="pointer")},this.pulseAnimation=function(){createjs.Tween.get(u,{loop:!0}).to({scaleX:.9*r,scaleY:.9*r},850,createjs.Ease.quadOut).to({scaleX:r,scaleY:r},650,createjs.Ease.quadIn)},this.trembleAnimation=function(){createjs.Tween.get(u,{loop:!0}).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750)},this.stopTrembleAnimation=function(){u.rotation=0,createjs.Tween.removeTweens(u)},this.stopAnimation=function(){u.rotation=0,createjs.Tween.removeTweens(u)},this.setPosition=function(e,t){l.x=e,l.y=t},this.setX=function(e){l.x=e},this.setY=function(e){l.y=e},this.getButtonImage=function(){return u},this.getX=function(){return l.x},this.getY=function(){return l.y},this.setWaitTime=function(e){u.alpha=.5,g.setTime(e),g.startTimer(),o=!0},this.resumeFromTimeOver=function(){u.alpha=1,g.stopTimer(),o=!1};var o,r,s,a,l,u,c,h,f,d,p,g,m=this;return this._init(e,t,n,i),this}!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.TreeModel=e()}}(function(){return(function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw(l=Error("Cannot find module '"+s+"'")).code="MODULE_NOT_FOUND",l}l=n[s]={exports:{}},t[s][0].call(l.exports,function(e){var n;return o(t[s][1][e]||e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o})({1:[function(e,t,n){var i=e("mergesort"),o=e("find-insert-index");t.exports=function(){function e(e){this.config=e=e||{},this.config.childrenPropertyName=e.childrenPropertyName||"children",this.config.modelComparatorFn=e.modelComparatorFn}function t(e,t){this.config=e,this.model=t,this.children=[]}function n(e,n,i){if(!(n instanceof t))throw TypeError("Child must be of type Node.");if(n.parent=e,e.model[e.config.childrenPropertyName]instanceof Array||(e.model[e.config.childrenPropertyName]=[]),"function"==typeof e.config.modelComparatorFn){var r=o(e.config.modelComparatorFn,e.model[e.config.childrenPropertyName],n.model);e.model[e.config.childrenPropertyName].splice(r,0,n.model),e.children.splice(r,0,n)}else if(void 0===i)e.model[e.config.childrenPropertyName].push(n.model),e.children.push(n);else{if(0>i||i>e.children.length)throw Error("Invalid index.");e.model[e.config.childrenPropertyName].splice(i,0,n.model),e.children.splice(r,0,n)}return n}function r(){var e={};if(1===arguments.length?e.fn=arguments[0]:2===arguments.length?"function"==typeof arguments[0]?(e.fn=arguments[0],e.ctx=arguments[1]):(e.options=arguments[0],e.fn=arguments[1]):(e.options=arguments[0],e.fn=arguments[1],e.ctx=arguments[2]),e.options=e.options||{},e.options.strategy||(e.options.strategy="pre"),!s[e.options.strategy])throw Error("Unknown tree walk strategy. Valid strategies are 'pre' [default], 'post' and 'breadth'.");return e}var s={};return e.prototype.parse=function(e){if(!(e instanceof Object))throw TypeError("Model must be of type object.");var n,o=new t(this.config,e);if(e[this.config.childrenPropertyName]instanceof Array){this.config.modelComparatorFn&&(e[this.config.childrenPropertyName]=i(this.config.modelComparatorFn,e[this.config.childrenPropertyName]));var r=0;for(n=e[this.config.childrenPropertyName].length;r<n;r++){var s=o,a=this.parse(e[this.config.childrenPropertyName][r]);a.parent=s,s.children.push(a)}}return o},t.prototype.isRoot=function(){return void 0===this.parent},t.prototype.hasChildren=function(){return 0<this.children.length},t.prototype.addChild=function(e){return n(this,e)},t.prototype.addChildAtIndex=function(e,t){if("function"==typeof this.config.modelComparatorFn)throw Error("Cannot add child at index when using a comparator function.");return n(this,e,t)},t.prototype.getPath=function(){var e=[];return function t(n){e.unshift(n),n.isRoot()||t(n.parent)}(this),e},t.prototype.walk=function(){var e=r.apply(this,arguments);s[e.options.strategy].call(this,e.fn,e.ctx)},s.pre=function e(t,n){var i,o=t.call(n,this),r=0;for(i=this.children.length;r<i;r++){if(!1===o)return!1;o=e.call(this.children[r],t,n)}return o},s.post=function e(t,n){var i,o,r=0;for(o=this.children.length;r<o;r++){if(!1===e.call(this.children[r],t,n))return!1}return t.call(n,this)},s.breadth=function(e,t){var n=[this];!function i(){var o;if(0!==n.length){var r=n.shift(),s=0;for(o=r.children.length;s<o;s++)n.push(r.children[s]);!1!==e.call(t,r)&&i()}}()},t.prototype.all=function(){var e=[],t=r.apply(this,arguments);return s[t.options.strategy].call(this,function(n){t.fn.call(t.ctx,n)&&e.push(n)},t.ctx),e},t.prototype.first=function(){var e,t=r.apply(this,arguments);return s[t.options.strategy].call(this,function(n){if(t.fn.call(t.ctx,n))return e=n,!1},t.ctx),e},t.prototype.drop=function(){if(!this.isRoot()){var e=this.parent.children.indexOf(this);this.parent.children.splice(e,1),this.parent.model[this.config.childrenPropertyName].splice(e,1),this.parent=void 0,delete this.parent}return this},e}()},{"find-insert-index":2,mergesort:3}],2:[function(e,t,n){t.exports=function(e,t,n){var i,o=0;for(i=t.length;o<i&&!(0<e(t[o],n));o++);return o}},{}],3:[function(e,t,n){t.exports=function(){function e(t,n){var i=n.length;if(2<=i){var o=n.slice(0,i/2);i=n.slice(i/2,i),o=e(t,o),i=e(t,i);for(var r=[],s=o.length,a=i.length;0<s&&0<a;)0>=t(o[0],i[0])?(r.push(o.shift()),s--):(r.push(i.shift()),a--);return 0<s?r.push.apply(r,o):r.push.apply(r,i),r}return n.slice()}return e}()},{}]},{},[1])(1)});var JSON,s_iOffsetX,s_iOffsetY,s_bIsIphone,s_iScaleFactor=1,s_bFocus=!0,s_bLandscape=!1,MIN_KEYBOARD_HEIGHT=300,s_bIsKeyboardOpen=!1,browserName=function(e){switch(!0){case -1<e.indexOf("edge"):return"MS Edge";case -1<e.indexOf("edg/"):return"Edge ( chromium based)";case -1<e.indexOf("opr")&&!!window.opr:return"Opera";case -1<e.indexOf("chrome")&&!!window.chrome:return"Chrome";case -1<e.indexOf("trident"):return"MS IE";case -1<e.indexOf("firefox"):return"Mozilla Firefox";case -1<e.indexOf("safari"):return"Safari";default:return"other"}}(window.navigator.userAgent.toLowerCase());function trace(e){console.log(e)}function getSize(e){var t=e.toLowerCase(),n=window.document,i=n.documentElement;if(void 0===window["inner"+e])e=i["client"+e];else if(window["inner"+e]!=i["client"+e]){var o=n.createElement("body");o.id="vpw-test-b",o.style.cssText="overflow:scroll";var r=n.createElement("div");r.id="vpw-test-d",r.style.cssText="position:absolute;top:-1000px",r.innerHTML="<style>@media("+t+":"+i["client"+e]+"px){body#vpw-test-b div#vpw-test-d{"+t+":7px!important}}</style>",o.appendChild(r),i.insertBefore(o,n.head),e=7==r["offset"+e]?i["client"+e]:window["inner"+e],i.removeChild(o)}else e=window["inner"+e];return e}function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler(),window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}function isIpad(){var e=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!!(!e&&navigator.userAgent.match(/Mac/))&&!!navigator.maxTouchPoints&&2<navigator.maxTouchPoints||e}function isMobile(){return!!isIpad()||!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}function isIOS(){if(isIpad())return!0;for(var e="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");e.length;)if(navigator.platform===e.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}function getHeightOfIOSToolbars(){var e=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<e?e:0}function playSound(e,t,n){}function stopSound(e){}function setVolume(e,t){}function setMute(e,t){}function fadeSound(e,t,n,i){}function soundPlaying(e){}function sizeHandler(){if(window.scrollTo(0,1),document.querySelector("#canvas")){var e=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height"),t=getSize("Width");s_bFocus&&_checkOrientation(t,e);var n=Math.min(e/CANVAS_HEIGHT,t/CANVAS_WIDTH);s_bSquareSize=!1,.75<(s_iAspectRatio=t/e)&&1.33>s_iAspectRatio&&(s_bSquareSize=!0),t>e?(s_bLandscape=!0,s_bMobile&&(document.querySelector("#div_display_id").style.display="none")):(s_bLandscape=!1,null!==s_oMenu&&768<=t?document.querySelector("#div_display_id").style.display="block":document.querySelector("#div_display_id").style.display="none");var i=Math.round(CANVAS_WIDTH*n);if((n=Math.round(CANVAS_HEIGHT*n))<e){var o=e-n;n+=o,i+=CANVAS_WIDTH/CANVAS_HEIGHT*o}else i<t&&(o=t-i,i+=o,n+=CANVAS_HEIGHT/CANVAS_WIDTH*o);o=e/2-n/2;var r=t/2-i/2,s=CANVAS_WIDTH/i;(r*s<-EDGEBOARD_X||o*s<-EDGEBOARD_Y)&&(n=Math.min(e/(CANVAS_HEIGHT-2*EDGEBOARD_Y),t/(CANVAS_WIDTH-2*EDGEBOARD_X)),i=CANVAS_WIDTH*n,n*=CANVAS_HEIGHT,o=(e-n)/2,r=(t-i)/2,s=CANVAS_WIDTH/i),s_iOffsetX=-1*r*s,s_iOffsetY=-1*o*s,0<=o&&(s_iOffsetY=0),0<=r&&(s_iOffsetX=0),null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY),null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY),null!==s_oModeMenu&&s_oModeMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY),document.querySelector("#canvas").style.width=i+"px",document.querySelector("#canvas").style.height=n+"px",0>o||(o=(e-n)/2),document.querySelector("#canvas").style.top=o+"px",document.querySelector("#canvas").style.left=r+"px",fullscreenHandler()}}function zoomInCamera(e,t,n,i,o){if(null!==e.getBounds()&&void 0!==e.getBounds())return t/=i,n/=o,n=t<=n?t:n,e.scaleX=e.scaleY=n}function inRectResize(e,t,n){if(null!==e.getBounds()&&void 0!==e.getBounds()){var i=e.getBounds().width;return t/=i,n=Math.min(t,n/(i=e.getBounds().height)),e.scaleX=e.scaleY=n}}function _checkOrientation(e,t){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(e>t?"landscape"===document.querySelector(".orientation-msg-container").getAttribute("data-orientation")?(document.querySelector(".orientation-msg-container").style.display="none",document.querySelector("body").classList.remove("orientation-alert"),s_oMain.startUpdate()):(document.querySelector(".orientation-msg-container").style.display="block",document.querySelector("body").classList.add("orientation-alert"),s_oMain.stopUpdate()):"portrait"===document.querySelector(".orientation-msg-container").getAttribute("data-orientation")?(document.querySelector(".orientation-msg-container").style.display="none",document.querySelector("body").classList.remove("orientation-alert"),s_oMain.startUpdate()):(document.querySelector(".orientation-msg-container").style.display="block",document.querySelector("body").classList.add("orientation-alert"),s_oMain.stopUpdate()))}function inIframe(){try{return window.self!==window.top}catch(e){return!0}}function createBitmap(e,t,n){var i=new createjs.Bitmap(e),o=new createjs.Shape;return t&&n?o.graphics.beginFill("#fff").drawRect(0,0,t,n):o.graphics.beginFill("#ff0").drawRect(0,0,e.width,e.height),i.hitArea=o,i}function createSprite(e,t,n,i,o,r){return e=null!==t?new createjs.Sprite(e,t):new createjs.Sprite(e),(t=new createjs.Shape).graphics.beginFill("#000000").drawRect(-n,-i,o,r),e.hitArea=t,e}function pad(e,t,n){return(e+="").length>=t?e:Array(t-e.length+1).join(n||"0")+e}function randomFloatBetween(e,t,n){return void 0===n&&(n=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(n))}function rotateVector2D(e,t){var n=t.getX()*Math.cos(e)+t.getY()*Math.sin(e),i=-(t.getX()*Math.sin(e))+t.getY()*Math.cos(e);t.set(n,i)}function tweenVectorsOnX(e,t,n){return e+n*(t-e)}function shuffle(e){for(var t,n,i=e.length;0!==i;)n=Math.floor(Math.random()*i),t=e[--i],e[i]=e[n],e[n]=t;return e}function bubbleSort(e){do for(var t=!1,n=0;n<e.length-1;n++)e[n]>e[n+1]&&(t=e[n],e[n]=e[n+1],e[n+1]=t,t=!0);while(t)}function compare(e,t){return e.index>t.index?-1:e.index<t.index?1:0}function easeLinear(e,t,n,i){return n*e/i+t}function easeInQuad(e,t,n,i){return n*(e/=i)*e+t}function easeInSine(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t}function easeInCubic(e,t,n,i){return n*(e/=i)*e*e+t}function getTrajectoryPoint(e,t){var n=new createjs.Point,i=(1-e)*(1-e),o=e*e;return n.x=i*t.start.x+2*(1-e)*e*t.traj.x+o*t.end.x,n.y=i*t.start.y+2*(1-e)*e*t.traj.y+o*t.end.y,n}function formatTime(e){var t=Math.floor((e/=1e3)/60);e=Math.floor(e-60*t);var n="";return n=10>t?n+"0"+t+":":n+(t+":"),10>e?n+"0"+e:n+e}function degreesToRadians(e){return e*Math.PI/180}function checkRectCollision(e,t){var n=getBounds(e,.9),i=getBounds(t,.98);return calculateIntersection(n,i)}function calculateIntersection(e,t){var n,i,o,r,s=e.x+(n=e.width/2),a=e.y+(i=e.height/2),l=t.x+(o=t.width/2),u=t.y+(r=t.height/2);return s=Math.abs(s-l)-(n+o),a=Math.abs(a-u)-(i+r),0>s&&0>a?(s=Math.min(Math.min(e.width,t.width),-s),a=Math.min(Math.min(e.height,t.height),-a),{x:Math.max(e.x,t.x),y:Math.max(e.y,t.y),width:s,height:a,rect1:e,rect2:t}):null}function getBounds(e,t){var n={x:1/0,y:1/0,width:0,height:0};if(e instanceof createjs.Container){n.x2=-1/0,n.y2=-1/0;var i,o=e.children,r=o.length;for(i=0;i<r;i++){var s=getBounds(o[i],1);s.x<n.x&&(n.x=s.x),s.y<n.y&&(n.y=s.y),s.x+s.width>n.x2&&(n.x2=s.x+s.width),s.y+s.height>n.y2&&(n.y2=s.y+s.height)}1/0==n.x&&(n.x=0),1/0==n.y&&(n.y=0),1/0==n.x2&&(n.x2=0),1/0==n.y2&&(n.y2=0),n.width=n.x2-n.x,n.height=n.y2-n.y,delete n.x2,delete n.y2}else{if(e instanceof createjs.Bitmap){i=(r=e.sourceRect||e.image).width*t;var a=r.height*t}else if(e instanceof createjs.Sprite){if(e.spriteSheet._frames&&e.spriteSheet._frames[e.currentFrame]&&e.spriteSheet._frames[e.currentFrame].image){i=(r=e.spriteSheet.getFrame(e.currentFrame)).rect.width,a=r.rect.height,o=r.regX;var l=r.regY}else n.x=e.x||0,n.y=e.y||0}else n.x=e.x||0,n.y=e.y||0;o=o||0,i=i||0,l=l||0,a=a||0,n.regX=o,n.regY=l,r=e.localToGlobal(0-o,0-l),s=e.localToGlobal(i-o,a-l),i=e.localToGlobal(i-o,0-l),o=e.localToGlobal(0-o,a-l),n.x=Math.min(Math.min(Math.min(r.x,s.x),i.x),o.x),n.y=Math.min(Math.min(Math.min(r.y,s.y),i.y),o.y),n.width=Math.max(Math.max(Math.max(r.x,s.x),i.x),o.x)-n.x,n.height=Math.max(Math.max(Math.max(r.y,s.y),i.y),o.y)-n.y}return n}function NoClickDelay(e){this.element=e,window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(e){for(var t,n,i=e.length;0<i;)n=Math.floor(Math.random()*i),t=e[--i],e[i]=e[n],e[n]=t;return e}function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}function getParamValue(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var i=t[n].split("=");if(i[0]==e)return i[1]}}function getParameterByName(e,t){t=void 0===t?window.location.href:t;var n=RegExp("[?&]"+(e=e.replace(/[\[\]]/g,"\\$&"))+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function removeParamFromURL(e,t){t=void 0===t?window.location.href:t;var n=new URL(t);return n.searchParams.delete(e),n.toString()}function copyObjectByValue(e){return JSON.parse(JSON.stringify(e))}function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oModeMenu&&s_oModeMenu.resetFullscreenBut())}function linearFunction(e,t,n,i,o){return(e-t)*(o-i)/(n-t)+i}function removeElementByValue(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}function deepEqual(e,t){return e&&t&&"object"==typeof e&&"object"==typeof t?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(n,i){return n&&deepEqual(e[i],t[i])},!0):e===t}function insertInRoundBracket(e){return"("+e+")"}function CSpriteLibrary(){var e,t,n,i,o,r,s={};this.init=function(s,a,l){e={},n=t=0,i=s,o=a,r=l},this.addSprite=function(n,i){if(!s.hasOwnProperty(n)){var o=new Image;s[n]=e[n]={szPath:i,oSprite:o,bLoaded:!1},t++}},this.getSprite=function(e){return s.hasOwnProperty(e)?s[e].oSprite:null},this._onSpritesLoaded=function(){t=0,o.call(r)},this._onSpriteLoaded=function(){i.call(r),++n===t&&this._onSpritesLoaded()},this.loadSprites=function(){for(var t in e)e[t].oSprite.oSpriteLibrary=this,e[t].oSprite.szKey=t,e[t].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey),this.oSpriteLibrary._onSpriteLoaded(this.szKey)},e[t].oSprite.onerror=function(){},e[t].oSprite.src=e[t].szPath},this.setLoaded=function(e){s[e].bLoaded=!0},this.isLoaded=function(e){return s[e].bLoaded},this.getNumSprites=function(){return t}}function CTLText(e,t,n,i,o,r,s,a,l,u,c,h,f,d,p,g,m,T,E){T=void 0===T?11:T,E=void 0===E||E,this._oParentContainer=e,this._oContainer=new createjs.Container,this._oContainer.x=t,this._oContainer.y=n,this._oParentContainer.addChild(this._oContainer),this._iOutline=0,this._iWidth=i,this._iHeight=o,this._bMultiline=g,this._iStartingFontSize=this._iFontSize=r,this._szAlign=s,this._szColor=a,this._szFont=l,this._iPaddingH=c,this._iPaddingV=h,this._iEffectiveWidth=this._iWidth-2*this._iPaddingH,this._iEffectiveHeight=this._iHeight-2*this._iPaddingV,this._bVerticalAlign=p,this._bFitText=d,this._iMinTextSize=T,this._bDebug=m,this._bEllipsis=E,this._oDebugShape=null,this._fLineHeightFactor=u,this._oText=null,this.__setMsg(f),this.__createText()}function CToggle(e,t,n,i,o){var r,s,a,l,u,c,h,f,d=[];this._init=function(e,t,n,i){var c;s=!1,a=[],l=[],(u=createSprite(new createjs.SpriteSheet({images:[n],frames:{width:n.width/2,height:n.height,regX:n.width/2/2,regY:n.height/2},animations:{state_true:[0],state_false:[1]}}),"state_"+(r=i),n.width/2/2,n.height/2,n.width/2,n.height)).x=e,u.y=t,u.stop(),o.addChild(u),this._initListener()},this.unload=function(){s_bMobile?u.off("mousedown",c):(u.off("mousedown",c),u.off("mouseover",h)),u.off("pressup",f),o.removeChild(u)},this._initListener=function(){s_bMobile?c=u.on("mousedown",this.buttonDown):(c=u.on("mousedown",this.buttonDown),h=u.on("mouseover",this.buttonOver)),f=u.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,n){a[e]=t,l[e]=n},this.addEventListenerWithParams=function(e,t,n,i){a[e]=t,l[e]=n,d=i},this.enable=function(){s=!1,u.alpha=1,u.gotoAndStop("state_"+r)},this.disable=function(){s=!0,u.alpha=.5,u.gotoAndStop("state_false")},this.setClickable=function(e){s=!e},this.setActive=function(e){r=e,u.gotoAndStop("state_"+r)},this.buttonRelease=function(){s||(u.scaleX=1,u.scaleY=1,playSound("click",1,!1),r=!r,u.gotoAndStop("state_"+r),a[ON_MOUSE_UP]&&a[ON_MOUSE_UP].call(l[ON_MOUSE_UP],d))},this.buttonDown=function(){s||(u.scaleX=.9,u.scaleY=.9,a[ON_MOUSE_DOWN]&&a[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN],d))},this.buttonOver=function(e){s_bMobile||s||(e.target.cursor="pointer")},this.stopAnimation=function(){u.rotation=0,createjs.Tween.removeTweens(u)},this.getButtonImage=function(){return u},this.setPosition=function(e,t){u.x=e,u.y=t},this.setVisible=function(e){u.visible=e},this.setRotation=function(e){u.rotation=e},this.getState=function(){return r},this._init(e,t,n,i)}function CGfxButton(e,t,n,i){var o,r,s,a,l,u,c,h;return this._init=function(e,t,n,i){o=!1,r=1,s=[],a=[],(l=createBitmap(n)).x=e,l.y=t,l.regX=n.width/2,l.regY=n.height/2,i.addChild(l),this._initListener()},this.unload=function(){s_bMobile?l.off("mousedown",u):(l.off("mousedown",u),l.off("mouseover",c)),l.off("pressup",h),i.removeChild(l)},this.setVisible=function(e){l.visible=e},this.isVisible=function(){return l.visible},this.setClickable=function(e){o=!e},this.enable=function(){o=!1,l.alpha=1},this.disable=function(){o=!0,l.alpha=.5},this._initListener=function(){s_bMobile?u=l.on("mousedown",this.buttonDown):(u=l.on("mousedown",this.buttonDown),c=l.on("mouseover",this.buttonOver)),h=l.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,n){s[e]=t,a[e]=n},this.buttonRelease=function(){o||(l.scale=r,s[ON_MOUSE_UP]&&s[ON_MOUSE_UP].call(a[ON_MOUSE_UP]))},this.buttonDown=function(){o||(l.scale=.9*r,playSound("click",1,!1),s[ON_MOUSE_DOWN]&&s[ON_MOUSE_DOWN].call(a[ON_MOUSE_DOWN]))},this.buttonOver=function(e){s_bMobile||o||(e.target.cursor="pointer")},this.pulseAnimation=function(){createjs.Tween.get(l,{loop:!0}).to({scaleX:.9*r,scaleY:.9*r},850,createjs.Ease.quadOut).to({scaleX:r,scaleY:r},650,createjs.Ease.quadIn)},this.trembleAnimation=function(){createjs.Tween.get(l,{loop:!0}).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750)},this.stopTrembleAnimation=function(){createjs.Tween.removeTweens(l)},this.stopAnimation=function(){l.rotation=0,createjs.Tween.removeTweens(l)},this.setPosition=function(e,t){l.x=e,l.y=t},this.setScale=function(e){r=e,l.scale=e},this.setX=function(e){l.x=e},this.setY=function(e){l.y=e},this.getButtonImage=function(){return l},this.getX=function(){return l.x},this.getY=function(){return l.y},this._init(e,t,n,i),this}window.addEventListener("resize",function(e){sizeHandler()},!0),window.visualViewport.addEventListener("resize",function(e){e.target.height<MIN_KEYBOARD_HEIGHT?(s_bIsKeyboardOpen=!0,document.querySelector(".ctl-multiplayer-dlg-wrapper")&&(document.querySelector(".ctl-multiplayer-dlg-wrapper").style.height=e.target.height,document.querySelector(".ctl-multiplayer-dlg-content").style.transform="translate(-50%, -50%) scale(0.5)")):(s_bIsKeyboardOpen=!1,document.querySelector(".ctl-multiplayer-dlg-wrapper")&&(document.querySelector(".ctl-multiplayer-dlg-content").style.transform="translate(-50%, -50%) scale(1)",document.querySelector(".ctl-multiplayer-dlg-wrapper").style.height="100%"))}),window.onload=function(){setTimeout(()=>{s_oMain.gotoGame(1,0,{id:"rule_international",meta:{denom:"International",notes:"",suggested_quickmatch_time:10},origin_cell_color:"white",starting_board:[[null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"}],[{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null],[null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"}],[{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null,{color:"black",type:"pawn"},null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"}],[{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null],[null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"}],[{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null,{color:"white",type:"pawn"},null]],starting_player:"white",movement:"movement_diagonal",capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:"fly",pawn_can_continue_as_king:!1})},100)},window.addEventListener("orientationchange",onOrientationChange),NoClickDelay.prototype={handleEvent:function(e){switch(e.type){case"touchstart":this.onTouchStart(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onTouchEnd(e)}},onTouchStart:function(e){e.preventDefault(),this.moved=!1,this.element.addEventListener("touchmove",this,!1),this.element.addEventListener("touchend",this,!1)},onTouchMove:function(e){this.moved=!0},onTouchEnd:function(e){if(this.element.removeEventListener("touchmove",this,!1),this.element.removeEventListener("touchend",this,!1),!this.moved){3==(e=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY)).nodeType&&(e=e.parentNode);var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}}},function(){function e(e){var n={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};(e=e||window.event).type in n?document.body.className=n[e.type]:(document.body.className=this[t]?"hidden":"visible","hidden"===document.body.className?(s_oMain.stopUpdate(),s_bFocus=!1):(s_oMain.startUpdate(),s_bFocus=!0))}var t="hidden";t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e}(),String.prototype.format=function(){for(var e=this,t=arguments.length;t--;)e=e.replace(RegExp("\\{"+t+"\\}","gm"),arguments[t]);return e},screenfull.isEnabled&&screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut(),null!==s_oModeMenu&&s_oModeMenu.resetFullscreenBut()}),function(){function e(t){var o,r,s=t;if(i[s])s=i[s];else{for(var a,l=s,u=[],c=0;l;){if(null!==(a=n.text.exec(l)))u.push(a[0]);else if(null!==(a=n.modulo.exec(l)))u.push("%");else if(null!==(a=n.placeholder.exec(l))){if(a[2]){c|=1;var h,f=[],d=a[2];if(null!==(h=n.key.exec(d)))for(f.push(h[1]);""!==(d=d.substring(h[0].length));)if(null!==(h=n.key_access.exec(d)))f.push(h[1]);else if(null!==(h=n.index_access.exec(d)))f.push(h[1]);else throw SyntaxError("[sprintf] failed to parse named argument key");else throw SyntaxError("[sprintf] failed to parse named argument key");a[2]=f}else c|=2;if(3===c)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:a[0],param_no:a[1],keys:a[2],sign:a[3],pad_char:a[4],align:a[5],width:a[6],precision:a[7],type:a[8]})}else throw SyntaxError("[sprintf] unexpected placeholder");l=l.substring(a[0].length)}s=i[s]=u}for(d=0,l=arguments,a=1,u=s.length,f="";d<u;d++)if("string"==typeof s[d])f+=s[d];else if("object"==typeof s[d]){if((h=s[d]).keys)for(c=l[a],o=0;o<h.keys.length;o++){if(void 0==c)throw Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',h.keys[o],h.keys[o-1]));c=c[h.keys[o]]}else c=h.param_no?l[h.param_no]:l[a++];if(n.not_type.test(h.type)&&n.not_primitive.test(h.type)&&c instanceof Function&&(c=c()),n.numeric_arg.test(h.type)&&"number"!=typeof c&&isNaN(c))throw TypeError(e("[sprintf] expecting number but found %T",c));switch(n.number.test(h.type)&&(r=0<=c),h.type){case"b":c=parseInt(c,10).toString(2);break;case"c":c=String.fromCharCode(parseInt(c,10));break;case"d":case"i":c=parseInt(c,10);break;case"j":c=JSON.stringify(c,null,h.width?parseInt(h.width):0);break;case"e":c=h.precision?parseFloat(c).toExponential(h.precision):parseFloat(c).toExponential();break;case"f":c=h.precision?parseFloat(c).toFixed(h.precision):parseFloat(c);break;case"g":c=h.precision?String(Number(c.toPrecision(h.precision))):parseFloat(c);break;case"o":c=(parseInt(c,10)>>>0).toString(8);break;case"s":c=String(c),c=h.precision?c.substring(0,h.precision):c;break;case"t":c=String(!!c),c=h.precision?c.substring(0,h.precision):c;break;case"T":c=Object.prototype.toString.call(c).slice(8,-1).toLowerCase(),c=h.precision?c.substring(0,h.precision):c;break;case"u":c=parseInt(c,10)>>>0;break;case"v":c=c.valueOf(),c=h.precision?c.substring(0,h.precision):c;break;case"x":c=(parseInt(c,10)>>>0).toString(16);break;case"X":c=(parseInt(c,10)>>>0).toString(16).toUpperCase()}if(n.json.test(h.type))f+=c;else{if(n.number.test(h.type)&&(!r||h.sign))p=r?"+":"-",c=c.toString().replace(n.sign,"");else var p="";o=h.pad_char?"0"===h.pad_char?"0":h.pad_char.charAt(1):" ";var g=h.width-(p+c).length;g=h.width&&0<g?o.repeat(g):"",f+=h.align?p+c+g:"0"===o?p+g+c:g+p+c}}return f}function t(t,n){return e.apply(null,[t].concat(n||[]))}var n={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},i=Object.create(null);"undefined"!=typeof exports&&(exports.sprintf=e,exports.vsprintf=t),"undefined"!=typeof window&&(window.sprintf=e,window.vsprintf=t,"function"==typeof define&&define.amd&&define(function(){return{sprintf:e,vsprintf:t}}))}(),CTLText.prototype={constructor:CTLText,__autofit:function(){var e=this._szMsg,t=!(3>e.length)&&this._bEllipsis;if(t&&(this._oText.text=this._szMsg),t||this._bMultiline){var n=e.length-2,i=this._iStartingFontSize;this.__refreshTextFont(i);for(var o=this._oText.getBounds();o.height+this._iOutline>this._iEffectiveHeight||o.width+this._iOutline>this._iEffectiveWidth;){if(t&&i<this._iMinTextSize){if(n--,this._oText.text=e.slice(0,n)+"...",this.__updateY(),this.__verticalAlign(),1==n)break}else if(i--,this.__refreshTextFont(i),this.__updateY(),this.__verticalAlign(),i<this._iMinTextSize&&!t)break;o=this._oText.getBounds()}this._iFontSize=i,this.__updateY(),this.__verticalAlign(),this.__updateStroke()}else this.__autofitLight()},__checkAutofit:function(){this._bFitText?this.__autofit():(this.__refreshTextFont(this._iStartingFontSize),this.__updateY(),this.__verticalAlign(),this.__updateStroke())},__autofitLight:function(){this.__refreshTextFont(this._iStartingFontSize);var e=Math.floor(linearFunction(this._iEffectiveWidth,this._oText.getBounds().width+this._iOutline,0,this._iStartingFontSize,0));e>this._iStartingFontSize?e=this._iStartingFontSize:e<this._iMinTextSize&&(e=this._iMinTextSize),this.__refreshTextFont(e),this._iFontSize=e,this.__updateY(),this.__verticalAlign(),this.__updateStroke()},__refreshTextFont:function(e){this._oText.font=e+"px "+this._szFont,this._oText.lineHeight=Math.round(e*this._fLineHeightFactor)},__verticalAlign:function(){if(this._bVerticalAlign){var e=this._oText.getBounds().height;this._oText.y-=(e-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._iPaddingV,"middle"===this._oText.textBaseline&&(this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize))},__updateStroke:function(){this._oStroke&&(this._oStroke.x=this._oText.x,this._oStroke.y=this._oText.y,this._oStroke.text=this._oText.text,this._oStroke.font=this._oText.font,this._oStroke.lineHeight=this._oText.lineHeight)},__updateOutline:function(){this._iOutline=this._oStroke&&this._oStroke.outline>this._oText.outline?this._oStroke.outline:this._oText.outline},__updateHorizontalAlign:function(){switch(this._szAlign){case"center":this._oText.x=this._iWidth/2;break;case"left":this._oText.x=this._iPaddingH;break;case"right":this._oText.x=this._iWidth-this._iPaddingH}},__setMsg:function(e){this._szMsg=e,""!==this._szMsg&&this._szMsg||(this._szMsg=" ")},__createDebugShape:function(){this._oDebugShape=new createjs.Shape,this.__refreshDebugShape()},__refreshDebugShape:function(){this._oDebugShape.graphics.clear(),this._oDebugShape.graphics.beginFill("rgba(255,130,0,0.5)").drawRect(0,0,this._iWidth,this._iHeight).moveTo(this._iPaddingH,this._iHeight-this._iPaddingV).lineTo(this._iWidth-this._iPaddingH,this._iHeight-this._iPaddingV).lineTo(this._iWidth-this._iPaddingH,this._iPaddingV).lineTo(this._iPaddingH,this._iPaddingV).closePath().beginFill("rgba(255,0,0,0.5)").drawRect(this._iPaddingH,this._iPaddingV,this._iEffectiveWidth,this._iEffectiveHeight)},__updateLineWidth:function(){this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null,this._oStroke&&(this._oStroke.lineWidth=this._oText.lineWidth)},__updateWidth:function(){this.__updateLineWidth(),this.__updateHorizontalAlign()},__updateSize:function(){this.__checkAutofit(),this._bDebug&&this.__refreshDebugShape()},__createText:function(){this._bDebug&&(this.__createDebugShape(),this._oContainer.addChild(this._oDebugShape)),this._oText=new createjs.Text(this._szMsg,this._iFontSize+"px "+this._szFont,this._szColor),this._oText.textBaseline="middle",this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor),this._oText.textAlign=this._szAlign,this.__updateLineWidth(),this.__updateHorizontalAlign(),this._oContainer.addChild(this._oText),this.refreshText(this._szMsg)},setStroke:function(e,t){this._oStroke||(this._oStroke=this._oText.clone(),this._oContainer.addChild(this._oStroke),this._oContainer.swapChildren(this._oStroke,this._oText)),this.setStrokeColor(t||this._szStrokeColor),this.setStrokeSize(e||this._iStrokeSize)},setStrokeColor:function(e){this._szStrokeColor=e,this._oStroke&&(this._oStroke.color=this._szStrokeColor)},setStrokeSize:function(e){this._iStrokeSize=e,this._oStroke&&(this._oStroke.outline=this._iStrokeSize,this.__updateOutline(),this.__checkAutofit())},removeStroke:function(){this._oStroke&&(this._oContainer.removeChild(this._oStroke),this._oStroke=null,this.__updateOutline(),this.__checkAutofit())},roll:function(e,t,n,i,o,r){t=null==t?1500:t,n=null==n?createjs.Ease.linear:n;var s={score:parseInt(this._szMsg)};this._szMsg=e;var a=this._bFitText?function(){this._oText.text=Math.floor(s.score),this.__autofitLight()}:function(){this._oText.text=Math.floor(s.score),this.__updateY(),this.__verticalAlign(),this.__updateStroke()};this.stopRolling(),this._oTweenRollText=createjs.Tween.get(s,{override:!0}).to({score:e},t,n),this._oTweenRollText.on("change",a,this),this._oTweenRollText.on("complete",function(){i&&i.apply(o,r),this.stopRolling()},this,!0)},isRolling:function(){return null!=this._oTweenRollText},stopRolling:function(){this.isRolling()&&(this._oTweenRollText.removeAllEventListeners(),this._oTweenRollText.paused=!0,this._oTweenRollText=null)},pauseRolling:function(){this.isRolling()&&(this._oTweenRollText.paused=!0)},resumeRolling:function(){this.isRolling()&&(this._oTweenRollText.paused=!1)},setY:function(e){this._oContainer.y=e},setX:function(e){this._oContainer.x=e},setHorizontalSize:function(e,t){t=void 0===t?this._iPaddingH:t,this.__setHorizontalSizeVars(e,t),this.__updateWidth(),this.__updateSize()},setVerticalSize:function(e,t){t=void 0===t?this._iPaddingV:t,this.__setVerticalSizeVars(e,t),this.__updateSize()},setSize:function(e,t,n,i){n=void 0===n?this._iPaddingH:n,i=void 0===i?this._iPaddingV:i,this.__setHorizontalSizeVars(e,n),this.__setVerticalSizeVars(t,i),this.__updateWidth(),this.__updateSize()},__setHorizontalSizeVars:function(e,t){this._iWidth=e,this._iPaddingH=t,this._iEffectiveWidth=this._iWidth-2*this._iPaddingH},__setVerticalSizeVars:function(e,t){this._iHeight=e,this._iPaddingV=t,this._iEffectiveHeight=this._iHeight-2*this._iPaddingV},setPosition:function(e,t){this._oContainer.x=e,this._oContainer.y=t},setHorizontalAlign:function(e){this._szAlign=e,this._oText.textAlign=this._szAlign,this.__updateHorizontalAlign()},setVerticalAlign:function(e){this._bVerticalAlign=e},setOutline:function(e){this._oText.outline=e,this.__updateOutline()},setShadow:function(e,t,n,i){this._oText.shadow=new createjs.Shadow(e,t,n,i)},setColor:function(e){this._szColor=e,this._oText.color=this._szColor},setAlpha:function(e){this._oContainer.alpha=e},setVisible:function(e){this._oContainer.visible=e},setFontSize:function(e){this._iFontSize=this._iStartingFontSize=e,this.refreshText(this._szMsg)},setRegX:function(e){this._oContainer.regX=e},setRegY:function(e){this._oContainer.regY=e},removeTweens:function(){createjs.Tween.removeTweens(this._oContainer)},getText:function(){return this._oText},getTextWidth:function(){return this._oText.getBounds().width+this._iOutline},getTextHeight:function(){return this._oText.getBounds().height+this._iOutline},getMsg:function(){return this._szMsg},getX:function(){return this._oContainer.x},getY:function(){return this._oContainer.y},getHeight:function(){return this._iHeight},getWidth:function(){return this._iWidth},getPaddingH:function(){return this._iPaddingH},getPaddingV:function(){return this._iPaddingV},getColor:function(){return this._szColor},getFontSize:function(){return this._iFontSize},getContainer:function(){return this._oContainer},unload:function(){this.stopRolling(),createjs.Tween.removeTweens(this._oContainer),this._oParentContainer.removeChild(this._oContainer)},refreshText:function(e){this.__setMsg(e),this._oText.text=this._szMsg,this.__checkAutofit()}};var LANG_WIDTH=109,LANG_HEIGHT=109;function CButLang(e,t,n,i,o,r){var s,a,l,u,c,h,f=i;this._init=function(e,t,n,i){for(s=[],a=[],(h=new createjs.Container).x=e,h.y=t,u=h.on("mousedown",this._onPress,this),l=h.on("click",this._onChangeLang,this),r.addChild(h),e={},t=0;t<n;t++)e["lang_"+t]=t;n=new createjs.SpriteSheet({images:[i],frames:{width:LANG_WIDTH,height:LANG_HEIGHT},animations:e}),c=createSprite(n,"lang_"+f,0,0,LANG_WIDTH,LANG_HEIGHT),h.addChild(c),h.regX=LANG_WIDTH/2,h.regY=LANG_HEIGHT/2},this.unload=function(){h.off("mousedown",u),h.off("click",l)},this.addEventListener=function(e,t,n){s[e]=t,a[e]=n},this.setPosition=function(e,t){h.x=e,h.y=t},this.setLang=function(e){f=e,c.gotoAndStop("lang_"+f)},this._onPress=function(){h.scale=.9},this._onChangeLang=function(){h.scale=1,s[ON_SELECT_LANG]&&s[ON_SELECT_LANG].call(a[ON_SELECT_LANG],f)},this.getButtonImage=function(){return h},this._init(e,t,n,o)}function CRadialWipeWidget(e,t,n){var i,o,r,s,a,l,u;this._init=function(e,t,n){o=i=!1,r=0,(u=new createjs.Container).x=e,u.y=t,n.addChild(u),s=createjs.Graphics.getRGB(13211971),(a=new createjs.Shape).rotation=-90,a.alpha=1,u.addChild(a),(l=new createjs.Text(""," 60px "+PRIMARY_FONT,"#ffffff")).textAlign="center",l.textBaseline="alphabetic",l.y=20,l.shadow=new createjs.Shadow("#000000",5,5,10),u.addChild(l)},this.unload=function(){n.removeChild(u)},this.setPos=function(e,t){u.x=e,u.y=t},this.reset=function(){l.text="",stopSound("hurryup"),l.color="#ffffff"},this.setVisible=function(e){u.visible=e},this.setScale=function(e){u.scaleX=u.scaleY=e},this.setHurryUpMode=function(e){i=!0,r=e},this.removeHurryUpMode=function(){i=!1},this._showHurryUpWarning=function(){playSound("hurryup",1,!1)},this.alwaysShown=function(){o=!0},this._updateTimeText=function(e){l.text=Math.ceil(e/1e3)},this._updateRadialWipe=function(e,t){o||(t=r);var n=linearFunction(e,t,0,0,360);a.graphics.clear(),a.graphics.f(s),a.graphics.moveTo(0,0),a.graphics.arc(0,0,TIME_CONTROLLER_RADIUS,0,degreesToRadians(n),!0)},this.update=function(e,t){this._updateTimeText(e),this._updateRadialWipe(e,t),(0===e||e>r&&!o)&&(l.text="",a.graphics.clear()),i&&e<r&&(i=!1,this._showHurryUpWarning())},this._init(e,t,n)}function CTremble(e,t,n,i){this._init=function(e,t,n,i){a=s=!1,u=0,this._calculateDuration(),o=e.x,r=e.y,s||(s=!0,l=setInterval(function(){h._tremble()},n))},this._tremble=function(){if(a=!a){var f=.5>Math.random()?-i:i,d=.5>Math.random()?-i:i;e.x+=f,e.y+=d}else e.x=o,e.y=r;++u>c&&(u=0,s=!1,e.x=o,e.y=r,0===t?l=setInterval(function(){h._tremble()},n):clearInterval(l))},this._calculateDuration=function(){c=t/n},this.stopTremble=function(){clearInterval(l)};var o,r,s,a,l,u,c,h=this;this._init(e,t,n,i)}function CVector2(e,t){var n,i;this._init=function(e,t){n=e,i=t},this.add=function(e,t){n+=e,i+=t},this.addV=function(e){n+=e.getX(),i+=e.getY()},this.scalarDivision=function(e){n/=e,i/=e},this.subV=function(e){n-=e.getX(),i-=e.getY()},this.scalarProduct=function(e){n*=e,i*=e},this.invert=function(){n*=-1,i*=-1},this.dotProduct=function(e){return n*e.getX()+i*e.getY()},this.set=function(e,t){n=e,i=t},this.setV=function(e){n=e.getX(),i=e.getY()},this.length=function(){return Math.sqrt(n*n+i*i)},this.length2=function(){return n*n+i*i},this.normalize=function(){var e=this.length();0<e&&(n/=e,i/=e)},this.getNormalize=function(e){this.length(),e.set(n,i),e.normalize()},this.rot90CCW=function(){var e=n;n=-i,i=e},this.rot90CW=function(){var e=n;n=i,i=-e},this.getRotCCW=function(e){e.set(n,i),e.rot90CCW()},this.getRotCW=function(e){e.set(n,i),e.rot90CW()},this.ceil=function(){n=Math.ceil(n),i=Math.ceil(i)},this.round=function(){n=Math.round(n),i=Math.round(i)},this.toString=function(){return"Vector2: "+n+", "+i},this.print=function(){trace("Vector2: "+n+", "+i)},this.getX=function(){return n},this.getY=function(){return i},this._init(e,t)}function CAlertIcon(e,t,n,i){var o,r;this._init=function(e,t,n,i){r=i,(o=new createjs.Container).x=e,o.y=t,r.addChild(o),t=createBitmap(e=s_oSpriteLibrary.getSprite("icon_notify")),o.addChild(t),new CTLText(o,0,0,e.width,e.height,40,"center","#fff",PRIMARY_FONT,1,0,0,n,!0,!0,!1,!1),o.regX=e.width/2,o.regY=e.height/2},this.unload=function(){r.removeChild(o)},this.pulseAnimation=function(){createjs.Tween.get(o,{loop:!0}).to({scaleX:.8,scaleY:.8},850,createjs.Ease.quadOut).to({scaleX:1,scaleY:1},650,createjs.Ease.quadIn)},this._init(e,t,n,i)}var TEXT_DRAW="DRAW",TEXT_MOVES="MOVES",TEXT_THINKING="THINKING",TEXT_WAITING_MOVES="WAITING OPPONENT",TEXT_ARE_SURE="ARE YOU SURE?",TEXT_WINS="%s wins",TEXT_MODE="CHOOSE GAME MODE",TEXT_BLACK="BLACK",TEXT_WHITE="WHITE",TEXT_MOVES_AVAIL="NO MOVES AVAILABLE",TEXT_CREDITS_DEVELOPED="DEVELOPED BY",TEXT_LOCAL_PLAY="Play Local",TEXT_MULTIPLAYER="Online Multiplayer",TEXT_SURRENDER="Do you want to resign and play a new game against your opponent?",TEXT_OPPONENT_RESIGNED="OPPONENT RESIGNED",TEXT_YOU_RESIGNED="YOU HAVE RESIGNED",TEXT_NEWS="",TEXT_RULE_CHANGE="Change Rules",TEXT_RULE_CUSTOM="Custom",TEXT_RULE_INTERNATIONAL="International",TEXT_RULE_ENGLISH="English",TEXT_RULE_ITALIAN="Italian",TEXT_RULE_SPANISH="Spanish",TEXT_RULE_TURKISH="Turkish",TEXT_RULE_CANADIAN="Canadian",TEXT_RULE_BRAZILIAN="Brazilian",TEXT_RULE_RUSSIAN="Russian",TEXT_RULE_CAPTURE="Capture",TEXT_RULE_MANDATORY_CAPTURE="Mandatory Capture",TEXT_RULE_MANDATORY_MAX_CAPTURE="Mandatory capture of the maximum number of pieces",TEXT_RULE_KING_CAPTURE_FIRST="The king has priority in capturing",TEXT_RULE_MOVEMENT="Movement",TEXT_RULE_MOVEMENT_DIAGONAL="Diagonal",TEXT_RULE_MOVEMENT_STRAIGHT="Straight",TEXT_PAWN="Pawn",TEXT_PAWN_RULE_BACK="Backward capture",TEXT_KING="King",TEXT_RULE_MOVEMENT_KING_LONG="Flying",TEXT_RULE_MOVEMENT_KING_SHORT="Non Flying",TEXT_RULE_MOVEMENT_KING_LONG_BLOCK="Flying and Stop, the king must stop immediately after a capture, but can continue capturing",TEXT_RULE_PROTECTED_KING="Only kings capture other kings",TEXT_RULE_NOTE="Notes",TEXT_RULE_NOTE_INTERNATIONAL="Pieces promote only when ending their move on the final rank, not when passing through it",TEXT_RULE_NOTE_RUSSIAN="A man that enters the kings row during a jump and can continue to jump backwards, jumps backwards as a king, not as a man",TEXT_QUIT_FROM_GAME="%s QUIT THE GAME",TEXT_TIME_OVER="TIME OVER",TEXT_OFFERED_DRAW="You have been offered a draw.\nClick the button to accept it",TEXT_WAIT_FOR_A_DRAW="You offered a draw.\nWait for your opponent to accept it",TEXT_PLAYER_AGREED_TO_DRAW="(Players agreed to draw)",TEXT_CPU="AI",TEXT_PLAYER="Player",TEXT_PLAYER_KICKED="You were kicked from the game due to inactivity.",TEXT_MINUTES="Mins.",TEXT_NO_TIME="No Time",TEXT_NO_TIME_MODE="NO TIME MODE",TEXT_TIME_MODE="TIME MODE";function refreshLanguage(){}var CANVAS_WIDTH=1920,CANVAS_HEIGHT=1920,CANVAS_WIDTH_HALF=CANVAS_WIDTH/2,CANVAS_HEIGHT_HALF=CANVAS_HEIGHT/2,EDGEBOARD_X=530,EDGEBOARD_Y=530,FPS=60,FPS_TIME=1e3/FPS,DISABLE_SOUND_MOBILE=!1,GAME_ORIENTATION="portrait",MANDATORY_JUMP_ACTIVE=!1,TIME_PER_MOVE=3e4,TIME_HURRYUP_WARNING=1e4,MULTIPLAYER_TEST_LOCAL=!1,COMBINED_PLAYERS_MODE=!1,PRIMARY_FONT="RoundedMplus1c",SECONDARY_FONT="ArialRounded",FONT_COLOR="#402604",STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_SELECT_LANG=6,ON_TIMER_END=7,ON_LAST_TIMER_END=8,ON_END_AI_COMPUTATION=15,ON_EXIT_RULE_PANEL=16,MODE_HUMAN=0,MODE_COMPUTER=1,EASY_MODE=0,MEDIUM_MODE=1,HARD_MODE=2,NUM_CELL_REFERENCE=8,BOARD_SIZE_REFERENCE=820,CELL_SIZE_REFERENCE=BOARD_SIZE_REFERENCE/NUM_CELL_REFERENCE,BG_BLACK=0,BG_WHITE=1,DRAW="draw",WIN_WHITE_BLACK_NOMOVES="win_white_black_nomoves",WIN_BLACK_WHITE_NOMOVES="win_black_white_nomoves",TIME_OVER="time_over",DRAW_AGREED="draw_agreed",SURRENDER="surrender",TOP="top",BOTTOM="bottom",PAWN="pawn",KING="king",WHITE="white",BLACK="black",PAWN_STOP=-1,PAWN_MOVE=0,PAWN_EAT=1,PLAYER_STATE_WAIT=0,PLAYER_STATE_SELECTED=1,PLAYER_STATE_PATH_CHOSEN=2,PLAYER_STATE_MOVING=3,ALERT_TYPE_NOMOVES=0,ALERT_TYPE_STALL=1,PAWN_SIZE=100,MATCH_MINUTES_TYPE=[0,3,5,10],MATCH_MINUTES_DEFAULT_INDEX=2,ANIM_TIME_MOVE_TYPE=[500,150,500,500];TIME_PER_MOVE=[9e4,6e4,9e4,9e4],TIME_HURRYUP_WARNING=[25e3,15e3,2e4,25e3];var TIME_CONTROLLER_RADIUS=50,NUM_ATTEMPT=0,DRAW_BUTTON_MAX_NUM_ASK=6,TIME_TO_WAIT_DRAW_ENABLED_AGAIN=[1e4,3e4,6e4];ON_TIMER_END=0,ON_LAST_TIMER_END=1;var START_SCORE,SCORE_DECREASE_PER_SECOND,SHOW_SCORE,ENABLE_CHECK_ORIENTATION,ENABLE_FULLSCREEN,TIME_LOOP_WAIT=1e3,MIN_AI_THINKING=1e3,MAX_AI_THINKING=2e3,INFINITE=99999,DRAW_COUNTER=40,DEFAULT_RULE_FLAG=2,NUM_LANGUAGES=13,LANG_EN=0,LANG_RU=1,LANG_ES=2,LANG_FR=3,LANG_DE=4,LANG_PT=5,LANG_IT=6,LANG_AR=7,LANG_HI=8,LANG_TR=9,LANG_ID=10,LANG_JA=11,LANG_ZH=12,LANG_CODES={};LANG_CODES.en=LANG_EN,LANG_CODES.ru=LANG_RU,LANG_CODES.es=LANG_ES,LANG_CODES.fr=LANG_FR,LANG_CODES.de=LANG_DE,LANG_CODES.pt=LANG_PT,LANG_CODES.it=LANG_IT,LANG_CODES.ar=LANG_AR,LANG_CODES.hi=LANG_HI,LANG_CODES.tr=LANG_TR,LANG_CODES.id=LANG_ID,LANG_CODES.ja=LANG_JA,LANG_CODES.zh=LANG_ZH,LANG_CODES.be=LANG_RU,LANG_CODES.kk=LANG_RU,LANG_CODES.uk=LANG_RU,LANG_CODES.uz=LANG_RU;var PARAM_ROOM_ID="roomid",PARAM_PASSWORD="pwd",PARAM_GAMETYPE="gametype",HTTPS_FORMAT="https://%s/",CODETHISLAB_LINK_COM="",CODETHISLAB_LINK_IT="",CODETHISLAB_LINK=CODETHISLAB_LINK_COM,RULE_INTERNATIONAL="rule_international",RULE_ENGLISH="rule_english",RULE_ITALIAN="rule_italian",RULE_SPANISH="rule_spanish",RULE_TURKISH="rule_turkish",RULE_CANADIAN="rule_canadian",RULE_BRAZILIAN="rule_brazilian",RULE_RUSSIAN="rule_russian",RULE_TEST="rule_test",RULES_ORDER=[RULE_INTERNATIONAL,RULE_ENGLISH,RULE_ITALIAN,RULE_SPANISH,RULE_TURKISH,RULE_CANADIAN,RULE_BRAZILIAN,RULE_RUSSIAN],WP={color:WHITE,type:PAWN},WK={color:WHITE,type:KING},BP={color:BLACK,type:PAWN},BK={color:BLACK,type:KING},RULE_PRESET={},KING_MOVEMENT_SINGLE="single",KING_MOVEMENT_FLY="fly",KING_MOVEMENT_FLY_BLOCK="fly_block",KING_MOVE_ORDER=[KING_MOVEMENT_SINGLE,KING_MOVEMENT_FLY,KING_MOVEMENT_FLY_BLOCK],MOVEMENT_HORIZONTAL="movement_horizontal",MOVEMENT_DIAGONAL="movement_diagonal";function refreshPresetsText(){RULE_PRESET[RULE_INTERNATIONAL].meta.denom=TEXT_RULE_INTERNATIONAL,RULE_PRESET[RULE_ENGLISH].meta.denom=TEXT_RULE_ENGLISH,RULE_PRESET[RULE_ITALIAN].meta.denom=TEXT_RULE_ITALIAN,RULE_PRESET[RULE_SPANISH].meta.denom=TEXT_RULE_SPANISH,RULE_PRESET[RULE_TURKISH].meta.denom=TEXT_RULE_TURKISH,RULE_PRESET[RULE_CANADIAN].meta.denom=TEXT_RULE_CANADIAN,RULE_PRESET[RULE_BRAZILIAN].meta.denom=TEXT_RULE_BRAZILIAN,RULE_PRESET[RULE_RUSSIAN].meta.denom=TEXT_RULE_RUSSIAN,RULE_PRESET[RULE_INTERNATIONAL].meta.notes=TEXT_RULE_NOTE_INTERNATIONAL,RULE_PRESET[RULE_RUSSIAN].meta.notes=TEXT_RULE_NOTE_RUSSIAN}RULE_PRESET[RULE_TEST]={denom:"",notes:"",origin_cell_color:WHITE,starting_board:[[BP,null,BP,null,BP,null,null,null],[null,BP,null,null,null,BP,null,null],[BP,null,BP,null,null,null,BP,null],[null,null,null,null,null,WK,null,null],[null,null,null,null,null,BP,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,WP,null,WP]],starting_player:WHITE,movement:MOVEMENT_HORIZONTAL,capture_rule:{mandatory:!1,maximize:!0,king_first:!0,king_protected:!0,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!0},RULE_PRESET[RULE_INTERNATIONAL]={id:RULE_INTERNATIONAL,meta:{denom:TEXT_RULE_INTERNATIONAL,notes:TEXT_RULE_NOTE_INTERNATIONAL,suggested_quickmatch_time:MATCH_MINUTES_TYPE[3]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,WP,null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1},RULE_PRESET[RULE_ENGLISH]={id:RULE_ENGLISH,meta:{denom:TEXT_RULE_ENGLISH,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null]],starting_player:BLACK,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!1,king_first:!1,king_protected:!1,back:!1},king_movement:KING_MOVEMENT_SINGLE,pawn_can_continue_as_king:!1},RULE_PRESET[RULE_ITALIAN]={id:RULE_ITALIAN,meta:{denom:TEXT_RULE_ITALIAN,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:BLACK,starting_board:[[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!0,back:!1},king_movement:KING_MOVEMENT_SINGLE,pawn_can_continue_as_king:!1},RULE_PRESET[RULE_SPANISH]={id:RULE_SPANISH,meta:{denom:TEXT_RULE_SPANISH,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:BLACK,starting_board:[[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!1,king_protected:!0,back:!1},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1},RULE_PRESET[RULE_TURKISH]={id:RULE_TURKISH,meta:{denom:TEXT_RULE_TURKISH,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:BLACK,starting_board:[[null,null,null,null,null,null,null,null],[BP,BP,BP,BP,BP,BP,BP,BP],[BP,BP,BP,BP,BP,BP,BP,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,WP,WP,WP,WP,WP,WP,WP],[WP,WP,WP,WP,WP,WP,WP,WP],[null,null,null,null,null,null,null,null]],starting_player:WHITE,movement:MOVEMENT_HORIZONTAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!1,king_protected:!1,back:!1},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1},RULE_PRESET[RULE_CANADIAN]={id:RULE_CANADIAN,meta:{denom:TEXT_RULE_CANADIAN,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[3]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null,WP,null,WP,null]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1},RULE_PRESET[RULE_BRAZILIAN]={id:RULE_BRAZILIAN,meta:{denom:TEXT_RULE_BRAZILIAN,notes:"",suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!1},RULE_PRESET[RULE_RUSSIAN]={id:RULE_RUSSIAN,meta:{denom:TEXT_RULE_RUSSIAN,notes:TEXT_RULE_NOTE_RUSSIAN,suggested_quickmatch_time:MATCH_MINUTES_TYPE[MATCH_MINUTES_DEFAULT_INDEX]},origin_cell_color:WHITE,starting_board:[[null,BP,null,BP,null,BP,null,BP],[BP,null,BP,null,BP,null,BP,null],[null,BP,null,BP,null,BP,null,BP],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[WP,null,WP,null,WP,null,WP,null],[null,WP,null,WP,null,WP,null,WP],[WP,null,WP,null,WP,null,WP,null]],starting_player:WHITE,movement:MOVEMENT_DIAGONAL,capture_rule:{mandatory:!0,maximize:!0,king_first:!0,king_protected:!1,back:!0},king_movement:KING_MOVEMENT_FLY,pawn_can_continue_as_king:!0};var LATIN_ALPHABET="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),BOARD_PRESET=[{white_tile:"#f4be55",black_tile:"#552916",frame:"#f4be55",white_pawn:"#dbbb60",black_pawn:"#424242",letters_color:"#482c13",coords:LATIN_ALPHABET,path_colors:"rgb(75, 192, 192);rgb(54, 162, 235);rgb(153, 102, 255);rgb(201, 203, 207);rgb(255, 99, 132);rgb(255, 159, 64);rgb(255, 205, 86)".split(";")}];function CPreloader(){var e,t,n,i,o,r,s,a,l;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png"),s_oSpriteLibrary.loadSprites(),l=new createjs.Container,s_oStage.addChild(l)},this.unload=function(){l.removeAllChildren()},this._onImagesLoaded=function(){},this._onAllImagesLoaded=function(){this.attachSprites(),s_oMain.preloaderReady()},this.attachSprites=function(){var u=new createjs.Shape;u.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),l.addChild(u),(s=createBitmap(u)).regX=.5*u.width,s.regY=.5*u.height,s.x=CANVAS_WIDTH_HALF,s.y=CANVAS_HEIGHT_HALF-180,l.addChild(s),(a=new createjs.Shape).graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(s.x-100,s.y-100,200,200,10),l.addChild(a),s.mask=a,(i=createBitmap(u=s_oSpriteLibrary.getSprite("progress_bar"))).x=CANVAS_WIDTH_HALF-u.width/2,i.y=CANVAS_HEIGHT_HALF+50,l.addChild(i),e=u.width,t=u.height,(o=new createjs.Shape).graphics.beginFill("rgba(0,0,0,0.01)").drawRect(i.x,i.y,1,t),l.addChild(o),i.mask=o,(n=new createjs.Text("","30px "+PRIMARY_FONT,"#fff")).x=CANVAS_WIDTH_HALF,n.y=CANVAS_HEIGHT_HALF+100,n.textBaseline="alphabetic",n.textAlign="center",l.addChild(n),(r=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),l.addChild(r),createjs.Tween.get(r).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(r),l.removeChild(r)})},this.refreshLoader=function(r){n.text=r+"%",100===r&&(n.visible=!1,i.visible=!1,s_oMain._onRemovePreloader()),o.graphics.clear(),r=Math.floor(r*e/100),o.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(i.x,i.y,r,t)},this._init()}var s_bMobile,s_oStage,s_oMain,s_oSpriteLibrary,s_oCanvas,s_iGameType,s_oGame,s_bFullscreen=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_bWeightSquares=!1,s_bEdgeSensitive=!1,s_iCurRuleFlag=DEFAULT_RULE_FLAG,s_oMenu=null,s_bFirstTimeAccess=!0,s_oModeMenu=null;function CInfoTurn(e,t,n,i){this._init=function(e,t,n,i){},this.setTimeVisible=function(e){},this.refreshTime=function(e){},this.refreshScore=function(e){},this.setEndMode=function(){},this.active=function(e){},this.unload=function(){},this.getSide=function(){},this.setPosition=function(e,t){},this.setBgVisible=function(e){},this.setPanelVisible=function(e){},this.setName=function(e){},this.setPawn=function(e){},this.getType=function(){},this.refreshNotifyPos=function(){},this.setNotify=function(e){},this.disableNotify=function(){},this.setCapturedList=function(e){},this.setPercent=function(e){}}function CThinking(){var e,t,n;this._init=function(){e=new createjs.Container;var i=(new createjs.Graphics).beginFill("rgba(0,0,0,0.3)").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);n=(t=new createjs.Shape(i)).on("click",function(){}),e.addChild(t),s_oStage.addChild(e)},this.show=function(){s_oInterface&&s_oInterface.setPlayersInfo("Human","Thinking...."),e.visible=!0},this.hide=function(){s_oInterface&&s_oInterface.setPlayersInfo("Human","AI"),e.visible=!1},this.isVisible=function(){return e.visible},this.unload=function(){t.off("click",n),s_oStage.removeChild(e)},this._init()}function CEndPanel(e){var t,n,i,o,r,s,a,l,u,c,h,f,d;return this._init=function(e){s_oGame.pauseGame(!0),(i=new createjs.Container).alpha=0,i.visible=!1,s_oStage.addChild(i),(u=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),u.alpha=.7,i.addChild(u),(n=createBitmap(e)).regX=e.width/2,n.regY=e.height/2,n.x=CANVAS_WIDTH/2,n.y=CANVAS_HEIGHT/2,i.addChild(n);var c=e.width-120,h=100,f=CANVAS_WIDTH/2,d=CANVAS_HEIGHT/2-300;s=new CTLText(i,f-c/2,d-h/2,c,h,90,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,"",!0,!0,!1,!1),c=e.width-150,h=50,f=CANVAS_WIDTH/2,d=CANVAS_HEIGHT/2-230,a=new CTLText(i,f-c/2,d-h/2,c,h,40,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,"",!0,!0,!1,!1),(o=new CInfoTurn(CANVAS_WIDTH/2,950,BLACK,i)).setEndMode(),(r=new CInfoTurn(CANVAS_WIDTH/2,850,WHITE,i)).setEndMode(),t=CANVAS_HEIGHT/2+200,c=e.width-150,h=50,f=CANVAS_WIDTH/2,d=t+130,l=new CTLText(i,f-c/2,d-h/2,c,h,40,"center",FONT_COLOR,PRIMARY_FONT,1,2,2," ",!0,!0,!1,!1),this._initListener()},this.unload=function(){s_oStage.removeChild(i),i.off("mousedown",d),f.unload(),c.unload(),h.unload(),o.unload(),r.unload(),document.dispatchEvent(new CustomEvent("end_session")),document.dispatchEvent(new CustomEvent("show_interlevel_ad"))},this._initListener=function(){d=i.on("mousedown",function(){})},this.setRestartBut=function(e,n){var o=s_oSpriteLibrary.getSprite("but_restart");(f=new CGfxButton(CANVAS_WIDTH/2-180,t,o,i)).addEventListener(ON_MOUSE_UP,e,n)},this.setHomeBut=function(e,n){var o=s_oSpriteLibrary.getSprite("but_home");(c=new CGfxButton(CANVAS_WIDTH/2,t,o,i)).addEventListener(ON_MOUSE_UP,e,n)},this.setCheckBut=function(e,n){var o=s_oSpriteLibrary.getSprite("but_show");(h=new CGfxButton(CANVAS_WIDTH/2+180,t,o,i)).addEventListener(ON_MOUSE_UP,e,n)},this.setMsgFooter=function(e){l.refreshText(e)},this.notifyRestart=function(){f.trembleAnimation()},this.show=function(e,t,n,l,u,c){switch(768<=getSize("Width")&&(document.querySelector("#div_display_id").style.display="block"),o.refreshTime(formatTime(t)),r.refreshTime(formatTime(n)),e){case WHITE:playSound("win",1,!1),s.refreshText(sprintf(TEXT_WINS,TEXT_WHITE));break;case BLACK:s_iGameType===MODE_HUMAN?playSound("win",1,!1):playSound("game_over",1,!1),s.refreshText(sprintf(TEXT_WINS,TEXT_BLACK));break;case WIN_WHITE_BLACK_NOMOVES:playSound("win",1,!1),s.refreshText(TEXT_MOVES_AVAIL),a.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_WHITE)));break;case WIN_BLACK_WHITE_NOMOVES:s_iGameType===MODE_HUMAN?playSound("win",1,!1):playSound("game_over",1,!1),s.refreshText(TEXT_MOVES_AVAIL),a.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_BLACK)));break;case DRAW:playSound("game_over",1,!1),s.refreshText(TEXT_DRAW);break;case DRAW_AGREED:playSound("game_over",1,!1),s.refreshText(TEXT_DRAW),a.refreshText(TEXT_PLAYER_AGREED_TO_DRAW);break;case TIME_OVER:s.refreshText(TEXT_TIME_OVER),t<n?a.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_WHITE))):a.refreshText(insertInRoundBracket(sprintf(TEXT_WINS,TEXT_BLACK)))}i.visible=!0,createjs.Tween.get(i).to({alpha:1},500),document.dispatchEvent(new CustomEvent("save_score",{detail:{winner:e,black_time:t,white_time:n,type:s_iGameType,white_score:u,black_score:l,time_index:c}})),document.dispatchEvent(new CustomEvent("share_event",{detail:{type:s_iGameType,white_score:u,winner:e}}))},this.hide=function(){document.querySelector("#div_display_id").style.display="none",i.visible=!1,document.dispatchEvent(new CustomEvent("end_session"))},this.reShow=function(){i.visible=!0},this.setMsgText=function(e){s.refreshText(e)},this.setExpText=function(e){a.refreshText(e)},this._init(e),this}function CCell(e,t,n,i,o){var r,s,a,l,u,c,h,f,d,p,g,m,T,E,b;this._init=function(e,t,n,i){r=n.row,s=n.col,a=0,l=[],u=[],(c=new createjs.Container).x=e,c.y=t,i.addChild(c),(f=createBitmap(e=s_oSpriteLibrary.getSprite("highlight_last_move"))).regX=e.width/2,f.regY=e.height/2,f.alpha=1,f.visible=!1,c.addChild(f),(d=createBitmap(e=s_oSpriteLibrary.getSprite("highlight_capture"))).regX=e.width/2,d.regY=e.height/2,d.alpha=1,d.visible=!1,c.addChild(d),(p=createBitmap(e=s_oSpriteLibrary.getSprite("highlight_landing"))).regX=e.width/2,p.regY=e.height/2,p.alpha=1,p.visible=!1,c.addChild(p),(g=new createjs.Shape).graphics.beginFill("rgba(158,0,0,0.01)").drawRect(-o/2,-o/2,o,o),m=g.on("mousedown",this._onCellDown,this),T=g.on("pressup",this._onCellUp,this),c.addChild(g),h=null},this.unload=function(){i.removeChild(c),g.off("mousedown",m),g.off("pressup",T)},this.addEventListener=function(e,t,n){l[e]=t,u[e]=n},this.addOverListeners=function(){E=g.on("mouseout",this._onCellOut,this,!0),b=g.on("mouseover",this._onCellOver,this,!0)},this.removeOverListeners=function(){g.off("mouseout",E),g.off("mouseover",b)},this.setClickableArea=function(e){g.visible=e},this.createPiece=function(n,o){return h=new CPiece(e,t,n,o,i),this.rotatePiece(a),h},this.rotatePiece=function(e){a=e,h&&h.rotate(e)},this.captureHighlight=function(e){d.visible=e},this.setLastMove=function(e){f.visible=e},this.setLanding=function(e){p.visible=e},this.isLanding=function(){return p.visible},this.setActive=function(e){null!==h&&h.setActive(e)},this._onCellDown=function(){l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(u[ON_MOUSE_DOWN],r,s),E=g.on("mouseout",this._onCellOut,this,!0)},this._onCellUp=function(){l[ON_MOUSE_UP]&&l[ON_MOUSE_UP].call(u[ON_MOUSE_UP],r,s)},this._onCellOver=function(){l[ON_MOUSE_OVER]&&l[ON_MOUSE_OVER].call(u[ON_MOUSE_OVER],r,s),E=g.on("mouseout",this._onCellOut,this,!0)},this._onCellOut=function(){l[ON_MOUSE_OUT]&&l[ON_MOUSE_OUT].call(u[ON_MOUSE_OUT],r,s),b=g.on("mouseover",this._onCellOver,this,!0)},this.getType=function(){return null!==h?h.getType():null},this.getColor=function(){return null!==h?h.getColor():null},this.setVisible=function(e){c.visible=e},this.setPiece=function(e){h=e},this.getX=function(){return e},this.getY=function(){return t},this.getGlobalX=function(){return c.localToGlobal(0,0).x},this.getGlobalY=function(){return c.localToGlobal(0,0).y},this.getPos=function(){return{x:e,y:t}},this.getLogicPos=function(){return{row:r,col:s}},this.remove=function(){h&&(h.unload(),h=null)},this.move=function(e,t){h&&(h.move(e,t,this),h=null)},this.setCaptured=function(){h&&(h.disappear(),h=null)},this.unlitAll=function(e,t){var n={value:1},i=createjs.Tween.get(n,{});i.wait(t).to({value:0},e),i.on("change",function(){d.alpha=n.value,p.alpha=n.value,0===n.value&&(d.alpha=1,p.alpha=1,d.visible=!1,p.visible=!1)},this)},this.getPiece=function(){return h},this.getPieceInfo=function(){var e=this.getLogicPos(),t=null,n=null;return h&&(t=h.getType(),n=h.getColor()),{type:t,color:n,logic_pos:e}},this._init(e,t,n,i)}function CAreYouSurePanel(e){this._init=function(e){(r=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),r.alpha=0,a=r.on("mousedown",function(){}),s_oStage.addChild(r),new createjs.Tween.get(r).to({alpha:.7},500),s=new createjs.Container,s_oStage.addChild(s);var l=createBitmap(e=s_oSpriteLibrary.getSprite("msg_box"));l.regX=e.width/2,l.regY=e.height/2,s.addChild(l),s.x=CANVAS_WIDTH/2,s.y=CANVAS_HEIGHT+e.height/2,t=s.y,new createjs.Tween.get(s).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.cubicOut),l=e.width-100,n=new CTLText(s,-(l/2),-e.height/2+200-125,l,250,100,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_ARE_SURE,!0,!0,!0,!1),(i=new CGfxButton(170,80,s_oSpriteLibrary.getSprite("but_yes"),s)).addEventListener(ON_MOUSE_UP,this._onButYes,this),(o=new CGfxButton(-170,80,s_oSpriteLibrary.getSprite("but_no"),s)).addEventListener(ON_MOUSE_UP,this._onButNo,this),o.pulseAnimation()},this._onButYes=function(){o.setClickable(!1),i.setClickable(!1),new createjs.Tween.get(r).to({alpha:0},500),new createjs.Tween.get(s).to({y:t},400,createjs.Ease.backIn).call(function(){l.unload(),e()})},this._onButNo=function(){o.setClickable(!1),i.setClickable(!1),new createjs.Tween.get(r).to({alpha:0},500),new createjs.Tween.get(s).to({y:t},400,createjs.Ease.backIn).call(function(){l.unload()})},this.changeMessage=function(e){n.refreshText(e)},this.unload=function(){o.unload(),i.unload(),s_oStage.removeChild(r),s_oStage.removeChild(s),r.off("mousedown",a)};var t,n,i,o,r,s,a,l=this;this._init(e)}function CMsgBox(e){var t,n,i,o,r,s,a,l;this._init=function(e){(o=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),o.alpha=0,o.on("mousedown",function(){}),s_oStage.addChild(o),createjs.Tween.get(o).to({alpha:.7},500),r=new createjs.Container,s_oStage.addChild(r);var u=s_oSpriteLibrary.getSprite("msg_box"),c=createBitmap(u);c.regX=u.width/2,c.regY=u.height/2,r.addChild(c),r.x=CANVAS_WIDTH/2,r.y=CANVAS_HEIGHT/2,i=e,u=u.width-120,s=new CTLText(r,-(u/2),-290,u,180,80,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,e,!0,!0,!0,!1),u=s_oSpriteLibrary.getSprite("but_exit"),(a=new CGfxButton(1310-CANVAS_WIDTH/2,610-CANVAS_HEIGHT/2,u,r)).addEventListener(ON_MOUSE_UP,this.hide,this),a.setVisible(!1),(l=new createjs.Container).y=180,r.addChild(l),t=[],n=[]},this.unload=function(){s_oStage.removeChild(o),s_oStage.removeChild(r),o.off("mousedown",function(){});for(var e=0;e<t.length;e++)t[e].unload();a.unload()},this.setMessage=function(e){i=e,s.refreshText(e)},this.setExplMsg=function(e){var t=r.getBounds().width-120;new CTLText(r,-(t/2),-105,t,50,50,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,e,!0,!0,!1,!1)},this.setMsgColor=function(e){s.setColor(e)},this.addButton=function(e,i,o,r,s){var a=new CGfxButton(t.length*(e.width+150),0,e,l);a.addEventListener(i,o,r),l.regX=l.getBounds().width/2-e.width/2,s&&(i=e.width-20,e=new CTLText(l,t.length*(e.width+150)-i/2,-250,i,100,50,"center","#2e1905",PRIMARY_FONT,1,2,2,s,!0,!0,!0,!1),n.push(e)),t.push(a)},this.centerMessage=function(){s.setY(-100)},this.show=function(){o.visible=!0,r.visible=!0},this.reShow=function(){o.visible=!0,r.visible=!0},this.hide=function(){o.visible=!1,r.visible=!1},this.showExitBut=function(){a.setVisible(!0)},this.setButtonContainerY=function(e){l.y=e},this.refreshLang=function(e){s.refreshText(i);for(var t=0;t<n.length;t++)n[t].refreshText(e[t])},this._init(e)}var NUM_ITEMS_PER_COLS=4;function CLangPanel(e){var t,n,i,o,r,s,a,l,u,c,h,f,d=this;this._init=function(){a=!1,t=[],n=[],(f=new createjs.Container).visible=!1,e.addChild(f),(u=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),r=u.on("click",function(){}),f.addChild(u),(c=new createjs.Container).x=CANVAS_WIDTH/2,c.y=CANVAS_HEIGHT/2,f.addChild(c);var i=createBitmap(s=s_oSpriteLibrary.getSprite("msg_box_small"));c.addChild(i),this._placeLanguages(),(l=new CGfxButton(s.width,0,s_oSpriteLibrary.getSprite("but_exit"),c)).addEventListener(ON_MOUSE_UP,this.hide,this),c.regX=s.width/2,c.regY=s.height/2},this.unload=function(){l.unload(),u.off("click",r);for(var e=0;e<i.length;e++)i[e].off("pressup",o[e])},this.addEventListener=function(e,i,o){t[e]=i,n[e]=o},this.show=function(){l.setClickable(!0),a=!1,f.visible=!0,u.alpha=0,createjs.Tween.get(u).to({alpha:.7},400,createjs.Ease.cubicOut),c.scaleX=c.scaleY=.01,c.alpha=0,createjs.Tween.get(c).wait(400).to({scale:1,alpha:1},1e3,createjs.Ease.elasticOut).call(function(){})},this.hide=function(){l.setClickable(!1),a=!0,createjs.Tween.get(u).to({alpha:0},400,createjs.Ease.cubicOut),createjs.Tween.get(c).to({scaleX:.1,scaleY:.1,alpha:.5},400,createjs.Ease.backIn).call(function(){f.visible=!1})},this._placeLanguages=function(){(h=new createjs.Container).x=s.width/2,h.y=s.height/2,c.addChild(h);for(var e=s_oSpriteLibrary.getSprite("but_lang"),t={},n=0;n<NUM_LANGUAGES;n++)t["lang_"+n]=n;e=new createjs.SpriteSheet({images:[e],frames:{width:LANG_WIDTH,height:LANG_HEIGHT,regX:LANG_WIDTH/2,regY:LANG_HEIGHT/2},animations:t}),n=t=0,i=[],o=[];for(var r=0,a=0;a<NUM_LANGUAGES;a++){var l=createSprite(e,"lang_"+a,LANG_WIDTH/2,LANG_HEIGHT/2,LANG_WIDTH,LANG_HEIGHT);l.x=t,l.y=n,l.on("mousedown",this._onPressLang,this,!1,a),o[a]=l.on("pressup",this._onSelectLang,this,!1,a),h.addChild(l),i.push(l),r++,0<a&&0==r%NUM_ITEMS_PER_COLS?(t=0,n+=LANG_HEIGHT+10):t+=LANG_WIDTH+10}h.regX=LANG_WIDTH*NUM_ITEMS_PER_COLS/2-40,h.regY=n/2},this._onPressLang=function(e,t){a||(i[t].scale=.9)},this._onSelectLang=function(e,o){a||(i[o].scale=1,console.log("iIndex "+o),t[ON_SELECT_LANG]&&t[ON_SELECT_LANG].call(n[ON_SELECT_LANG],o),d.hide())},this._init()}function CButMenu(e,t,n,i,o,r,s,a){var l,u,c,h,f,d,p,g=null;return this._init=function(e,t,n,i,o,r,s,a){l=1,u=[],c=[],(h=new createjs.Container).x=e,h.y=t,h.regX=n.width/2,h.regY=n.height/2,a.addChild(h),h.cursor="pointer",e=createBitmap(n),h.addChild(e),f=new CTLText(h,180,20,n.width-220,n.height-52,s,"center",r,o,1,0,0,i.toUpperCase(),!0,!0,!0,!1),this._initListener()},this.unload=function(){h.off("mousedown",d),h.off("pressup",p),a.removeChild(h)},this.setVisible=function(e){h.visible=e},this._initListener=function(){oParent=this,d=h.on("mousedown",this.buttonDown),p=h.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,n){u[e]=t,c[e]=n},this.buttonRelease=function(){h.scaleX=l,h.scaleY=l,u[ON_MOUSE_UP]&&u[ON_MOUSE_UP].call(c[ON_MOUSE_UP])},this.buttonDown=function(){h.scaleX=.9*l,h.scaleY=.9*l,playSound("click",1,!1),u[ON_MOUSE_DOWN]&&u[ON_MOUSE_DOWN].call(c[ON_MOUSE_DOWN])},this.changeText=function(e){f.refreshText(e)},this.setPosition=function(e,t){h.x=e,h.y=t},this.setX=function(e){h.x=e},this.setY=function(e){h.y=e},this.setScale=function(e){l=e,h.scale=e},this.addAlert=function(){(g=new CAlertIcon(n.width-10,10,"1",h)).pulseAnimation()},this.removeAlert=function(){null!==g&&h.removeChild(g)},this.getButtonImage=function(){return h},this.getX=function(){return h.x},this.getY=function(){return h.y},this._init(e,t,n,i,o,r,s,a),this}var LOCALSTORAGE_TIMEMODE="pref_time_mode",LOCALSTORAGE_RULE_INDEX="pref_rule_index",LOCALSTORAGE_RULE_PRESET="pref_rule_preset",LOCALSTORAGE_ALERT_ACTIVE="alert_active_iter_0",s_iPrefTimeMode=0,s_szCurRule=RULE_ITALIAN,s_oRules=RULE_PRESET[s_szCurRule],s_bAlertActive=!0;function CLocalStorage(e){var t=!0;this._init=function(e){try{var t=window.localStorage.getItem(e);this.resetData(),null!=t&&this.loadData()}catch(n){this.resetData()}},this.isDirty=function(){return!1},this.isUsed=function(){try{window.localStorage.setItem("ls_available","ok")}catch(e){t=!1}return t},this.resetData=function(){s_iPrefTimeMode=0,s_oRules=RULE_PRESET[s_szCurRule=RULE_ITALIAN],s_bAlertActive=!0},this.deleteData=function(){window.localStorage.removeItem(e)},this.saveData=function(){var t={};t[LOCALSTORAGE_TIMEMODE]=s_iPrefTimeMode,t[LOCALSTORAGE_RULE_INDEX]=s_szCurRule,t[LOCALSTORAGE_RULE_PRESET]=s_oRules,t[LOCALSTORAGE_ALERT_ACTIVE]=s_bAlertActive,window.localStorage.setItem(e,JSON.stringify(t))},this.loadData=function(){var t=JSON.parse(window.localStorage.getItem(e));for(var n in s_iPrefTimeMode=parseInt(t[LOCALSTORAGE_TIMEMODE]),s_szCurRule=t[LOCALSTORAGE_RULE_INDEX],s_oRules=copyObjectByValue(t[LOCALSTORAGE_RULE_PRESET]),s_bAlertActive=t[LOCALSTORAGE_ALERT_ACTIVE],t=0,RULE_PRESET)RULE_PRESET[n].id===s_oRules.id&&(t=RULES_ORDER.indexOf(n));s_iCurRuleFlag=t},this._init(e)}function CGUIExpandible(e,t,n,i){this._init=function(e,t,n,i){a=[],l=[],(c=new createjs.Container).x=e,c.y=t,i.addChild(c),h=new createjs.Container,c.addChild(h),f=new createjs.Container,c.addChild(f),s=!1,(u=new CGfxButton(0,0,n,f)).addEventListener(ON_MOUSE_UP,this._onMenu,this),r=o=120},this.unload=function(){u.unload(),i.removeChild(c)},this.refreshPos=function(){c.x=e-s_iOffsetX,c.y=t+s_iOffsetY},this.setPosition=function(e,t){c.x=e,c.y=t},this.addButton=function(e){var t=e.getButtonImage();t.x=0,t.y=0,t.visible=0,h.addChildAt(t,0),a.push(t),l.push(e)},this._onMenu=function(){d.stopTrembleAnimation(),(s=!s)?d._expand():d._collapse()},this._expand=function(){for(var e=0;e<a.length;e++)a[e].visible=!0,createjs.Tween.get(a[e],{override:!0}).wait(300*e/2).to({y:o+e*r},300,createjs.Ease.cubicOut)},this._collapse=function(){for(var e=0;e<a.length;e++){var t=a[a.length-1-e];createjs.Tween.get(t,{override:!0}).wait(300*e/2).to({y:0},300,createjs.Ease.cubicOut).call(function(e){e.visible=!1},[t])}},this.trembleAnimation=function(){s?l[l.length-1].trembleAnimation():u.trembleAnimation()},this.stopTrembleAnimation=function(){s?l[l.length-1].stopAnimation():u.stopAnimation()};var o,r,s,a,l,u,c,h,f,d=this;this._init(e,t,n,i)}var CCTLMultiplayerGui=function(){};function htmlMarkupToNode(e){var t=document.createElement("template");return t.innerHTML=e,t.content.cloneNode(!0)}function CMoveTimeController(e,t,n,i){this._init=function(){o=[],r=[],a=i,s=null,c=0,(h=new createjs.Container).x=e,h.y=t,n.addChild(h),d=new CTLText(h,-50,-50,300,100,30,"center","#fff",PRIMARY_FONT,1,2,2," ",!0,!0,!1,!1),f=new CRadialWipeWidget(0,0,h)},this.unload=function(){n.removeChild(h),this.stopTimer()},this.setPos=function(e,t){h.x=e,h.y=t},this.setScale=function(e){f.setScale(e)},this.setSpectatorMode=function(){f.removeHurryUpMode()},this.setAlwaysShown=function(){f.alwaysShown()},this.showAttempt=function(e){d.setVisible(e)},this.addEventListener=function(e,t,n){o[e]=t,r[e]=n},this.restartEndGameCounter=function(){c=0,a=i},this.setTime=function(e){a=e},this.setHurryUpMode=function(e){f.setHurryUpMode(e)},this.startTimer=function(){0!==a&&(u=l=a,d.refreshText(c+1+"/"+NUM_ATTEMPT),null===s&&(s=setInterval(function(){p.update(),h.visible=!0},FPS_TIME)))},this.stopTimer=function(){h.visible=!1,d.refreshText(""),f.reset(),clearInterval(s),s=null},this._onTimerEnd=function(){console.log("callback");var e=ON_TIMER_END;o[e]&&o[e].call(r[e])},this.update=function(){0>(u-=s_iTimeElaps)&&(this.stopTimer(),this._onTimerEnd(),u=0,clearInterval(s)),f.update(u,l)},this._init();var o,r,s,a,l,u,c,h,f,d,p=this}function CBoardStateController(){this._init=function(){},this.getOtherOpponent=function(e){return e===WHITE?BLACK:WHITE},this.copyBoard=function(e){for(var t=[],n=0;n<e.length;n++){t[n]=[];for(var i=0;i<e[n].length;i++)t[n][i]=e[n][i].getPieceInfo()}return t},this.getListPiece=function(e,t){for(var n=[],i=0;i<e.length;i++)for(var o=0;o<e[i].length;o++){var r=e[i][o];r.color===t&&n.push(r)}return n},this._init(),s_oBoardStateController=this}var s_oBoardStateController,DIR_TOPRIGHT="DIR_TOPRIGHT",DIR_RIGHT="DIR_RIGHT",DIR_BOTRIGHT="DIR_BOTRIGHT",DIR_TOPLEFT="DIR_TOPLEFT",DIR_LEFT="DIR_LEFT",DIR_BOTLEFT="DIR_BOTLEFT",DIR_TOP="DIR_TOP",DIR_BOT="DIR_BOT";function CMovesController(e,t){var n,i,o;this._init=function(e){for(n=e.length,i=e[0].length,o=[],e=0;e<n;e++){o[e]=[];for(var t=0;t<i;t++)o[e][t]=[]}this._buildMap()},this._buildMap=function(){for(var e=0;e<n;e++)for(var t=0;t<i;t++)o[e][t][DIR_TOPRIGHT]=this._setNeighbor(e,t,DIR_TOPRIGHT),o[e][t][DIR_RIGHT]=this._setNeighbor(e,t,DIR_RIGHT),o[e][t][DIR_BOTRIGHT]=this._setNeighbor(e,t,DIR_BOTRIGHT),o[e][t][DIR_TOPLEFT]=this._setNeighbor(e,t,DIR_TOPLEFT),o[e][t][DIR_LEFT]=this._setNeighbor(e,t,DIR_LEFT),o[e][t][DIR_BOTLEFT]=this._setNeighbor(e,t,DIR_BOTLEFT),o[e][t][DIR_TOP]=this._setNeighbor(e,t,DIR_TOP),o[e][t][DIR_BOT]=this._setNeighbor(e,t,DIR_BOT)},this._setNeighbor=function(e,t,o){var r=null;switch(o){case DIR_TOPRIGHT:0<e&&t<i-1&&(r={row:e-1,col:t+1});break;case DIR_RIGHT:t<i-1&&(r={row:e,col:t+1});break;case DIR_BOTRIGHT:e<n-1&&t<i-1&&(r={row:e+1,col:t+1});break;case DIR_TOPLEFT:0<e&&0<t&&(r={row:e-1,col:t-1});break;case DIR_LEFT:0<t&&(r={row:e,col:t-1});break;case DIR_BOTLEFT:e<n-1&&0<t&&(r={row:e+1,col:t-1});break;case DIR_TOP:0<e&&(r={row:e-1,col:t});break;case DIR_BOT:e<n-1&&(r={row:e+1,col:t})}return r},this._getNeighborByDir=function(e,t,n){return o[e][t][n]},this._getAllNeighbor=function(e,t){var n,i=[];for(n in o[e][t])null!==o[e][t][n]&&i.push(o[e][t][n]);return i},this._getMainDiagonal=function(e,t,n){var i=[],o=n[e][t].color;return this._findInDirection(e,t,DIR_BOTRIGHT,i,99,o,n),this._findInDirection(e,t,DIR_TOPLEFT,i,99,o,n),i},this._getSecondDiagonal=function(e,t,n){var i=[],o=n[e][t].color;return this._findInDirection(e,t,DIR_BOTLEFT,i,99,o,n),this._findInDirection(e,t,DIR_TOPRIGHT,i,99,o,n),i},this._getRow=function(e,t,n){var i=[],o=n[e][t].color;return this._findInDirection(e,t,DIR_LEFT,i,99,o,n),this._findInDirection(e,t,DIR_RIGHT,i,99,o,n),i},this._getCol=function(e,t,n){var i=[],o=n[e][t].color;return this._findInDirection(e,t,DIR_TOP,i,99,o,n),this._findInDirection(e,t,DIR_BOT,i,99,o,n),i},this._getStraightByDirAndRadius=function(e,t,n,i,o){var r=[];return this._findInDirection(e,t,n,r,i,o[e][t].color,o),r},this._getStraightRowByRadius=function(e,t,n){var i=[];return this._findInDirection(e,t,DIR_LEFT,i,n),this._findInDirection(e,t,DIR_RIGHT,i,n),i},this._getStraightColByRadius=function(e,t,n){var i=[];return this._findInDirection(e,t,DIR_TOP,i,n),this._findInDirection(e,t,DIR_BOT,i,n),i},this._getStraightLine=function(e,t,n,i){return null!==(e=o[e.row][e.col][n])&&(i.push(e),e.row===t.row&&e.col===t.col||this._getStraightLine(e,t,n,i)),i},this._findInDirection=function(e,n,i,r,s,a,l,u){u=void 0===u?null:u,--s;var c=o[e][n][i];if(null!==c&&0<=s){var h=c.row,f=c.col;if(a){var d=l[h][f].color;d!==a&&(null===d?(r.push({dest:c,capture:u,dir:i}),this._findInDirection(h,f,i,r,s,a,l,u)):null===u&&null!==(e=this._checkValidJump(h,f,i,r,l,l[e][n].type))&&(n=copyObjectByValue(l[h][f]),r.push({dest:e,capture:n,dir:i}),t.king_movement===KING_MOVEMENT_FLY&&this._findInDirection(e.row,e.col,i,r,s,a,l,n)))}else r.push({dest:c,capture:u,dir:i}),this._findInDirection(h,f,i,r,s,a,l,u)}},this._checkValidJump=function(e,n,i,r,s,a){if(r=null,null!==(i=o[e][n][i])){if(e=s[e][n].type,!0===t.capture_rule.king_protected&&e===KING&&a===PAWN)return r;null===s[i.row][i.col].color&&(r=i)}return r},this.getAllPiecePos=function(e,t){for(var n=[],i=0;i<e.length;i++)for(var o=0;o<e[i].length;o++)e[i][o].color===t&&n.push({row:i,col:o});return n},this.getMovesList=function(e,t,n){var i=[];switch(n[e][t].type){case PAWN:e=this.getPawnMove(e,t,n);break;case KING:e=this.getKingMove(e,t,n);break;default:return i}return s_oMovesController.getAllPathFromTree(e,i,[],e.src),this._filterBestPaths(i)},this._buildMoveTree=function(e,n,i,o){var r=o.dest.row,s=o.dest.col,a=[],l=1,u=e.type,c=e.color;switch(u){case PAWN:a=this.getForwardDirections(c),t.capture_rule.back&&(a=this.getAllDirections());break;case KING:a=this.getAllDirections(),(t.king_movement===KING_MOVEMENT_FLY||t.king_movement===KING_MOVEMENT_FLY_BLOCK)&&(l=99)}e=[];for(var h=0;h<a.length;h++){var f=a[h];f!==this.getOppositeDirection(o.dir)&&(e[f]=[],this._findInDirection(r,s,f,e[f],l,c,n,null),t.capture_rule.back&&u===PAWN&&-1!==this.getBackwardDirections(c).indexOf(f)&&this._filterCaptureList(e[f])),f===o.dir&&t.king_movement===KING_MOVEMENT_FLY_BLOCK&&null!==o.capture&&(e[f]=[],this._findInDirection(r,s,f,e[f],1,c,n,null))}for(o=[],e=(h=$jscomp.makeIterator(Object.entries(e))).next();!e.done;e=h.next())(e=$jscomp.makeIterator(e.value)).next(),e=e.next().value,o=o.concat(e);for(h=0,i.move_list=o;h<o.length;h++)null!==(i=o[h]).capture&&(a=this.getMoveInfo({row:r,col:s},i,n),this.makeMove(a,n),l=i.dest,e=n[i.dest.row][i.dest.col],l={src:l,move_list:[]},e=this._buildMoveTree(e,n,l,i),this._filterCaptureList(e),0<e.length&&(i.node=l),this.unmakeMove(a,n));return o},this.getMoveTree=function(e,n,i,o){if(n={src:i={row:n,col:i},move_list:[]},this._buildMoveTree(e,o,n,{dest:i,capture:null,dir:null}),this._setWeight(n),t.capture_rule.mandatory){for(t.capture_rule.maximize&&this._maximizeWeight(n),e=n.move_list,o=!1,i=0;i<e.length;i++)if(null!==e[i].capture){o=!0;break}o&&this._filterCaptureList(n.move_list)}return n},this.getPawnMove=function(e,t,n){return this.getMoveTree(n[e][t],e,t,n)},this.getKingMove=function(e,t,n){return this.getMoveTree(n[e][t],e,t,n)},this._filterCaptureList=function(e){for(var t=0;t<e.length;t++)null===e[t].capture&&(e.splice(t,1),t--)},this._setWeight=function(e){e=e.move_list;for(var t=0;t<e.length;t++){var n=e[t];n.weight=n.node?1+this._setWeight(n.node):n.capture?1:0}return this._getMaxWeight(e)},this._getMaxWeight=function(e){for(var t=0,n=0;n<e.length;n++){var i=e[n];t<i.weight&&(t=i.weight)}return t},this._maximizeWeight=function(e){e=e.move_list;for(var t=this._getMaxWeight(e),n=0;n<e.length;n++){var i=e[n];i.weight<t&&(e.splice(n,1),n--)}for(n=0;n<e.length;n++)(i=e[n]).node&&this._maximizeWeight(i.node)},this.getAllMovesInfoInBoard=function(e,t){var n=this._getAllCellMovingInfo(e,t);return this._getListOfSinglePath(n)},this.getMandatoryCells=function(e,n){var i=this._getAllCellMovingInfo(e,n),o=[];if(t.capture_rule.mandatory)for(var r=0;r<i.length;r++){var s=i[r];0<s.max_num_capture&&o.push(s.cell)}return o},this._getAllCellMovingInfo=function(e,n){for(var i=[],o=!1,r=this._getAllBoardMoves(e,n),s=0;s<r.length;s++){var a=r[s];if(0<a.length){var l=a[0];l=copyObjectByValue(n[l.src.row][l.src.col]);var u=this._getMaxNumCaptureInPathList(a);0<u&&(o=!0),i.push({cell:l,max_num_capture:u,all_path:a})}}if(t.capture_rule.mandatory&&o){for(s=0;s<i.length;s++)0===i[s].max_num_capture&&(i.splice(s,1),s--);t.capture_rule.king_first&&0<(o=this._getCellsByType(KING,i)).length&&(i=o),t.capture_rule.maximize&&this._filterCapturingCellsByMax(i)}return i},this._getAllBoardMoves=function(e,t){for(var n=[],i=0;i<t.length;i++)for(var o=0;o<t[i].length;o++)t[i][o].color===e&&n.push(this.getMovesList(i,o,t));return n},this._filterCapturingCellsByMax=function(e){for(var t=0,n=0;n<e.length;n++){var i=e[n].max_num_capture;e[n].max_num_capture>t&&(t=i)}for(n=0;n<e.length;n++)e[n].max_num_capture<t&&(e.splice(n,1),n--)},this._getCellsByType=function(e,t){for(var n=[],i=0;i<t.length;i++)t[i].cell.type===e&&n.push(t[i]);return n},this._getListOfSinglePath=function(e){for(var t=[],n=0;n<e.length;n++)for(var i=e[n].all_path,o=0;o<i.length;o++){var r=i[o],s=this.getNumCaptureInPath(r);t.push({cell:e[n].cell,num_capture:s,path:r})}return t},this._checkCaptureInPathList=function(e){for(var t=0;t<e.length;t++)if(0<this.getNumCaptureInPath(e[t]))return!0;return!1},this.getNumCaptureInPath=function(e){e=e.jump_list;for(var t=0,n=0;n<e.length;n++)null!==e[n].capture&&t++;return t},this._getMaxNumCaptureInPathList=function(e){for(var t=0,n=0;n<e.length;n++){var i=this.getNumCaptureInPath(e[n]);t<i&&(t=i)}return t},this.getAllPathFromTree=function(e,t,n,i){e=e.move_list;for(var o=0;o<e.length;o++){var r=e[o],s=r.dest;n.push({dest:s,capture:r.capture}),r.node?this.getAllPathFromTree(r.node,t,n,i):(r=copyObjectByValue(n),t.push({jump_list:r,terminal:s,src:i}),n.splice(n.length-1,1))}n.splice(n.length-1,1)},this.getAllCellsFromAPath=function(e){var t=[],n=e.jump_list,i=e.src;for(e=0;e<n.length;e++){var o=n[e].dest;i=s_oMovesController.getLine(i,o);for(var r=0;r<i.length;r++)t.push(i[r]);i=o}return t},this._groupPathsByTerminal=function(e){for(var t={},n=0;n<e.length;n++){var i=e[n],o=i.terminal.row+"_"+i.terminal.col;t.hasOwnProperty(o)||(t[o]=[]),t[o].push(i)}return t},this._filterBestPaths=function(e){e=this._groupPathsByTerminal(e);var t,n=[];for(t in e){for(var i=e[t],o=i[0],r=1;r<i.length;r++){var s=i[r];o.jump_list.length<s.jump_list.length&&(o=s)}n.push(o)}return n},this.getLine=function(e,t){var n=[];if(e.row===t.row){var i=t.col-e.col;n=0<i?this._getStraightLine(e,t,DIR_RIGHT,n):this._getStraightLine(e,t,DIR_LEFT,n)}else if(e.col===t.col)n=0<(i=t.row-e.row)?this._getStraightLine(e,t,DIR_BOT,n):this._getStraightLine(e,t,DIR_TOP,n);else{i=0<t.col-e.col?DIR_RIGHT:DIR_LEFT;var o=0<t.row-e.row?DIR_BOT:DIR_TOP;n=this._getStraightLine(e,t,o===DIR_BOT&&i===DIR_RIGHT?DIR_BOTRIGHT:o===DIR_BOT&&i===DIR_LEFT?DIR_BOTLEFT:o===DIR_TOP&&i===DIR_RIGHT?DIR_TOPRIGHT:DIR_TOPLEFT,n)}return n},this.getOppositeDirection=function(e){switch(e){case DIR_TOPRIGHT:e=DIR_BOTLEFT;break;case DIR_RIGHT:e=DIR_LEFT;break;case DIR_BOTRIGHT:e=DIR_TOPLEFT;break;case DIR_TOPLEFT:e=DIR_BOTRIGHT;break;case DIR_LEFT:e=DIR_RIGHT;break;case DIR_BOTLEFT:e=DIR_TOPRIGHT;break;case DIR_TOP:e=DIR_BOT;break;case DIR_BOT:e=DIR_TOP;break;default:e=null}return e},this.getAllDirections=function(){var e=[DIR_TOPRIGHT,DIR_TOPLEFT,DIR_BOTRIGHT,DIR_BOTLEFT];return t.movement===MOVEMENT_HORIZONTAL&&(e=[DIR_LEFT,DIR_TOP,DIR_RIGHT,DIR_BOT]),e},this.getForwardDirections=function(e){return e===WHITE?(e=[DIR_TOPRIGHT,DIR_TOPLEFT],t.movement===MOVEMENT_HORIZONTAL&&(e=[DIR_LEFT,DIR_TOP,DIR_RIGHT])):(e=[DIR_BOTRIGHT,DIR_BOTLEFT],t.movement===MOVEMENT_HORIZONTAL&&(e=[DIR_LEFT,DIR_BOT,DIR_RIGHT])),e},this.getBackwardDirections=function(e){e=this.getForwardDirections(e);for(var n=0;n<e.length;n++)e[n]=this.getOppositeDirection(e[n]);return t.movement===MOVEMENT_HORIZONTAL&&(removeElementByValue(e,DIR_LEFT),removeElementByValue(e,DIR_RIGHT)),e},this.getDistance=function(e,t){var n=new CVector2(e.col,e.row),i=new CVector2(t.col,t.row);return n.subV(i),n.length()},this.getMoveInfo=function(e,t,n){var i=t.dest;return n=n[e.row][e.col],t=t.capture,{sourcerow:e.row,sourcecol:e.col,destrow:i.row,destcol:i.col,sourcetype:n.type,sourcecolor:n.color,capturerow:t.logic_pos.row,capturecol:t.logic_pos.col,capturetype:t.type,capturecolor:t.color}},this.makeMove=function(e,n){if(n[e.sourcerow][e.sourcecol].color=null,n[e.sourcerow][e.sourcecol].type=null,n[e.destrow][e.destcol].color=e.sourcecolor,n[e.destrow][e.destcol].type=e.sourcetype,n[e.capturerow][e.capturecol].color=null,n[e.capturerow][e.capturecol].type=null,t.pawn_can_continue_as_king)switch(e.destrow){case 0:e.sourcecolor===WHITE&&(n[e.destrow][e.destcol].type=KING);break;case n.length-1:e.sourcecolor===BLACK&&(n[e.destrow][e.destcol].type=KING)}},this.unmakeMove=function(e,t){t[e.destrow][e.destcol].color=null,t[e.destrow][e.destcol].type=null,t[e.sourcerow][e.sourcecol].color=e.sourcecolor,t[e.sourcerow][e.sourcecol].type=e.sourcetype,t[e.capturerow][e.capturecol].color=e.capturecolor,t[e.capturerow][e.capturecol].type=e.capturetype},this._init(e),s_oMovesController=this}var s_oMovesController,ON_PIECE_START_MOVE="on_piece_start_move",ON_PIECE_MOVE="on_piece_move",ON_PIECE_MOVED="on_piece_moved",ON_PIECE_COMPLETED_ALL_MOVES="on_piece_completed_all_moves";function CPiece(e,t,n,i,o){this._side=n,this._init=function(e,t,n,i,o){r=n,s=i,a=[],l=[],(c=new createjs.Container).x=e,c.y=t,o.addChild(c),e=n===WHITE?BOARD_PRESET[0].white_pawn:BOARD_PRESET[0].black_pawn,(t=new createjs.Shape).graphics.beginFill(e).drawCircle(0,0,0),c.addChild(t),e="shader_pawn",n===BLACK&&(e="shader_pawn_positive"),imgx=n===WHITE?"shader_king_w":"shader_king_b",i===KING&&(e=imgx),(u=createBitmap(n=s_oSpriteLibrary.getSprite(e))).regX=n.width/2-3,u.regY=n.height/2-3,c.addChild(u),(h=createBitmap(n=s_oSpriteLibrary.getSprite("piece_lit"))).regX=n.width/2,h.regY=n.height/2,h.alpha=.8,h.visible=!1,c.addChild(h)},this.unload=function(){o.removeChild(c)},this.addEventListener=function(e,t,n){a[e]=t,l[e]=n},this.getContainer=function(){return u},this.getType=function(){return s},this.getColor=function(){return r},this.rotate=function(e){u.rotation=e},this.setActive=function(e){h.visible=e},this.promote=function(){if(s===PAWN){s=KING,xxx="white"===this._side?"shader_king_w":"shader_king_b";var e=s_oSpriteLibrary.getSprite(xxx);u.image=e}},this.move=function(e,t,n){o.setChildIndex(c,o.numChildren-1);var i=createjs.Tween.get(c,{}),r=createjs.Tween.get(c,{}),s=t,u=n.getLogicPos();for(a[ON_PIECE_START_MOVE]&&a[ON_PIECE_START_MOVE].call(l[ON_PIECE_START_MOVE],u),n=0;n<e.length;n++){var h=e[n],f=h.pos;3<s_oMovesController.getDistance(u,h.dest)&&(s=1.5*t);var d=createjs.Ease.cubicOut;h.capture?(d=createjs.Ease.quadIn,r.to({scale:1.15},s/2,d).to({scale:1},s/2,createjs.Ease.sineIn).call(function(){playSound("jump",1,!1)})):playSound("pawn_move",1,!1),i.call(function(e,t,n){a[ON_PIECE_MOVE]&&a[ON_PIECE_MOVE].call(l[ON_PIECE_MOVE],e,t,n)},[h,u,n],this),i.to(f,s,d),i.call(function(e){a[ON_PIECE_MOVED]&&a[ON_PIECE_MOVED].call(l[ON_PIECE_MOVED],e,this)},[h,this],this),u=h.dest}i.call(function(){this.setActive(!1),a[ON_PIECE_COMPLETED_ALL_MOVES]&&a[ON_PIECE_COMPLETED_ALL_MOVES].call(l[ON_PIECE_COMPLETED_ALL_MOVES],u,this)},[u,this],this)},this.disappear=function(){f.unload()};var r,s,a,l,u,c,h,f=this;this._init(e,t,n,i,o)}function CTimePanel(e,t,n){var i,o,r,s,a,l;this._init=function(e,t,n){var u=s_oSpriteLibrary.getSprite("time_panel");r=new createjs.Container,i=e,o=t,r.x=i,r.y=o,n.addChild(r),e=u.width-30,n=40,a=new CTLText(r,-4-e/2,-330-n/2,e,n,36,"center","#ffffff",PRIMARY_FONT,1,2,2,TEXT_MINUTES,!0,!0,!1,!1),(l=createBitmap(u)).regX=u.width/2,l.regY=u.height/2,r.addChild(l);var c=["but_time_nomin","but_time_3min","but_time_5min","but_time_10min"];n=440,s=[];for(var h=0;h<c.length;h++)u=s_oSpriteLibrary.getSprite(c[h]),t=-n/2+n/(c.length-1)*h,e=0,s[h]=new CToggle(e,t,u,!0,r),s[h].addEventListenerWithParams(ON_MOUSE_UP,this._onTimeToggle,this,MATCH_MINUTES_TYPE[h]);this._onTimeToggle(MATCH_MINUTES_TYPE[s_iPrefTimeMode])},this.unload=function(){for(var e=0;e<s.length;e++)s[e].unload();n.removeChild(r)},this.refreshPos=function(){s_bLandscape?(r.x=CANVAS_WIDTH-100-s_iOffsetX,r.y=CANVAS_HEIGHT-312-s_iOffsetY,this.setVertical()):(r.x=CANVAS_WIDTH/2,r.y=CANVAS_HEIGHT-520-s_iOffsetY,this.setHorizontal())},this._onTimeToggle=function(e){for(var t=0;t<s.length;t++)s[t].setActive(!1);s_iPrefTimeMode=e=MATCH_MINUTES_TYPE.indexOf(e),s[e].setActive(!0)},this.setVertical=function(){l.rotation=0,l.scaleY=1,a.setY(-346);for(var e=0;e<s.length;e++)s[e].setPosition(0,-200+400/(s.length-1)*e)},this.setHorizontal=function(){l.rotation=90,l.scaleY=-1,a.setY(-130);for(var e=0;e<s.length;e++)s[e].setPosition(-200+400/(s.length-1)*e-2,-2)},this._init(e,t,n)}function CRuleButton(e,t,n){var i,o,r,s,a,l,u,c,h,f,d,p,g,m,T,E,b=null;this._init=function(e,t,n){T=!1,E=1,a=[],l=[];var s=s_oSpriteLibrary.getSprite("time_panel");r=new createjs.Container,i=e,o=t,r.x=i,r.y=o,n.addChild(r),t=350,n=40,u=new CTLText(r,-4-t/2,-110-n/2,t,n,36,"center","#ffffff",PRIMARY_FONT,1,2,2,TEXT_RULE_CHANGE,!0,!0,!1,!1),(c=createBitmap(s)).regX=s.width/2,c.regY=s.height/2,c.rotation=90,c.scaleY=-1,r.addChild(c),e=-86;var p=s_oSpriteLibrary.getSprite("rule_desc_label");(t=new createBitmap(p)).x=e,t.regX=p.width/2,t.regY=p.height/2,r.addChild(t),t=p.width-30,n=80,f=new CTLText(r,e-t/2,-6-n/2,t,n,50,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_RULE_INTERNATIONAL,!0,!0,!0,!1),s=s_oSpriteLibrary.getSprite("flag_desc_label"),(t=new createBitmap(s)).x=e+p.width/2+s.width/2-4,t.regX=s.width/2,t.regY=s.height/2,r.addChild(t),s=s_oSpriteLibrary.getSprite("rule_flag_"+DEFAULT_RULE_FLAG),(h=new createBitmap(s)).x=t.x-2,h.y=-4,h.regX=s.width/2,h.regY=s.height/2,r.addChild(h),t=s.width,n=s.height,(e=new createjs.Shape).graphics.beginFill("#000").drawRoundRect(-t/2,-n/2,t,n,10),e.x=h.x,e.y=h.y,h.mask=e,e=s_oSpriteLibrary.getSprite("custom_icon"),(d=new createBitmap(e)).x=h.x+s.width/2+2,d.y=h.y+s.height/2+1,d.regX=e.width,d.regY=e.height,d.visible=!1,r.addChild(d),this._initListener()},this.unload=function(){s_bMobile?r.off("mousedown",p):(r.off("mousedown",p),r.off("mouseover",g)),r.off("pressup",m),n.removeChild(r)},this._initListener=function(){s_bMobile?p=r.on("mousedown",this.buttonDown):(p=r.on("mousedown",this.buttonDown),g=r.on("mouseover",this.buttonOver)),m=r.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,n){a[e]=t,l[e]=n},this.refreshPos=function(){s_bLandscape?(r.x=CANVAS_WIDTH/2,r.y=CANVAS_HEIGHT-100-s_iOffsetY):(r.x=CANVAS_WIDTH/2,r.y=CANVAS_HEIGHT-250-s_iOffsetY)},this.setScale=function(e){E=e,r.scale=E},this.buttonRelease=function(){T||(r.scale=E,a[ON_MOUSE_UP]&&a[ON_MOUSE_UP].call(l[ON_MOUSE_UP]))},this.buttonDown=function(){T||(r.scale=.9*E,playSound("click",1,!1),a[ON_MOUSE_DOWN]&&a[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN]))},this.buttonOver=function(e){s_bMobile||T||(e.target.cursor="pointer")},this.setPreset=function(e){var t=e.text;s=e.flag_id,e=e.custom;var n=s_oSpriteLibrary.getSprite("rule_flag_"+s);h.image=n,f.refreshText(t),d.visible=!1,e&&(d.visible=!0,t=RULE_PRESET[s_szCurRule].meta.denom+" "+TEXT_RULE_CUSTOM,f.refreshText(t))},this.addAlert=function(){var e=s_oSpriteLibrary.getSprite("time_panel");(b=new CAlertIcon(e.height/2-20,-e.width/2+10,"1",r)).pulseAnimation()},this.refreshTextByLang=function(e){console.log("szText "+e),u.refreshText(TEXT_RULE_CHANGE),f.refreshText(e)},this.removeAlert=function(){null!==b&&b.unload()},this.setY=function(e){r.y=e},this.getFlag=function(){return s},this._init(e,t,n)}function CRulePanel(e,t,n){var i,o,r,s,a,l,u,c,h,f,d,p,g,m,T,E,b,$,y,v,S,w,A,C,I,O,P,R,k,N,L,_,x,M,B,D,U;this._init=function(e,t,n){l=[],u=[];var a=s_oSpriteLibrary.getSprite("bg_menu");(s=createBitmap(a)).on("click",function(){},this),n.addChild(s),i=CANVAS_WIDTH-(a=s_oSpriteLibrary.getSprite("but_exit")).height/2-10,o=a.height/2+25,(M=new CGfxButton(i,o,a,n)).addEventListener(ON_MOUSE_UP,this._onExit,this),(r=new createjs.Container).x=e,r.y=t,n.addChild(r),(c=new createjs.Container).y=-600,r.addChild(c),t=6,a=s_oSpriteLibrary.getSprite("but_bwd"),(g=new CGfxButton(-350,t,a,c)).addEventListener(ON_MOUSE_UP,this._onButBack,this),a=s_oSpriteLibrary.getSprite("but_fwd"),(m=new CGfxButton(350,t,a,c)).addEventListener(ON_MOUSE_UP,this._onButFwd,this),e=-96,t=s_oSpriteLibrary.getSprite("rule_desc_label"),(n=new createBitmap(t)).x=e,n.regX=t.width/2,n.regY=t.height/2,c.addChild(n),n=t.width-30;var W=80;T=new CTLText(c,e-n/2,-6-W/2,n,W,50,"center",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_RULE_INTERNATIONAL,!0,!0,!0,!1),a=s_oSpriteLibrary.getSprite("flag_desc_label"),(n=new createBitmap(a)).x=e+t.width/2+a.width/2+14,n.regX=a.width/2,n.regY=a.height/2,c.addChild(n),a=s_oSpriteLibrary.getSprite("rule_flag_0"),(E=new createBitmap(a)).x=n.x-2,E.y=-4,E.regX=a.width/2,E.regY=a.height/2,c.addChild(E),n=a.width,W=a.height,(e=new createjs.Shape).graphics.beginFill("#000").drawRoundRect(-n/2,-W/2,n,W,10),e.x=E.x,e.y=E.y,E.mask=e,e=s_oSpriteLibrary.getSprite("custom_icon"),(b=new createBitmap(e)).x=E.x+a.width/2+2,b.y=E.y+a.height/2+1,b.regX=e.width,b.regY=e.height,b.visible=!1,c.addChild(b),n=500,W=80,$=new CTLText(c,-(n/2),-100-W/2,n,W,50,"center","#fff",PRIMARY_FONT,1,2,2," ",!0,!0,!1,!1),e=250+(a=s_oSpriteLibrary.getSprite("rule_toggle")).width/4-30,(h=new createjs.Container).y=-400,r.addChild(h),y=new CRuleSectionPanel(0,0,800,400,h,TEXT_RULE_CAPTURE),t=130,B=new CTLText(h,-310,t-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1,2,2,TEXT_RULE_MANDATORY_CAPTURE,!0,!0,!1,!1),a=s_oSpriteLibrary.getSprite("rule_toggle"),(A=new CToggle(e,t,a,!0,h)).addEventListener(ON_MOUSE_UP,this._onMandatoryCapture,this),t+=100,O=new CTLText(h,-310,t-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_MANDATORY_MAX_CAPTURE,!0,!0,!0,!1),a=s_oSpriteLibrary.getSprite("rule_toggle"),(C=new CToggle(e,t+10,a,!0,h)).addEventListener(ON_MOUSE_UP,this._onMaxCapture,this),t+=100,P=new CTLText(h,-310,t-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_KING_CAPTURE_FIRST,!0,!0,!0,!1),a=s_oSpriteLibrary.getSprite("rule_toggle"),(I=new CToggle(e,t+10,a,!0,h)).addEventListener(ON_MOUSE_UP,this._onKingFirst,this),(f=new createjs.Container).y=0,r.addChild(f),S=new CRuleSectionPanel(0,0,800,210,f,TEXT_PAWN),t=130,D=new CTLText(f,-310,t-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_PAWN_RULE_BACK,!0,!0,!0,!1),a=s_oSpriteLibrary.getSprite("rule_toggle"),(R=new CToggle(e,t+10,a,!0,f)).addEventListener(ON_MOUSE_UP,this._onBackCapture,this),(d=new createjs.Container).y=300,r.addChild(d),w=new CRuleSectionPanel(0,0,800,310,d,TEXT_KING),t=130,U=new CTLText(d,-310,t-40,500,80,50,"left",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_PROTECTED_KING,!0,!0,!0,!1),a=s_oSpriteLibrary.getSprite("rule_toggle"),(k=new CToggle(e,t+10,a,!0,d)).addEventListener(ON_MOUSE_UP,this._onProtectCapture,this),t+=115,W=100,a=s_oSpriteLibrary.getSprite("but_bwd"),(N=new CGfxButton(-270,t,a,d)).addEventListener(ON_MOUSE_UP,this._onButKingMoveBack,this),N.setScale(.75),a=s_oSpriteLibrary.getSprite("but_fwd"),(L=new CGfxButton(270,t,a,d)).addEventListener(ON_MOUSE_UP,this._onButKingMoveFWD,this),L.setScale(.75),n=450,_=new CTLText(d,-(n/2),t-10-40,n,80,60,"center",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_MOVEMENT_KING_LONG,!0,!0,!0,!1),p=new createjs.Container,r.addChild(p),v=new CRuleSectionPanel(0,0,800,230,p,TEXT_RULE_NOTE),n=620,W=120,x=new CTLText(p,-(n/2),140-W/2,n,W,60,"center",FONT_COLOR,PRIMARY_FONT,1.2,2,2,TEXT_RULE_NOTE_RUSSIAN,!0,!0,!0,!1),this._uniformFontSize(),s_iCurRuleFlag=this._getRuleID(s_oRules),this.setPreset(s_oRules),this._isCustomPreset(s_oRules)&&this._setCustom()},this.unload=function(){s.removeAllEventListeners(),M.unload(),g.unload(),m.unload(),A.unload(),C.unload(),I.unload(),R.unload(),k.unload(),N.unload(),L.unload()},this.refreshPos=function(){if(M.setPosition(i-s_iOffsetX,s_iOffsetY+o),s_bLandscape){var e=.7;c.x=0,c.y=-250,y.setPosition(0,-50),y.redraw(800,580),h.x=-300,h.y=-124,h.scale=e,f.x=-h.x,f.y=-160,f.scale=e,d.x=f.x,d.y=30,d.scale=e,v.redraw(1650,150),p.y=290,p.scale=e,e=800,x.setHorizontalSize(e,2),x.setX(-e/2),x.setY(10)}else e=1,c.x=0,c.y=-600,y.setPosition(0,0),y.redraw(800,400),h.x=0,h.y=-500,h.scale=e,f.x=0,f.y=-50,f.scale=e,d.x=0,d.y=210,d.scale=e,v.redraw(800,230),p.y=570,p.scale=e,e=620,x.setHorizontalSize(e,2),x.setX(-e/2),x.setY(70)},this.addEventListener=function(e,t,n){l[e]=t,u[e]=n},this.show=function(){s.visible=!0,r.visible=!0,M.setVisible(!0)},this.hide=function(){s.visible=!1,r.visible=!1,M.setVisible(!1)},this.setReadOnly=function(){g.setVisible(!1),m.setVisible(!1),A.setClickable(!1),C.setClickable(!1),I.setClickable(!1),R.setClickable(!1),k.setClickable(!1),N.setVisible(!1),L.setVisible(!1)},this._uniformFontSize=function(){var e=[];e.push(B),e.push(O),e.push(P),e.push(D),e.push(U),e.push(_);for(var t=100,n=0;n<e.length;n++){var i=e[n];(i=i.getFontSize())<t&&(t=i)}for(n=0;n<e.length;n++)(i=e[n]).setFontSize(t)},this._onExit=function(){l[ON_EXIT_RULE_PANEL]&&l[ON_EXIT_RULE_PANEL].call(u[ON_EXIT_RULE_PANEL])},this._onButBack=function(){0>--s_iCurRuleFlag&&(s_iCurRuleFlag=RULES_ORDER.length-1),this._changeRulePreset()},this._onButFwd=function(){++s_iCurRuleFlag>=RULES_ORDER.length&&(s_iCurRuleFlag=0),this._changeRulePreset()},this._changeRulePreset=function(){s_szCurRule=RULES_ORDER[s_iCurRuleFlag],b.visible=!1,s_oRules=copyObjectByValue(RULE_PRESET[s_szCurRule]),this.setPreset(s_oRules)},this.setPreset=function(e){var t=this._getRuleID(e),n=RULES_ORDER[t];t=s_oSpriteLibrary.getSprite("rule_flag_"+t),E.image=t,T.refreshText(RULE_PRESET[n].meta.denom),t=e.starting_board.length,$.refreshText(t+"x"+t+", "+(e.movement===MOVEMENT_DIAGONAL?TEXT_RULE_MOVEMENT_DIAGONAL:TEXT_RULE_MOVEMENT_STRAIGHT).toUpperCase()),A.setActive(e.capture_rule.mandatory),C.setActive(e.capture_rule.maximize),I.setActive(e.capture_rule.king_first),R.setActive(e.capture_rule.back),a=this._getMoveID(e),this._changeKingMovement(),k.setActive(e.capture_rule.king_protected),this._enableMandatorySubsection(e.capture_rule.mandatory),""!==(e=RULE_PRESET[n].meta.notes)?(p.visible=!0,x.refreshText(e)):p.visible=!1,B.refreshText(TEXT_RULE_MANDATORY_CAPTURE),O.refreshText(TEXT_RULE_MANDATORY_MAX_CAPTURE),P.refreshText(TEXT_RULE_KING_CAPTURE_FIRST),D.refreshText(TEXT_PAWN_RULE_BACK),y.changeTextTitle(TEXT_RULE_CAPTURE.toUpperCase()),S.changeTextTitle(TEXT_PAWN.toUpperCase()),w.changeTextTitle(TEXT_KING.toUpperCase()),U.refreshText(TEXT_RULE_PROTECTED_KING),v.changeTextTitle(TEXT_RULE_NOTE.toUpperCase())},this._enableMandatorySubsection=function(e){e?(O.setAlpha(1),P.setAlpha(1),C.enable(),I.enable()):(O.setAlpha(.5),P.setAlpha(.5),C.disable(),I.disable())},this._onButKingMoveBack=function(){0>--a&&(a=KING_MOVE_ORDER.length-1),this._setCustom(),this._changeKingMovement()},this._onButKingMoveFWD=function(){++a>=KING_MOVE_ORDER.length&&(a=0),this._setCustom(),this._changeKingMovement()},this._changeKingMovement=function(){var e="";switch(a){case 0:e=TEXT_RULE_MOVEMENT_KING_SHORT;break;case 1:e=TEXT_RULE_MOVEMENT_KING_LONG;break;case 2:e=TEXT_RULE_MOVEMENT_KING_LONG_BLOCK}_.refreshText(e),s_oRules.king_movement=KING_MOVE_ORDER[a]},this._onMandatoryCapture=function(){this._setCustom();var e=A.getState();s_oRules.capture_rule.mandatory=e,this._enableMandatorySubsection(e)},this._onMaxCapture=function(){this._setCustom();var e=C.getState();s_oRules.capture_rule.maximize=e},this._onKingFirst=function(){this._setCustom();var e=I.getState();s_oRules.capture_rule.king_first=e},this._onBackCapture=function(){this._setCustom();var e=R.getState();s_oRules.capture_rule.back=e,console.log(s_oRules)},this._onProtectCapture=function(){this._setCustom();var e=k.getState();s_oRules.capture_rule.king_protected=e},this.removeCustom=function(){b.visible=!1},this._setCustom=function(){b.visible=!0,T.refreshText(RULE_PRESET[s_szCurRule].meta.denom+" "+TEXT_RULE_CUSTOM)},this._isCustomPreset=function(){var e=copyObjectByValue(RULE_PRESET[s_szCurRule]),t=copyObjectByValue(s_oRules);return e.meta={},t.meta={},!deepEqual(e,t)},this._getRuleID=function(e){var t,n=0;for(t in RULE_PRESET)RULE_PRESET[t].id===e.id&&(n=RULES_ORDER.indexOf(t));return n},this._getMoveID=function(e){return KING_MOVE_ORDER.indexOf(e.king_movement)},this.getInfo=function(){return{text:T.getText().text,flag_id:s_iCurRuleFlag,custom:this._isCustomPreset()}},this._init(e,t,n)}function CRuleSectionPanel(e,t,n,i,o,r){var s,a,l,u;this._init=function(e,t,n,i,o,r){(s=new createjs.Container).x=e,s.y=t,o.addChild(s),l=new createjs.Shape,s.addChild(l),a=new createjs.Shape,s.addChild(a),e=n-120,u=new CTLText(s,-e/2-30,10,e,80,50,"left","#fff",PRIMARY_FONT,1,2,2,r.toUpperCase(),!0,!0,!1,!1),this.redraw(n,i)},this.unload=function(){o.removeChild(s)},this.redraw=function(e,t){l.graphics.clear(),l.graphics.beginFill("#c69944").drawRoundRect(-e/2,0,e,t,20),a.graphics.clear(),a.graphics.setStrokeStyle(10),a.graphics.beginStroke(FONT_COLOR).drawRoundRect(-e/2,0,e,t,20),u.setX(-(e-120)/2-30)},this.changeTextTitle=function(e){u.refreshText(e)},this.setPosition=function(e,t){s.x=e,s.y=t},this._init(e,t,n,i,o,r)}function CCapturedCounter(e,t,n,i,o){var r,s,a,l;this._init=function(){(r=new createjs.Container).x=e,r.y=t,o.addChild(r),l=0;var u=s_oSpriteLibrary.getSprite(i+"_"+n+"_marker");(a=createBitmap(u)).regX=u.width/2,a.regY=u.height,a.scale=.4,r.addChild(a),(u=new createjs.Shape).graphics.beginFill("black").drawCircle(15,-8,12),r.addChild(u),s=new CTLText(r,3,-20,24,24,18,"center","white",PRIMARY_FONT,1,2,2,l+"",!0,!0,!1,!1,11,!1)},this.unload=function(){o.removeChild(r)},this.reset=function(){l=0,this.setNum(l+"")},this.setNum=function(e){s.refreshText(e)},this.increase=function(){l++,this.setNum(l+"")},this.setColor=function(e){e=s_oSpriteLibrary.getSprite(e+"_"+n+"_marker"),a.image=e},this._init()}function CInterfaceBase(e){this._oForegroundContainer,this._oButExit,this._oAudioToggle,this._oWhitePanel,this._oBlackPanel,this._oButFullscreen,this._oAreYouSurePanel,this._oGUIExpandible,this._oButDraw,this._oButSurrender,this._oButUndo,this._oButStats,this._fCancelFullScreen=this._fRequestFullScreen=null,this._pStartPosFullscreen,this._pStartPossetDrawStateExit,this._pStartPosAudio,this._pStartPosDraw,this._pStartPosUndo,this._pStartPosSurrender,this._pStartPosUndo,this._iXOffset,s_oInterface=this}CInterfaceBase.prototype._init=function(e){this._oForegroundContainer=e},CInterfaceBase.prototype.unload=function(){this._oButExit.unload(),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._oAudioToggle.unload(),this._fRequestFullScreen&&screenfull.isEnabled&&this._oButFullscreen.unload(),this._oGUIExpandible.unload(),this._oRulePanel.unload(),s_oInterface=this._oAreYouSurePanel=null},CInterfaceBase.prototype.refreshButtonPos=function(){s_oGame.refreshGUI()},CInterfaceBase.prototype.refreshInfoPanelPos=function(){if(this._oWhitePanel){var e=this._oBlackPanel.getSide()===TOP,t=this._getInfoPanelPos(e);e=t.white_pos,t=t.black_pos,this._oWhitePanel.setPosition(e.x,e.y),this._oWhitePanel.refreshNotifyPos(),this._oBlackPanel.setPosition(t.x,t.y),this._oBlackPanel.refreshNotifyPos()}},CInterfaceBase.prototype.showTime=function(e){this._oWhitePanel.setTimeVisible(e),this._oBlackPanel.setTimeVisible(e)},CInterfaceBase.prototype.refreshWhiteTime=function(e){this._oWhitePanel.refreshTime(formatTime(e))},CInterfaceBase.prototype.refreshBlackTime=function(e){this._oBlackPanel.refreshTime(formatTime(e))},CInterfaceBase.prototype.refreshWhiteScore=function(e){this._oWhitePanel.refreshScore(e)},CInterfaceBase.prototype.refreshBlackScore=function(e){this._oBlackPanel.refreshScore(e)},CInterfaceBase.prototype.activePlayer=function(e){e===WHITE?(this._oBlackPanel.active(!1),this._oWhitePanel.active(!0)):(this._oWhitePanel.active(!1),this._oBlackPanel.active(!0))},CInterfaceBase.prototype.setPlayerInfoCheck=function(e,t){e===WHITE?this._oWhitePanel.setCheckState(t):this._oBlackPanel.setCheckState(t)},CInterfaceBase.prototype.setPlayerInfoNormal=function(){this._oWhitePanel.setNormalState(),this._oBlackPanel.setNormalState()},CInterfaceBase.prototype.resetInfo=function(){this._oWhitePanel.refreshTime(formatTime(0)),this._oBlackPanel.refreshTime(formatTime(0)),this._oWhitePanel.refreshScore(START_SCORE),this._oBlackPanel.refreshScore(START_SCORE)},CInterfaceBase.prototype.setInfoVisible=function(e){this._oWhitePanel.setPanelVisible(e),this._oBlackPanel.setPanelVisible(e)},CInterfaceBase.prototype.setPlayersInfo=function(e,t){this._oWhitePanel.setName(e),this._oBlackPanel.setName(t)},CInterfaceBase.prototype._onButConfigRelease=function(){},CInterfaceBase.prototype._onButRestartRelease=function(){s_oGame.restartGame()},CInterfaceBase.prototype._onExit=function(){this._oAreYouSurePanel=new CAreYouSurePanel(s_oGame.onExit)},CInterfaceBase.prototype._onAudioToggle=function(){},CInterfaceBase.prototype.resetFullscreenBut=function(){this._fRequestFullScreen&&screenfull.isEnabled&&this._oButFullscreen.setActive(s_bFullscreen)},CInterfaceBase.prototype._onFullscreenRelease=function(){s_bFullscreen?this._fCancelFullScreen.call(window.document):this._fRequestFullScreen.call(window.document.documentElement),sizeHandler()},CInterfaceBase.prototype.addDrawOption=function(){this._oButDraw.setVisible(!0)},CInterfaceBase.prototype.addUndoOption=function(){this._oButUndo.setVisible(!0)},CInterfaceBase.prototype.addStatsOption=function(){},CInterfaceBase.prototype.addSurrenderOption=function(){this._oButSurrender.setVisible(!0)},CInterfaceBase.prototype.enableUndo=function(){this._oButUndo.enable()},CInterfaceBase.prototype.disableUndo=function(){this._oButUndo.disable()},CInterfaceBase.prototype.setDrawState=function(e){e===WHITE?this._oWhitePanel.setNotify(TEXT_WAIT_FOR_A_DRAW):this._oBlackPanel.setNotify(TEXT_WAIT_FOR_A_DRAW)},CInterfaceBase.prototype.disableDrawState=function(e){e===WHITE?this._oWhitePanel.disableNotify():this._oBlackPanel.disableNotify()},CInterfaceBase.prototype.notifyOpponentDraw=function(e){e===WHITE?this._oWhitePanel.setNotify(TEXT_OFFERED_DRAW):this._oBlackPanel.setNotify(TEXT_OFFERED_DRAW)},CInterfaceBase.prototype.disableNotifyDraw=function(e){this.stopNotifyAnimation(),e===WHITE?this._oWhitePanel.disableNotify():this._oBlackPanel.disableNotify()},CInterfaceBase.prototype.notifyAnimation=function(){this._oButDraw.trembleAnimation()},CInterfaceBase.prototype.stopNotifyAnimation=function(){this._oButDraw.stopTrembleAnimation()},CInterfaceBase.prototype.setCheckState=function(e,t){},CInterfaceBase.prototype._onUndo=function(){s_oGame.onUndo()},CInterfaceBase.prototype._onRedo=function(){s_oGame.onRedo()},CInterfaceBase.prototype.setInfoPanelVisible=function(e,t){this._oWhitePanel.getSide()===e&&this._oWhitePanel.setPanelVisible(t),this._oBlackPanel.getSide()===e&&this._oBlackPanel.setPanelVisible(t)},CInterfaceBase.prototype._getInfoPanelPos=function(e){if(s_bLandscape){var t=386,n={x:640,y:t},i={x:n.x,y:-t};1.6<s_iAspectRatio&&(i={x:-n.x,y:-t})}else n={x:280,y:t=536},i={x:-280,y:-t};return e?(e=n,n=i):e=i,{white_pos:e,black_pos:n}},CInterfaceBase.prototype.configureInfoPanel=function(e){var t=this._getInfoPanelPos(e);e=t.white_pos,t=t.black_pos,this._oWhitePanel=new CInfoTurn(e.x,e.y,WHITE,this._oForegroundContainer),this._oBlackPanel=new CInfoTurn(t.x,t.y,BLACK,this._oForegroundContainer)},CInterfaceBase.prototype.updateStats=function(e,t,n,i){this._oWhitePanel.setCapturedList(t),this._oBlackPanel.setCapturedList(e),this._oWhitePanel.setPercent(n),this._oBlackPanel.setPercent(i)},CInterfaceBase.prototype._onInfoRules=function(){this._oRulePanel.show()},CInterfaceBase.prototype._onExitRules=function(){this._oRulePanel.hide()};var s_oInterface=null;function CInterfaceSingle(e){CInterfaceBase.call(this,e),this._oSuper=CInterfaceBase.prototype,this._init(e)}function CInterfaceMulti(e){CInterfaceBase.call(this,e),this._oSuper=CInterfaceBase.prototype,this._init(e)}function CBoard(e,t,n,i,o){var r,s,a,l,u,c;this._init=function(e,t,n){(r=new createjs.Container).x=e,r.y=t,n.addChild(r),(t=createBitmap(e=s_oSpriteLibrary.getSprite("board_occlusion"))).regX=e.width/2,t.regY=e.height/2,r.addChild(t),s=new createjs.Container,r.addChild(s),a=new createjs.Container,r.addChild(a),this.drawFrame(0,-402,BOARD_PRESET[0].frame,0),this.drawFrame(0,402,BOARD_PRESET[0].frame,180),this.drawFrame(-402,0,BOARD_PRESET[0].frame,-90),this.drawFrame(402,0,BOARD_PRESET[0].frame,90),l=CELL_SIZE_REFERENCE,t=CELL_SIZE_REFERENCE*(i-1),c=[],n=o;var h=0;for(e=0;e<i;e++){c[e]=[];for(var f=0;f<i;f++){var d=-t/2+t/(i-1)*f,p=-t/2+t/(i-1)*e;e!==h&&(h=e,n=n===WHITE?BLACK:WHITE),d=this.drawCell(d,p,n),c[e][f]=d,n=n===WHITE?BLACK:WHITE}}for(e=0,u=NUM_CELL_REFERENCE/i;e<i;e++)t=c[0][e].x*u,this.drawCoordinate(t,428,0,this.getLettersFromIndex(e)),this.drawCoordinate(t,-428,180,this.getLettersFromIndex(e));for(e=0;e<i;e++)n=i-e,t=c[e][0].y*u,this.drawCoordinate(-428,t,0,n),this.drawCoordinate(428,t,180,n);(t=createBitmap(e=s_oSpriteLibrary.getSprite("board_pattern"))).regX=e.width/2,t.regY=e.height/2,t.alpha=.8,a.addChild(t),(t=createBitmap(e=s_oSpriteLibrary.getSprite("board_focus_shape"))).regX=e.width/2,t.regY=e.height/2,a.addChild(t),s.scale=u,e=r.getBounds(),r.cache(-e.width/2,-e.height/2,e.width,e.height)},this.drawFrame=function(e,t,n,i){var o=s_oSpriteLibrary.getSprite("board_frame"),r=new createjs.Container;r.x=e,r.y=t,r.rotation=i,a.addChild(r),(e=new createjs.Shape).graphics.beginFill(n),e.graphics.moveTo(0,-7),e.graphics.lineTo(-410,-7),e.graphics.lineTo(-447,-45),e.graphics.lineTo(447,-45),e.graphics.lineTo(410,-7),r.addChild(e),(n=createBitmap(o)).regX=o.width/2,n.regY=o.height,r.addChild(n)},this.drawCell=function(e,t,n){n=n===WHITE?BOARD_PRESET[0].white_tile:BOARD_PRESET[0].black_tile;var i=new createjs.Shape;return i.graphics.beginFill(n).drawRect(-l/2,-l/2,l,l),i.x=e,i.y=t,s.addChild(i),i},this.drawCoordinate=function(e,t,n,i){var o=new createjs.Container;o.x=e,o.y=t,o.rotation=n,a.addChild(o),new CTLText(o,-20,-20,40,40,30,"center",BOARD_PRESET[0].letters_color,SECONDARY_FONT,1,4,4,i,!0,!0,!1,!1)},this.getLettersFromIndex=function(e){return BOARD_PRESET[0].coords[e]},this.getCellSize=function(){return l},this.getCells=function(){return c},this.getCellsPos=function(){for(var e=[],t=0;t<c.length;t++){e[t]=[];for(var n=0;n<c[t].length;n++)e[t][n]={x:c[t][n].x,y:c[t][n].y}}return e},this.getScale=function(){return u},this.getBounds=function(){return r.getBounds()},this._init(e,t,n)}function CPathDrawer(e,t,n){var i,o,r;this._init=function(e,t,n){i=new createjs.Container,n.addChild(i),o=e,r=[]},this.drawAllTrack=function(e){var n=this._getPathWithCapture(e);e=[],1<=n.length&&(e=this._joinPath(n)),n=.5*t,r=[];for(var i=0;i<e.length;i++){var o=e[i],s=0,a=0;1!==e.length&&(s=-n/2+n/(e.length-1)*i,a=-n/2+n/(e.length-1)*i);var l=BOARD_PRESET[0].path_colors;l=l[i%l.length];for(var u=0;u<o.terminal_list.length;u++){var c=s_oMovesController.getAllCellsFromAPath(o);c.unshift(o.src),c.splice(c.length-1,1);var h=o.terminal_list[u];c.push(o.terminal_list[u]),c=this._drawTrack(c,s,a,l),r.push({draw:c,dest:h})}}},this.clear=function(){for(var e=0;e<r.length;e++)i.removeChild(r[e].draw);r=[]},this.showSinglePath=function(e){for(var t=0;t<r.length;t++){var n=r[t],i=n.draw;i.visible=!1,n.dest.row===e.row&&n.dest.col===e.col&&(i.visible=!0)}},this.hideAll=function(){for(var e=0;e<r.length;e++)r[e].draw.visible=!1},this._drawTrack=function(e,t,n,r){var s=new createjs.Container;i.addChild(s);var a=e[0];a=o[a.row][a.col];var l=new createjs.Shape;l.graphics.beginFill(r).drawRect(-8,-8,16,16),l.x=a.x,l.y=a.y,s.addChild(l),(l=new createjs.Shape).graphics.setStrokeStyle(4),l.graphics.beginStroke(r),l.graphics.moveTo(a.x,a.y);for(var u=1;u<e.length;u++){var c=(a=o[(a=e[u]).row][a.col]).x+t,h=a.y+n;l.graphics.lineTo(c,h)}return l.graphics.lineTo(a.x,a.y),(e=new createjs.Shape).graphics.beginFill(r).drawCircle(a.x,a.y,8),s.addChild(e),s.addChild(l),s},this._getPathWithCapture=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];0<s_oMovesController.getNumCaptureInPath(i)&&t.push(i)}return t},this._joinPath=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],o=[];o.push(i.terminal);for(var r=1;r<e.length;r++){var s=e[r];this._matchCaptureList(i.jump_list,s.jump_list)&&(o.push(s.terminal),e.splice(r,1),r--)}i.terminal_list=o,t.push(i),e.splice(0,1),n--}return t},this._matchCaptureList=function(e,t){var n=!0;if(e.length===t.length){for(var i=0;i<e.length;i++)if(!deepEqual(e[i].capture,t[i].capture)){n=!1;break}}else n=!1;return n},this.unload=function(){n.removeChild(i)},this._init(e,t,n)}function CNewsPanel(e){var t,n,i,o;this._init=function(e){(n=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),n.alpha=0,n.on("mousedown",function(){}),s_oStage.addChild(n);var r=this;createjs.Tween.get(n).to({alpha:.7},500).call(function(){r._onEndFade()}),i=new createjs.Container,s_oStage.addChild(i);var s=s_oSpriteLibrary.getSprite("msg_box"),a=createBitmap(s);a.regX=s.width/2,a.regY=s.height/2,i.addChild(a),i.x=CANVAS_WIDTH/2,i.y=CANVAS_HEIGHT/2,t=e,s=s.width-120,o=new CTLText(i,-(s/2),-340,s,280,80,"center",FONT_COLOR,PRIMARY_FONT,1.2,2,2,e,!0,!0,!0,!1),(e=createBitmap(s=s_oSpriteLibrary.getSprite("checkers"))).regX=s.width/2,e.regY=s.height/2,e.y=180,i.addChild(e)},this.unload=function(){s_oStage.removeChild(n),s_oStage.removeChild(i),n.off("mousedown",function(){}),i.removeAllEventListeners()},this._onEndFade=function(){i.on("mousedown",this.unload,this)},this.setMessage=function(e){t=e,o.refreshText(e)},this.setMsgColor=function(e){o.setColor(e)},this.centerMessage=function(){o.setY(-50)},this.show=function(){n.visible=!0,i.visible=!0},this.showExitBut=function(){(void 0).setVisible(!0)},this.setButtonContainerY=function(e){},this.refreshLang=function(e){o.refreshText(t);for(var n=0;n<(void 0).length;n++)(void 0)[n].refreshText(e[n])},this._init(e)}CInterfaceSingle.prototype=Object.create(CInterfaceBase.prototype),CInterfaceSingle.prototype._init=function(e){this._oSuper._init.call(this,e),this.refreshButtonPos()},CInterfaceSingle.prototype.unload=function(){this._oSuper.unload.call(this),this._oBlackPanel.unload(),this._oWhitePanel.unload()},CInterfaceSingle.prototype.refreshButtonPos=function(){this._oSuper.refreshButtonPos.call(this)},CInterfaceMulti.prototype=Object.create(CInterfaceBase.prototype),CInterfaceMulti.prototype._init=function(e){this._oSuper._init.call(this,e),e=s_oSpriteLibrary.getSprite("but_draw"),this._pStartPosDraw={x:this._pStartPosExit.x-e.width-10,y:e.height/2+25},this._oButDraw=new CSecurityButton(this._pStartPosDraw.x,this._pStartPosDraw.y,e,this._oButContainer),this._oButDraw.addEventListener(ON_MOUSE_UP,this._onDraw,this),this._oButDraw.setVisible(!1),e=s_oSpriteLibrary.getSprite("but_surrender"),this._pStartPosSurrender={x:this._pStartPosDraw.x-e.width-10,y:e.height/2+25},this._oButSurrender=new CSecurityButton(this._pStartPosSurrender.x,this._pStartPosSurrender.y,e,this._oButContainer),this._oButSurrender.addEventListener(ON_MOUSE_UP,this._onSurrender,this),this._oButSurrender.setVisible(!1),this._oRulePanel.setPreset(s_oGame.getRules()),this._oRulePanel.removeCustom(),this._oRulePanel.setReadOnly(),this.refreshButtonPos()},CInterfaceMulti.prototype.unload=function(){this._oSuper.unload.call(this),this._oButDraw.unload(),this._oBlackPanel.unload(),this._oWhitePanel.unload()},CInterfaceMulti.prototype.refreshButtonPos=function(){this._oSuper.refreshButtonPos.call(this);var e=s_oSpriteLibrary.getSprite("but_draw");if(s_bLandscape&&1.6>=s_iAspectRatio){var t=this._pStartPosExit.x-s_iOffsetX,n=CANVAS_HEIGHT-s_iOffsetY-e.height/2;this._oButDraw.setPosition(t,n),this._oButSurrender.setPosition(t,n-e.height-10)}else t=this._pStartPosDraw.x-s_iOffsetX,n=this._pStartPosDraw.y+s_iOffsetY,this._oButDraw.setPosition(t,n),this._oButSurrender.setPosition(t-e.width-10,n)},CInterfaceMulti.prototype.disableUndo=function(){},CInterfaceMulti.prototype._onDraw=function(){s_oGame.onDrawToggle()},CInterfaceMulti.prototype._onSurrender=function(){s_oGame.onSurrender()};